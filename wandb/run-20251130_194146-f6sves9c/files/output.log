wandb: Detected [openai] in use.
wandb: Use W&B Weave for improved LLM call tracing. Weave is installed but not imported. Add `import weave` to the top of your script.
wandb: For more information, check out the docs at: https://weave-docs.wandb.ai/
Checkpoint tracker file does not exist: /data0/user10/Open-AgentRL/checkpoint/qwen2_3b_opd/latest_checkpointed_iteration.txt
Training from scratch
test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 0}
validation generation end
len reward_extra_infos_dict['reward']: 960
len reward_extra_infos_dict['score']: 960
len reward_extra_infos_dict['acc']: 960
len reward_extra_infos_dict['pred']: 960
("Initial validation metrics: {'val-aux/aime_2024/reward/mean@16': "
 "np.float64(-0.7995833281427622), 'val-aux/aime_2024/reward/std@16': "
 "np.float64(0.17403947244526555), 'val-aux/aime_2024/reward/best@2/mean': "
 "np.float64(-0.7149066646039486), 'val-aux/aime_2024/reward/best@2/std': "
 "np.float64(0.17472875999373136), 'val-aux/aime_2024/reward/worst@2/mean': "
 "np.float64(-0.8830933252255122), 'val-aux/aime_2024/reward/worst@2/std': "
 "np.float64(0.11560722213098093), 'val-aux/aime_2024/reward/maj@2/mean': "
 "np.float64(-0.7971433283070724), 'val-aux/aime_2024/reward/maj@2/std': "
 "np.float64(0.17529845096532032), 'val-aux/aime_2024/reward/best@4/mean': "
 "np.float64(-0.6315500022768974), 'val-aux/aime_2024/reward/best@4/std': "
 "np.float64(0.1577829848400327), 'val-aux/aime_2024/reward/worst@4/mean': "
 "np.float64(-0.9378766580839952), 'val-aux/aime_2024/reward/worst@4/std': "
 "np.float64(0.06994861437539876), 'val-aux/aime_2024/reward/maj@4/mean': "
 "np.float64(-0.7874766616384189), 'val-aux/aime_2024/reward/maj@4/std': "
 "np.float64(0.17514194149183077), 'val-aux/aime_2024/reward/best@8/mean': "
 "np.float64(-0.5600400057752928), 'val-aux/aime_2024/reward/best@8/std': "
 "np.float64(0.13078211374157797), 'val-aux/aime_2024/reward/worst@8/mean': "
 "np.float64(-0.967396660000086), 'val-aux/aime_2024/reward/worst@8/std': "
 "np.float64(0.038390258781264404), 'val-aux/aime_2024/reward/maj@8/mean': "
 "np.float64(-0.7742566615462304), 'val-aux/aime_2024/reward/maj@8/std': "
 "np.float64(0.1717440813927417), 'val-aux/aime_2024/reward/best@16/mean': "
 "np.float64(-0.5011466743151346), 'val-aux/aime_2024/reward/best@16/std': "
 "np.float64(0.09584869839040397), 'val-aux/aime_2024/reward/worst@16/mean': "
 "np.float64(-0.9827199959536393), 'val-aux/aime_2024/reward/worst@16/std': "
 "np.float64(0.021192275563385887), 'val-aux/aime_2024/reward/maj@16/mean': "
 "np.float64(-0.7612766615192096), 'val-aux/aime_2024/reward/maj@16/std': "
 "np.float64(0.16466783665000329), 'val-aux/aime_2024/score/mean@16': "
 "np.float64(-0.7995833333333333), 'val-aux/aime_2024/score/std@16': "
 "np.float64(0.17403947775652612), 'val-aux/aime_2024/score/best@2/mean': "
 "np.float64(-0.7149066666666667), 'val-aux/aime_2024/score/best@2/std': "
 "np.float64(0.17472876741048454), 'val-aux/aime_2024/score/worst@2/mean': "
 "np.float64(-0.8830933333333335), 'val-aux/aime_2024/score/worst@2/std': "
 "np.float64(0.11560722317027605), 'val-aux/aime_2024/score/maj@2/mean': "
 "np.float64(-0.7971433333333332), 'val-aux/aime_2024/score/maj@2/std': "
 "np.float64(0.17529845631642657), 'val-aux/aime_2024/score/best@4/mean': "
 "np.float64(-0.6315500000000002), 'val-aux/aime_2024/score/best@4/std': "
 "np.float64(0.15778299143899446), 'val-aux/aime_2024/score/worst@4/mean': "
 "np.float64(-0.9378766666666668), 'val-aux/aime_2024/score/worst@4/std': "
 "np.float64(0.06994861094741188), 'val-aux/aime_2024/score/maj@4/mean': "
 "np.float64(-0.7874766666666668), 'val-aux/aime_2024/score/maj@4/std': "
 "np.float64(0.17514194690709334), 'val-aux/aime_2024/score/best@8/mean': "
 "np.float64(-0.5600400000000001), 'val-aux/aime_2024/score/best@8/std': "
 "np.float64(0.1307821182106256), 'val-aux/aime_2024/score/worst@8/mean': "
 "np.float64(-0.9673966666666668), 'val-aux/aime_2024/score/worst@8/std': "
 "np.float64(0.03839025329122967), 'val-aux/aime_2024/score/maj@8/mean': "
 "np.float64(-0.7742566666666668), 'val-aux/aime_2024/score/maj@8/std': "
 "np.float64(0.17174408676278724), 'val-aux/aime_2024/score/best@16/mean': "
 "np.float64(-0.5011466666666666), 'val-aux/aime_2024/score/best@16/std': "
 "np.float64(0.0958487005103167), 'val-aux/aime_2024/score/worst@16/mean': "
 "np.float64(-0.9827200000000001), 'val-aux/aime_2024/score/worst@16/std': "
 "np.float64(0.02119227100758296), 'val-aux/aime_2024/score/maj@16/mean': "
 "np.float64(-0.7612766666666668), 'val-aux/aime_2024/score/maj@16/std': "
 "np.float64(0.16466784207011823), 'val-core/aime_2024/acc/mean@16': "
 "np.float64(0.025), 'val-aux/aime_2024/acc/std@16': "
 "np.float64(0.045683788800014585), 'val-aux/aime_2024/acc/best@2/mean': "
 "np.float64(0.04173333333333334), 'val-aux/aime_2024/acc/best@2/std': "
 "np.float64(0.05365156713189321), 'val-aux/aime_2024/acc/worst@2/mean': "
 "np.float64(0.008), 'val-aux/aime_2024/acc/worst@2/std': "
 "np.float64(0.022161804910757858), 'val-aux/aime_2024/acc/maj@2/mean': "
 "np.float64(0.0252), 'val-aux/aime_2024/acc/maj@2/std': "
 "np.float64(0.04630635826940643), 'val-aux/aime_2024/acc/best@4/mean': "
 "np.float64(0.0634), 'val-aux/aime_2024/acc/best@4/std': "
 "np.float64(0.05505653765749741), 'val-aux/aime_2024/acc/worst@4/mean': "
 "np.float64(0.0012333333333333335), 'val-aux/aime_2024/acc/worst@4/std': "
 "np.float64(0.007615212510075615), 'val-aux/aime_2024/acc/maj@4/mean': "
 "np.float64(0.031066666666666666), 'val-aux/aime_2024/acc/maj@4/std': "
 "np.float64(0.04644623703622835), 'val-aux/aime_2024/acc/best@8/mean': "
 "np.float64(0.08626666666666667), 'val-aux/aime_2024/acc/best@8/std': "
 "np.float64(0.05018557384917469), 'val-aux/aime_2024/acc/worst@8/mean': "
 "np.float64(3.3333333333333335e-05), 'val-aux/aime_2024/acc/worst@8/std': "
 "np.float64(0.001053565375285274), 'val-aux/aime_2024/acc/maj@8/mean': "
 "np.float64(0.03866666666666667), 'val-aux/aime_2024/acc/maj@8/std': "
 "np.float64(0.045042212936546686), 'val-core/aime_2024/acc/best@16/mean': "
 "np.float64(0.10866666666666666), 'val-core/aime_2024/acc/best@16/std': "
 "np.float64(0.03975956858840304), 'val-aux/aime_2024/acc/worst@16/mean': "
 "np.float64(0.0), 'val-aux/aime_2024/acc/worst@16/std': np.float64(0.0), "
 "'val-core/aime_2024/acc/maj@16/mean': np.float64(0.04606666666666667), "
 "'val-core/aime_2024/acc/maj@16/std': np.float64(0.04191099349079463), "
 "'val-aux/aime_2025/reward/mean@16': np.float64(-0.8127083284159501), "
 "'val-aux/aime_2025/reward/std@16': np.float64(0.19716233930585733), "
 "'val-aux/aime_2025/reward/best@2/mean': np.float64(-0.7236399980306626), "
 "'val-aux/aime_2025/reward/best@2/std': np.float64(0.21520687469310004), "
 "'val-aux/aime_2025/reward/worst@2/mean': np.float64(-0.9030533252795538), "
 "'val-aux/aime_2025/reward/worst@2/std': np.float64(0.111131633163634), "
 "'val-aux/aime_2025/reward/maj@2/mean': np.float64(-0.8132466616431872), "
 "'val-aux/aime_2025/reward/maj@2/std': np.float64(0.19555244060126228), "
 "'val-aux/aime_2025/reward/best@4/mean': np.float64(-0.616080003152291), "
 "'val-aux/aime_2025/reward/best@4/std': np.float64(0.21482162159157822), "
 "'val-aux/aime_2025/reward/worst@4/mean': np.float64(-0.947436658924818), "
 "'val-aux/aime_2025/reward/worst@4/std': np.float64(0.05424497488622423), "
 "'val-aux/aime_2025/reward/maj@4/mean': np.float64(-0.8079233285049596), "
 "'val-aux/aime_2025/reward/maj@4/std': np.float64(0.20190463644717022), "
 "'val-aux/aime_2025/reward/best@8/mean': np.float64(-0.5100800079862278), "
 "'val-aux/aime_2025/reward/best@8/std': np.float64(0.18288618185578884), "
 "'val-aux/aime_2025/reward/worst@8/mean': np.float64(-0.9707966611405214), "
 "'val-aux/aime_2025/reward/worst@8/std': np.float64(0.033750157295816666), "
 "'val-aux/aime_2025/reward/maj@8/mean': np.float64(-0.7971266621828078), "
 "'val-aux/aime_2025/reward/maj@8/std': np.float64(0.21179230161293597), "
 "'val-aux/aime_2025/reward/best@16/mean': np.float64(-0.42674334414601317), "
 "'val-aux/aime_2025/reward/best@16/std': np.float64(0.1200098171424523), "
 "'val-aux/aime_2025/reward/worst@16/mean': np.float64(-0.9843966632803282), "
 "'val-aux/aime_2025/reward/worst@16/std': np.float64(0.018725261909033418), "
 "'val-aux/aime_2025/reward/maj@16/mean': np.float64(-0.7875966624756654), "
 "'val-aux/aime_2025/reward/maj@16/std': np.float64(0.21548487115894635), "
 "'val-aux/aime_2025/score/mean@16': np.float64(-0.8127083333333334), "
 "'val-aux/aime_2025/score/std@16': np.float64(0.19716234545123487), "
 "'val-aux/aime_2025/score/best@2/mean': np.float64(-0.72364), "
 "'val-aux/aime_2025/score/best@2/std': np.float64(0.2152068834734018), "
 "'val-aux/aime_2025/score/worst@2/mean': np.float64(-0.9030533333333334), "
 "'val-aux/aime_2025/score/worst@2/std': np.float64(0.11113163389652249), "
 "'val-aux/aime_2025/score/maj@2/mean': np.float64(-0.8132466666666668), "
 "'val-aux/aime_2025/score/maj@2/std': np.float64(0.195552446857918), "
 "'val-aux/aime_2025/score/best@4/mean': np.float64(-0.61608), "
 "'val-aux/aime_2025/score/best@4/std': np.float64(0.21482163022652578), "
 "'val-aux/aime_2025/score/worst@4/mean': np.float64(-0.9474366666666668), "
 "'val-aux/aime_2025/score/worst@4/std': np.float64(0.05424497063676585), "
 "'val-aux/aime_2025/score/maj@4/mean': np.float64(-0.8079233333333335), "
 "'val-aux/aime_2025/score/maj@4/std': np.float64(0.20190464244983228), "
 "'val-aux/aime_2025/score/best@8/mean': np.float64(-0.51008), "
 "'val-aux/aime_2025/score/best@8/std': np.float64(0.18288618795292347), "
 "'val-aux/aime_2025/score/worst@8/mean': np.float64(-0.9707966666666666), "
 "'val-aux/aime_2025/score/worst@8/std': np.float64(0.033750152182166614), "
 "'val-aux/aime_2025/score/maj@8/mean': np.float64(-0.7971266666666667), "
 "'val-aux/aime_2025/score/maj@8/std': np.float64(0.21179230708879723), "
 "'val-aux/aime_2025/score/best@16/mean': np.float64(-0.4267433333333333), "
 "'val-aux/aime_2025/score/best@16/std': np.float64(0.12000982083682707), "
 "'val-aux/aime_2025/score/worst@16/mean': np.float64(-0.9843966666666668), "
 "'val-aux/aime_2025/score/worst@16/std': np.float64(0.018725258513292313), "
 "'val-aux/aime_2025/score/maj@16/mean': np.float64(-0.7875966666666667), "
 "'val-aux/aime_2025/score/maj@16/std': np.float64(0.21548487622866877), "
 "'val-core/aime_2025/acc/mean@16': np.float64(0.022916666666666665), "
 "'val-aux/aime_2025/acc/std@16': np.float64(0.056137467890130376), "
 "'val-aux/aime_2025/acc/best@2/mean': np.float64(0.0418), "
 "'val-aux/aime_2025/acc/best@2/std': np.float64(0.07003886812895835), "
 "'val-aux/aime_2025/acc/worst@2/mean': np.float64(0.0035333333333333336), "
 "'val-aux/aime_2025/acc/worst@2/std': np.float64(0.022740093204905866), "
 "'val-aux/aime_2025/acc/maj@2/mean': np.float64(0.022500000000000003), "
 "'val-aux/aime_2025/acc/maj@2/std': np.float64(0.05524049141107823), "
 "'val-aux/aime_2025/acc/best@4/mean': np.float64(0.073), "
 "'val-aux/aime_2025/acc/best@4/std': np.float64(0.07935809651752555), "
 "'val-aux/aime_2025/acc/worst@4/mean': np.float64(0.00013333333333333334), "
 "'val-aux/aime_2025/acc/worst@4/std': np.float64(0.002103964511741267), "
 "'val-aux/aime_2025/acc/maj@4/mean': np.float64(0.0262), "
 "'val-aux/aime_2025/acc/maj@4/std': np.float64(0.05842184949497871), "
 "'val-aux/aime_2025/acc/best@8/mean': np.float64(0.11030000000000001), "
 "'val-aux/aime_2025/acc/best@8/std': np.float64(0.07413922545672212), "
 "'val-aux/aime_2025/acc/worst@8/mean': np.float64(0.0), "
 "'val-aux/aime_2025/acc/worst@8/std': np.float64(0.0), "
 "'val-aux/aime_2025/acc/maj@8/mean': np.float64(0.033433333333333336), "
 "'val-aux/aime_2025/acc/maj@8/std': np.float64(0.06422242425217689), "
 "'val-core/aime_2025/acc/best@16/mean': np.float64(0.14386666666666667), "
 "'val-core/aime_2025/acc/best@16/std': np.float64(0.05066929219817053), "
 "'val-aux/aime_2025/acc/worst@16/mean': np.float64(0.0), "
 "'val-aux/aime_2025/acc/worst@16/std': np.float64(0.0), "
 "'val-core/aime_2025/acc/maj@16/mean': np.float64(0.040433333333333335), "
 "'val-core/aime_2025/acc/maj@16/std': np.float64(0.06702372739385466), "
 "'val-aux/num_turns/min': np.int32(2), 'val-aux/num_turns/max': np.int32(16), "
 "'val-aux/num_turns/mean': np.float64(5.2)}")
step:0 - val-aux/aime_2024/reward/mean@16:np.float64(-0.7995833281427622) - val-aux/aime_2024/reward/std@16:np.float64(0.17403947244526555) - val-aux/aime_2024/reward/best@2/mean:np.float64(-0.7149066646039486) - val-aux/aime_2024/reward/best@2/std:np.float64(0.17472875999373136) - val-aux/aime_2024/reward/worst@2/mean:np.float64(-0.8830933252255122) - val-aux/aime_2024/reward/worst@2/std:np.float64(0.11560722213098093) - val-aux/aime_2024/reward/maj@2/mean:np.float64(-0.7971433283070724) - val-aux/aime_2024/reward/maj@2/std:np.float64(0.17529845096532032) - val-aux/aime_2024/reward/best@4/mean:np.float64(-0.6315500022768974) - val-aux/aime_2024/reward/best@4/std:np.float64(0.1577829848400327) - val-aux/aime_2024/reward/worst@4/mean:np.float64(-0.9378766580839952) - val-aux/aime_2024/reward/worst@4/std:np.float64(0.06994861437539876) - val-aux/aime_2024/reward/maj@4/mean:np.float64(-0.7874766616384189) - val-aux/aime_2024/reward/maj@4/std:np.float64(0.17514194149183077) - val-aux/aime_2024/reward/best@8/mean:np.float64(-0.5600400057752928) - val-aux/aime_2024/reward/best@8/std:np.float64(0.13078211374157797) - val-aux/aime_2024/reward/worst@8/mean:np.float64(-0.967396660000086) - val-aux/aime_2024/reward/worst@8/std:np.float64(0.038390258781264404) - val-aux/aime_2024/reward/maj@8/mean:np.float64(-0.7742566615462304) - val-aux/aime_2024/reward/maj@8/std:np.float64(0.1717440813927417) - val-aux/aime_2024/reward/best@16/mean:np.float64(-0.5011466743151346) - val-aux/aime_2024/reward/best@16/std:np.float64(0.09584869839040397) - val-aux/aime_2024/reward/worst@16/mean:np.float64(-0.9827199959536393) - val-aux/aime_2024/reward/worst@16/std:np.float64(0.021192275563385887) - val-aux/aime_2024/reward/maj@16/mean:np.float64(-0.7612766615192096) - val-aux/aime_2024/reward/maj@16/std:np.float64(0.16466783665000329) - val-aux/aime_2024/score/mean@16:np.float64(-0.7995833333333333) - val-aux/aime_2024/score/std@16:np.float64(0.17403947775652612) - val-aux/aime_2024/score/best@2/mean:np.float64(-0.7149066666666667) - val-aux/aime_2024/score/best@2/std:np.float64(0.17472876741048454) - val-aux/aime_2024/score/worst@2/mean:np.float64(-0.8830933333333335) - val-aux/aime_2024/score/worst@2/std:np.float64(0.11560722317027605) - val-aux/aime_2024/score/maj@2/mean:np.float64(-0.7971433333333332) - val-aux/aime_2024/score/maj@2/std:np.float64(0.17529845631642657) - val-aux/aime_2024/score/best@4/mean:np.float64(-0.6315500000000002) - val-aux/aime_2024/score/best@4/std:np.float64(0.15778299143899446) - val-aux/aime_2024/score/worst@4/mean:np.float64(-0.9378766666666668) - val-aux/aime_2024/score/worst@4/std:np.float64(0.06994861094741188) - val-aux/aime_2024/score/maj@4/mean:np.float64(-0.7874766666666668) - val-aux/aime_2024/score/maj@4/std:np.float64(0.17514194690709334) - val-aux/aime_2024/score/best@8/mean:np.float64(-0.5600400000000001) - val-aux/aime_2024/score/best@8/std:np.float64(0.1307821182106256) - val-aux/aime_2024/score/worst@8/mean:np.float64(-0.9673966666666668) - val-aux/aime_2024/score/worst@8/std:np.float64(0.03839025329122967) - val-aux/aime_2024/score/maj@8/mean:np.float64(-0.7742566666666668) - val-aux/aime_2024/score/maj@8/std:np.float64(0.17174408676278724) - val-aux/aime_2024/score/best@16/mean:np.float64(-0.5011466666666666) - val-aux/aime_2024/score/best@16/std:np.float64(0.0958487005103167) - val-aux/aime_2024/score/worst@16/mean:np.float64(-0.9827200000000001) - val-aux/aime_2024/score/worst@16/std:np.float64(0.02119227100758296) - val-aux/aime_2024/score/maj@16/mean:np.float64(-0.7612766666666668) - val-aux/aime_2024/score/maj@16/std:np.float64(0.16466784207011823) - val-core/aime_2024/acc/mean@16:np.float64(0.025) - val-aux/aime_2024/acc/std@16:np.float64(0.045683788800014585) - val-aux/aime_2024/acc/best@2/mean:np.float64(0.04173333333333334) - val-aux/aime_2024/acc/best@2/std:np.float64(0.05365156713189321) - val-aux/aime_2024/acc/worst@2/mean:np.float64(0.008) - val-aux/aime_2024/acc/worst@2/std:np.float64(0.022161804910757858) - val-aux/aime_2024/acc/maj@2/mean:np.float64(0.0252) - val-aux/aime_2024/acc/maj@
Training Progress:   0%|          | 19/55990 [1:02:10<2833:18:23, 182.24s/it]
step:1 - global_seqlen/min:156145 - global_seqlen/max:180351 - global_seqlen/minmax_diff:24206 - global_seqlen/balanced_min:169157 - global_seqlen/balanced_max:169373 - global_seqlen/mean:169211.25 - actor/entropy:0.23088467121124268 - actor/reward_kl_penalty:0.5475736260414124 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.009958353244292084) - actor/pg_clipfrac:np.float64(0.003917537396773696) - actor/ppo_kl:np.float64(-0.00012896906773676164) - actor/pg_clipfrac_lower:np.float64(2.716088838496944e-05) - actor/grad_norm:np.float64(0.948517307639122) - perf/mfu/actor:np.float64(0.3719525906038378) - perf/max_memory_allocated_gb:np.float64(44.16362142562866) - perf/max_memory_reserved_gb:np.float64(54.560546875) - perf/cpu_memory_used_gb:np.float64(423.5987014770508) - actor/lr:np.float64(1e-06) - training/global_step:1 - training/epoch:0 - critic/score/mean:-0.548828125 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.9091631174087524 - critic/rewards/max:0.9072856307029724 - critic/rewards/min:-2.3602590560913086 - critic/advantages/mean:-0.05211504548788071 - critic/advantages/max:3.6705870628356934 - critic/advantages/min:-2.404277801513672 - critic/returns/mean:-0.05211504548788071 - critic/returns/max:3.6705870628356934 - critic/returns/min:-2.404277801513672 - response_length/mean:985.525390625 - response_length/max:4861.0 - response_length/min:8.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:985.525390625 - response_length_non_aborted/max:4861.0 - response_length_non_aborted/min:8.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:336.4375 - prompt_length/max:787.0 - prompt_length/min:264.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(6.45703125) - timing_s/start_profile:0.00024237390607595444 - timing_s/agent_loop/generate_sequences/min:np.float64(0.4733163851778954) - timing_s/agent_loop/generate_sequences/max:np.float64(61.67700987495482) - timing_s/agent_loop/generate_sequences/mean:np.float64(26.460347115503737) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(30.311982232844457) - timing_s/agent_loop/tool_calls/mean:np.float64(0.6656624012198336) - timing_s/agent_loop/slowest/generate_sequences:np.float64(61.67700987495482) - timing_s/agent_loop/slowest/tool_calls:np.float64(1.3090984770096838) - timing_s/agent_loop/slowest/prompt_length:282 - timing_s/agent_loop/slowest/response_length:4861 - timing_s/gen:65.6763251000084 - timing_s/reward:0.00017112796194851398 - timing_s/old_log_prob:12.507972531020641 - timing_s/ref:107.66637870296836 - timing_s/adv:0.13148533389903605 - timing_s/update_actor:37.35258099716157 - timing_s/step:223.44841042696498 - timing_s/stop_profile:6.076809950172901e-05 - timing_per_token_ms/gen:0.13015805952965365 - timing_per_token_ms/update_actor:0.05518631444002921 - timing_per_token_ms/adv:0.0001942621041730914 - timing_per_token_ms/ref:0.15907095229035947 - perf/total_num_tokens:676845 - perf/time_per_step:223.44841042696498 - perf/throughput:757.2721134004548
step:2 - global_seqlen/min:163459 - global_seqlen/max:191700 - global_seqlen/minmax_diff:28241 - global_seqlen/balanced_min:179447 - global_seqlen/balanced_max:179920 - global_seqlen/mean:179565.5 - actor/entropy:0.24088265001773834 - actor/reward_kl_penalty:0.5404171943664551 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.01462322282823152) - actor/pg_clipfrac:np.float64(0.0038696145405992866) - actor/ppo_kl:np.float64(-0.00014351065046867007) - actor/pg_clipfrac_lower:np.float64(4.119638651900459e-06) - actor/grad_norm:np.float64(0.9091643244028091) - perf/mfu/actor:np.float64(0.356559409628884) - perf/max_memory_allocated_gb:np.float64(44.8550443649292) - perf/max_memory_reserved_gb:np.float64(54.927734375) - perf/cpu_memory_used_gb:np.float64(466.71402740478516) - actor/lr:np.float64(1e-06) - training/global_step:2 - training/epoch:0 - critic/score/mean:-0.5904296636581421 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.9686207175254822 - critic/rewards/max:0.9020101428031921 - critic/rewards/min:-2.3048744201660156 - critic/advantages/mean:-0.075753353536129 - critic/advantages/max:3.6320786476135254 - critic/advantages/min:-3.60274600982666 - critic/returns/mean:-0.075753353536129 - critic/returns/max:3.6320786476135254 - critic/returns/min:-3.60274600982666 - response_length/mean:1071.51171875 - response_length/max:6729.0 - response_length/min:185.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:1071.51171875 - response_length_non_aborted/max:6729.0 - response_length_non_aborted/min:185.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:331.34375 - prompt_length/max:433.0 - prompt_length/min:256.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(6.921875) - timing_s/start_profile:5.7538971304893494e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(6.627760237082839) - timing_s/agent_loop/generate_sequences/max:np.float64(85.57219449291006) - timing_s/agent_loop/generate_sequences/mean:np.float64(32.16601207345775) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(30.254581889137626) - timing_s/agent_loop/tool_calls/mean:np.float64(0.8045835973675821) - timing_s/agent_loop/slowest/generate_sequences:np.float64(85.57219449291006) - timing_s/agent_loop/slowest/tool_calls:np.float64(3.7370561277493834) - timing_s/agent_loop/slowest/prompt_length:333 - timing_s/agent_loop/slowest/response_length:6729 - timing_s/gen:91.7469509600196 - timing_s/reward:0.00012831296771764755 - timing_s/old_log_prob:10.47901373798959 - timing_s/ref:60.00706501794048 - timing_s/adv:0.1278620702214539 - timing_s/update_actor:37.087283317930996 - timing_s/step:199.53717139991932 - timing_s/stop_profile:5.4401811212301254e-05 - timing_per_token_ms/gen:0.16723406796038673 - timing_per_token_ms/update_actor:0.05163475628382261 - timing_per_token_ms/adv:0.00017801591929052896 - timing_per_token_ms/ref:0.08354481375590032 - perf/total_num_tokens:718262 - perf/time_per_step:199.53717139991932 - perf/throughput:899.9100204748748
step:3 - global_seqlen/min:149515 - global_seqlen/max:187397 - global_seqlen/minmax_diff:37882 - global_seqlen/balanced_min:170412 - global_seqlen/balanced_max:173016 - global_seqlen/mean:171672.25 - actor/entropy:0.24318906664848328 - actor/reward_kl_penalty:0.5108004212379456 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.02602824068744667) - actor/pg_clipfrac:np.float64(0.003956168878357857) - actor/ppo_kl:np.float64(-5.473448291013483e-05) - actor/pg_clipfrac_lower:np.float64(6.335708712867927e-06) - actor/grad_norm:np.float64(1.0142240971326828) - perf/mfu/actor:np.float64(0.3674541075290362) - perf/max_memory_allocated_gb:np.float64(44.8550443649292) - perf/max_memory_reserved_gb:np.float64(54.927734375) - perf/cpu_memory_used_gb:np.float64(466.9090270996094) - actor/lr:np.float64(1e-06) - training/global_step:3 - training/epoch:0 - critic/score/mean:-0.6390625238418579 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-1.002004861831665 - critic/rewards/max:0.8817217946052551 - critic/rewards/min:-3.9168224334716797 - critic/advantages/mean:-0.1386910229921341 - critic/advantages/max:3.6992976665496826 - critic/advantages/min:-3.6379377841949463 - critic/returns/mean:-0.1386910229921341 - critic/returns/max:3.6992976665496826 - critic/returns/min:-3.6379377841949463 - response_length/mean:1010.314453125 - response_length/max:8096.0 - response_length/min:12.0 - response_length/clip_ratio:0.001953125 - response_length_non_aborted/mean:1010.314453125 - response_length_non_aborted/max:8096.0 - response_length_non_aborted/min:12.0 - response_length_non_aborted/clip_ratio:0.001953125 - response/aborted_ratio:0.0 - prompt_length/mean:330.875 - prompt_length/max:468.0 - prompt_length/min:268.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(5.9375) - timing_s/start_profile:0.00010426808148622513 - timing_s/agent_loop/generate_sequences/min:np.float64(0.6402053250931203) - timing_s/agent_loop/generate_sequences/max:np.float64(100.38808518298902) - timing_s/agent_loop/generate_sequences/mean:np.float64(26.754821555131457) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(31.90110059711151) - timing_s/agent_loop/tool_calls/mean:np.float64(0.5366958480381072) - timing_s/agent_loop/slowest/generate_sequences:np.float64(100.38808518298902) - timing_s/agent_loop/slowest/tool_calls:np.float64(0.0) - timing_s/agent_loop/slowest/prompt_length:303 - timing_s/agent_loop/slowest/response_length:8096 - timing_s/gen:103.12548574316315 - timing_s/reward:0.0001503999810665846 - timing_s/old_log_prob:9.780556827085093 - timing_s/ref:57.20109071000479 - timing_s/adv:0.11511452891863883 - timing_s/update_actor:34.36545472405851 - timing_s/step:204.65597657393664 - timing_s/stop_profile:5.597993731498718e-05 - timing_per_token_ms/gen:0.19936066807627412 - timing_per_token_ms/update_actor:0.050045151042260046 - timing_per_token_ms/adv:0.0001676370655691861 - timing_per_token_ms/ref:0.08329985001944809 - perf/total_num_tokens:686689 - perf/time_per_step:204.65597657393664 - perf/throughput:838.8333088234024
step:4 - global_seqlen/min:152510 - global_seqlen/max:172773 - global_seqlen/minmax_diff:20263 - global_seqlen/balanced_min:161327 - global_seqlen/balanced_max:163928 - global_seqlen/mean:163143.5 - actor/entropy:0.26186782121658325 - actor/reward_kl_penalty:0.5823132991790771 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.023112027951834823) - actor/pg_clipfrac:np.float64(0.004191005332885604) - actor/ppo_kl:np.float64(-4.468487633714272e-05) - actor/pg_clipfrac_lower:np.float64(2.285553464868204e-05) - actor/grad_norm:np.float64(1.0055070519447327) - perf/mfu/actor:np.float64(0.362891623577111) - perf/max_memory_allocated_gb:np.float64(46.2523193359375) - perf/max_memory_reserved_gb:np.float64(54.927734375) - perf/cpu_memory_used_gb:np.float64(467.0831527709961) - actor/lr:np.float64(1e-06) - training/global_step:4 - training/epoch:0 - critic/score/mean:-0.619921863079071 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-1.001529574394226 - critic/rewards/max:0.8655655384063721 - critic/rewards/min:-4.530736446380615 - critic/advantages/mean:-0.12177855521440506 - critic/advantages/max:3.7021090984344482 - critic/advantages/min:-3.041926860809326 - critic/returns/mean:-0.12177855521440506 - critic/returns/max:3.7021090984344482 - critic/returns/min:-3.041926860809326 - response_length/mean:945.18359375 - response_length/max:8096.0 - response_length/min:5.0 - response_length/clip_ratio:0.00390625 - response_length_non_aborted/mean:945.18359375 - response_length_non_aborted/max:8096.0 - response_length_non_aborted/min:5.0 - response_length_non_aborted/clip_ratio:0.00390625 - response/aborted_ratio:0.0 - prompt_length/mean:329.375 - prompt_length/max:537.0 - prompt_length/min:258.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(6.55859375) - timing_s/start_profile:6.171688437461853e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(0.45610696403309703) - timing_s/agent_loop/generate_sequences/max:np.float64(93.05427579791285) - timing_s/agent_loop/generate_sequences/mean:np.float64(24.635530362059853) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(60.33139015524648) - timing_s/agent_loop/tool_calls/mean:np.float64(0.5906498234558057) - timing_s/agent_loop/slowest/generate_sequences:np.float64(93.05427579791285) - timing_s/agent_loop/slowest/tool_calls:np.float64(0.0) - timing_s/agent_loop/slowest/prompt_length:290 - timing_s/agent_loop/slowest/response_length:8096 - timing_s/gen:95.535578496987 - timing_s/reward:0.00012644589878618717 - timing_s/old_log_prob:9.539186643902212 - timing_s/ref:54.80788536602631 - timing_s/adv:0.07887147692963481 - timing_s/update_actor:33.03896041982807 - timing_s/step:193.06928917602636 - timing_s/stop_profile:5.2791088819503784e-05 - timing_per_token_ms/gen:0.19741447903430426 - timing_per_token_ms/update_actor:0.05062868030266004 - timing_per_token_ms/adv:0.0001208621197437146 - timing_per_token_ms/ref:0.08398723419263764 - perf/total_num_tokens:652574 - perf/time_per_step:193.06928917602636 - perf/throughput:844.9997443729011
step:5 - global_seqlen/min:146648 - global_seqlen/max:184069 - global_seqlen/minmax_diff:37421 - global_seqlen/balanced_min:162863 - global_seqlen/balanced_max:164745 - global_seqlen/mean:163952.0 - actor/entropy:0.26502931118011475 - actor/reward_kl_penalty:0.569793701171875 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.01483340190961826) - actor/pg_clipfrac:np.float64(0.004184927209280431) - actor/ppo_kl:np.float64(-4.099477309864597e-05) - actor/pg_clipfrac_lower:np.float64(1.1765406816266477e-05) - actor/grad_norm:np.float64(0.975027933716774) - perf/mfu/actor:np.float64(0.36517988860162204) - perf/max_memory_allocated_gb:np.float64(46.2523193359375) - perf/max_memory_reserved_gb:np.float64(54.927734375) - perf/cpu_memory_used_gb:np.float64(467.58600997924805) - actor/lr:np.float64(1e-06) - training/global_step:5 - training/epoch:0 - critic/score/mean:-0.462890625 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.8259170055389404 - critic/rewards/max:0.9224634170532227 - critic/rewards/min:-3.976344108581543 - critic/advantages/mean:-0.08537732809782028 - critic/advantages/max:3.6694657802581787 - critic/advantages/min:-3.719907522201538 - critic/returns/mean:-0.08537732809782028 - critic/returns/max:3.6694657802581787 - critic/returns/min:-3.719907522201538 - response_length/mean:956.125 - response_length/max:8096.0 - response_length/min:49.0 - response_length/clip_ratio:0.00390625 - response_length_non_aborted/mean:956.125 - response_length_non_aborted/max:8096.0 - response_length_non_aborted/min:49.0 - response_length_non_aborted/clip_ratio:0.00390625 - response/aborted_ratio:0.0 - prompt_length/mean:324.75 - prompt_length/max:430.0 - prompt_length/min:264.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(6.31640625) - timing_s/start_profile:5.829706788063049e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(1.502825709991157) - timing_s/agent_loop/generate_sequences/max:np.float64(100.4647081559524) - timing_s/agent_loop/generate_sequences/mean:np.float64(24.102258798803632) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(30.344045905629173) - timing_s/agent_loop/tool_calls/mean:np.float64(0.5171126232994538) - timing_s/agent_loop/slowest/generate_sequences:np.float64(100.4647081559524) - timing_s/agent_loop/slowest/tool_calls:np.float64(0.08816167199984193) - timing_s/agent_loop/slowest/prompt_length:298 - timing_s/agent_loop/slowest/response_length:8096 - timing_s/gen:103.06363527895883 - timing_s/reward:0.00011951802298426628 - timing_s/old_log_prob:9.638912113849074 - timing_s/ref:54.91651331493631 - timing_s/adv:0.08390147518366575 - timing_s/update_actor:33.329608927015215 - timing_s/step:201.09328635409474 - timing_s/stop_profile:6.26270193606615e-05 - timing_per_token_ms/gen:0.21053331170528589 - timing_per_token_ms/update_actor:0.050822205473271466 - timing_per_token_ms/adv:0.00012793603491214768 - timing_per_token_ms/ref:0.08373870601599295 - perf/total_num_tokens:655808 - perf/time_per_step:201.09328635409474 - perf/throughput:815.3032006812273
step:6 - global_seqlen/min:161008 - global_seqlen/max:172429 - global_seqlen/minmax_diff:11421 - global_seqlen/balanced_min:164540 - global_seqlen/balanced_max:164541 - global_seqlen/mean:164540.5 - actor/entropy:0.22925853729248047 - actor/reward_kl_penalty:0.5146880745887756 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.011780150685081026) - actor/pg_clipfrac:np.float64(0.003963787574321032) - actor/ppo_kl:np.float64(-4.198399956294452e-05) - actor/pg_clipfrac_lower:np.float64(1.8689485477807467e-05) - actor/grad_norm:np.float64(0.9017820358276367) - perf/mfu/actor:np.float64(0.3637231448583061) - perf/max_memory_allocated_gb:np.float64(46.2523193359375) - perf/max_memory_reserved_gb:np.float64(54.927734375) - perf/cpu_memory_used_gb:np.float64(467.7160530090332) - actor/lr:np.float64(1e-06) - training/global_step:6 - training/epoch:0 - critic/score/mean:-0.546679675579071 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.892321765422821 - critic/rewards/max:0.8899799585342407 - critic/rewards/min:-1.9245257377624512 - critic/advantages/mean:-0.059720125049352646 - critic/advantages/max:3.705561399459839 - critic/advantages/min:-3.2814531326293945 - critic/returns/mean:-0.059720125049352646 - critic/returns/max:3.705561399459839 - critic/returns/min:-3.2814531326293945 - response_length/mean:934.78515625 - response_length/max:3357.0 - response_length/min:9.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:934.78515625 - response_length_non_aborted/max:3357.0 - response_length_non_aborted/min:9.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:350.6875 - prompt_length/max:772.0 - prompt_length/min:259.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(5.70703125) - timing_s/start_profile:0.00010579102672636509 - timing_s/agent_loop/generate_sequences/min:np.float64(0.4598767990246415) - timing_s/agent_loop/generate_sequences/max:np.float64(47.52036978211254) - timing_s/agent_loop/generate_sequences/mean:np.float64(25.221193523577767) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(4.66431581787765) - timing_s/agent_loop/tool_calls/mean:np.float64(0.3657955144931293) - timing_s/agent_loop/slowest/generate_sequences:np.float64(47.52036978211254) - timing_s/agent_loop/slowest/tool_calls:np.float64(1.6860642204992473) - timing_s/agent_loop/slowest/prompt_length:353 - timing_s/agent_loop/slowest/response_length:3357 - timing_s/gen:51.828690472990274 - timing_s/reward:0.00012341118417680264 - timing_s/old_log_prob:9.567866091849282 - timing_s/ref:54.951286824187264 - timing_s/adv:0.10479031899012625 - timing_s/update_actor:33.112527841934934 - timing_s/step:149.63184936298057 - timing_s/stop_profile:6.386288441717625e-05 - timing_per_token_ms/gen:0.10829002835918655 - timing_per_token_ms/update_actor:0.0503106041399153 - timing_per_token_ms/adv:0.0001592166047114939 - timing_per_token_ms/ref:0.08349203816717961 - perf/total_num_tokens:658162 - perf/time_per_step:149.63184936298057 - perf/throughput:1099.6355435055384
step:7 - global_seqlen/min:156914 - global_seqlen/max:173458 - global_seqlen/minmax_diff:16544 - global_seqlen/balanced_min:167626 - global_seqlen/balanced_max:170139 - global_seqlen/mean:168259.75 - actor/entropy:0.2450588196516037 - actor/reward_kl_penalty:0.6004098653793335 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.004399651636413182) - actor/pg_clipfrac:np.float64(0.0042205078760162) - actor/ppo_kl:np.float64(3.246542282795417e-05) - actor/pg_clipfrac_lower:np.float64(1.1469251330709084e-05) - actor/grad_norm:np.float64(1.0054369419813156) - perf/mfu/actor:np.float64(0.3681632846990318) - perf/max_memory_allocated_gb:np.float64(46.2523193359375) - perf/max_memory_reserved_gb:np.float64(54.927734375) - perf/cpu_memory_used_gb:np.float64(467.7640151977539) - actor/lr:np.float64(1e-06) - training/global_step:7 - training/epoch:0 - critic/score/mean:-0.602343738079071 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.9552000164985657 - critic/rewards/max:0.8825898170471191 - critic/rewards/min:-2.2062594890594482 - critic/advantages/mean:-0.024702806025743484 - critic/advantages/max:3.597823143005371 - critic/advantages/min:-3.4714725017547607 - critic/returns/mean:-0.024702806025743484 - critic/returns/max:3.597823143005371 - critic/returns/min:-3.4714725017547607 - response_length/mean:974.998046875 - response_length/max:8096.0 - response_length/min:6.0 - response_length/clip_ratio:0.001953125 - response_length_non_aborted/mean:974.998046875 - response_length_non_aborted/max:8096.0 - response_length_non_aborted/min:6.0 - response_length_non_aborted/clip_ratio:0.001953125 - response/aborted_ratio:0.0 - prompt_length/mean:339.53125 - prompt_length/max:557.0 - prompt_length/min:275.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(7.19140625) - timing_s/start_profile:6.063678301870823e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(0.46849408093839884) - timing_s/agent_loop/generate_sequences/max:np.float64(97.5190007709898) - timing_s/agent_loop/generate_sequences/mean:np.float64(25.48423054074874) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(30.24343427713029) - timing_s/agent_loop/tool_calls/mean:np.float64(0.5218585230782082) - timing_s/agent_loop/slowest/generate_sequences:np.float64(97.5190007709898) - timing_s/agent_loop/slowest/tool_calls:np.float64(0.3080900178756565) - timing_s/agent_loop/slowest/prompt_length:316 - timing_s/agent_loop/slowest/response_length:8096 - timing_s/gen:100.35253909602761 - timing_s/reward:0.00012529105879366398 - timing_s/old_log_prob:9.781488807871938 - timing_s/ref:56.101897763088346 - timing_s/adv:0.06242713215760887 - timing_s/update_actor:33.62906268797815 - timing_s/step:200.01377694797702 - timing_s/stop_profile:5.612196400761604e-05 - timing_per_token_ms/gen:0.20102712364413314 - timing_per_token_ms/update_actor:0.04996599407757671 - timing_per_token_ms/adv:9.275410809419493e-05 - timing_per_token_ms/ref:0.0833560874824317 - perf/total_num_tokens:673039 - perf/time_per_step:200.01377694797702 - perf/throughput:841.2408013462185
step:8 - global_seqlen/min:157035 - global_seqlen/max:172353 - global_seqlen/minmax_diff:15318 - global_seqlen/balanced_min:164830 - global_seqlen/balanced_max:166025 - global_seqlen/mean:165555.5 - actor/entropy:0.24964067339897156 - actor/reward_kl_penalty:0.5435034036636353 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.024571306587313303) - actor/pg_clipfrac:np.float64(0.0038976273266598583) - actor/ppo_kl:np.float64(8.540721628378379e-05) - actor/pg_clipfrac_lower:np.float64(2.2747952243662438e-06) - actor/grad_norm:np.float64(0.937162384390831) - perf/mfu/actor:np.float64(0.3655072697968738) - perf/max_memory_allocated_gb:np.float64(46.2523193359375) - perf/max_memory_reserved_gb:np.float64(54.927734375) - perf/cpu_memory_used_gb:np.float64(467.8152084350586) - actor/lr:np.float64(1e-06) - training/global_step:8 - training/epoch:0 - critic/score/mean:-0.5835937857627869 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.9581018686294556 - critic/rewards/max:0.8933286070823669 - critic/rewards/min:-3.7806174755096436 - critic/advantages/mean:-0.1338537186384201 - critic/advantages/max:3.670172929763794 - critic/advantages/min:-3.7136664390563965 - critic/returns/mean:-0.1338537186384201 - critic/returns/max:3.670172929763794 - critic/returns/min:-3.7136664390563965 - response_length/mean:970.05859375 - response_length/max:7377.0 - response_length/min:8.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:970.05859375 - response_length_non_aborted/max:7377.0 - response_length_non_aborted/min:8.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:323.34375 - prompt_length/max:434.0 - prompt_length/min:266.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(6.28125) - timing_s/start_profile:6.572692655026913e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(0.48254546197131276) - timing_s/agent_loop/generate_sequences/max:np.float64(81.06871618912555) - timing_s/agent_loop/generate_sequences/mean:np.float64(24.427063471199745) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(60.257843408035114) - timing_s/agent_loop/tool_calls/mean:np.float64(1.3900098666508711) - timing_s/agent_loop/slowest/generate_sequences:np.float64(81.06871618912555) - timing_s/agent_loop/slowest/tool_calls:np.float64(0.18478981195949018) - timing_s/agent_loop/slowest/prompt_length:299 - timing_s/agent_loop/slowest/response_length:7377 - timing_s/gen:83.68729490390979 - timing_s/reward:0.00012358487583696842 - timing_s/old_log_prob:9.707169047091156 - timing_s/ref:55.0896009739954 - timing_s/adv:0.07541269203647971 - timing_s/update_actor:33.361490121111274 - timing_s/step:181.99027664586902 - timing_s/stop_profile:5.446700379252434e-05 - timing_per_token_ms/gen:0.1684967783516415 - timing_per_token_ms/update_actor:0.05037810601446535 - timing_per_token_ms/adv:0.00011387826444376616 - timing_per_token_ms/ref:0.08318902267516845 - perf/total_num_tokens:662222 - perf/time_per_step:181.99027664586902 - perf/throughput:909.6942048291454
step:9 - global_seqlen/min:161198 - global_seqlen/max:182799 - global_seqlen/minmax_diff:21601 - global_seqlen/balanced_min:171928 - global_seqlen/balanced_max:171929 - global_seqlen/mean:171928.5 - actor/entropy:0.24633610248565674 - actor/reward_kl_penalty:0.5800730586051941 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.007781547331615002) - actor/pg_clipfrac:np.float64(0.0040203968295827505) - actor/ppo_kl:np.float64(4.3545138942135965e-05) - actor/pg_clipfrac_lower:np.float64(1.160309839178808e-05) - actor/grad_norm:np.float64(0.9487475752830505) - perf/mfu/actor:np.float64(0.3626193441082744) - perf/max_memory_allocated_gb:np.float64(46.2523193359375) - perf/max_memory_reserved_gb:np.float64(54.927734375) - perf/cpu_memory_used_gb:np.float64(467.89770889282227) - actor/lr:np.float64(1e-06) - training/global_step:9 - training/epoch:0 - critic/score/mean:-0.5999999642372131 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.9577032923698425 - critic/rewards/max:0.8420055508613586 - critic/rewards/min:-2.411332607269287 - critic/advantages/mean:-0.04583749547600746 - critic/advantages/max:3.4811532497406006 - critic/advantages/min:-3.289898633956909 - critic/returns/mean:-0.04583749547600746 - critic/returns/max:3.4811532497406006 - critic/returns/min:-3.289898633956909 - response_length/mean:1010.84765625 - response_length/max:3966.0 - response_length/min:135.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:1010.84765625 - response_length_non_aborted/max:3966.0 - response_length_non_aborted/min:135.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:332.34375 - prompt_length/max:440.0 - prompt_length/min:274.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(7.2421875) - timing_s/start_profile:7.575401104986668e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(4.065254672896117) - timing_s/agent_loop/generate_sequences/max:np.float64(56.48615841544233) - timing_s/agent_loop/generate_sequences/mean:np.float64(26.078915788785253) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(30.23740880819969) - timing_s/agent_loop/tool_calls/mean:np.float64(0.7924721720100933) - timing_s/agent_loop/slowest/generate_sequences:np.float64(56.48615841544233) - timing_s/agent_loop/slowest/tool_calls:np.float64(2.0012640431523323) - timing_s/agent_loop/slowest/prompt_length:345 - timing_s/agent_loop/slowest/response_length:3966 - timing_s/gen:60.94509434583597 - timing_s/reward:0.00013376795686781406 - timing_s/old_log_prob:9.966102228034288 - timing_s/ref:57.285408962052315 - timing_s/adv:0.10377899184823036 - timing_s/update_actor:34.81627056002617 - timing_s/step:163.1839398278389 - timing_s/stop_profile:5.6658871471881866e-05 - timing_per_token_ms/gen:0.11775601066910113 - timing_per_token_ms/update_actor:0.05062608956634032 - timing_per_token_ms/adv:0.00015090428848072072 - timing_per_token_ms/ref:0.0832983027276634 - perf/total_num_tokens:687714 - perf/time_per_step:163.1839398278389 - perf/throughput:1053.5871371985913
test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 10}
validation generation end
len reward_extra_infos_dict['reward']: 960
len reward_extra_infos_dict['score']: 960
len reward_extra_infos_dict['acc']: 960
len reward_extra_infos_dict['pred']: 960
step:10 - global_seqlen/min:136239 - global_seqlen/max:181838 - global_seqlen/minmax_diff:45599 - global_seqlen/balanced_min:163964 - global_seqlen/balanced_max:167721 - global_seqlen/mean:164903.75 - actor/entropy:0.23330633342266083 - actor/reward_kl_penalty:0.5666540265083313 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.010595886169176083) - actor/pg_clipfrac:np.float64(0.004368684091605246) - actor/ppo_kl:np.float64(8.312305162689881e-05) - actor/pg_clipfrac_lower:np.float64(4.785485725733452e-06) - actor/grad_norm:np.float64(0.9946784824132919) - perf/mfu/actor:np.float64(0.36398793005703817) - perf/max_memory_allocated_gb:np.float64(46.2523193359375) - perf/max_memory_reserved_gb:np.float64(54.927734375) - perf/cpu_memory_used_gb:np.float64(468.04705810546875) - actor/lr:np.float64(1e-06) - val-aux/aime_2024/reward/mean@16:np.float64(-0.7239583319673936) - val-aux/aime_2024/reward/std@16:np.float64(0.22655807506061887) - val-aux/aime_2024/reward/best@2/mean:np.float64(-0.6210633374929427) - val-aux/aime_2024/reward/best@2/std:np.float64(0.23737959874573497) - val-aux/aime_2024/reward/worst@2/mean:np.float64(-0.8249799931367239) - val-aux/aime_2024/reward/worst@2/std:np.float64(0.1413159059538991) - val-aux/aime_2024/reward/maj@2/mean:np.float64(-0.7224299986501533) - val-aux/aime_2024/reward/maj@2/std:np.float64(0.23029873350109722) - val-aux/aime_2024/reward/best@4/mean:np.float64(-0.5189500092307726) - val-aux/aime_2024/reward/best@4/std:np.float64(0.235476210618219) - val-aux/aime_2024/reward/worst@4/mean:np.float64(-0.8905766562759877) - val-aux/aime_2024/reward/worst@4/std:np.float64(0.08932559702552224) - val-aux/aime_2024/reward/maj@4/mean:np.float64(-0.710769998852412) - val-aux/aime_2024/reward/maj@4/std:np.float64(0.22661854685879465) - val-aux/aime_2024/reward/best@8/mean:np.float64(-0.4143000123659771) - val-aux/aime_2024/reward/best@8/std:np.float64(0.22389698294011984) - val-aux/aime_2024/reward/worst@8/mean:np.float64(-0.9323233225325743) - val-aux/aime_2024/reward/worst@8/std:np.float64(0.057500002143465304) - val-aux/aime_2024/reward/maj@8/mean:np.float64(-0.701049998941024) - val-aux/aime_2024/reward/maj@8/std:np.float64(0.21281908914551725) - val-aux/aime_2024/reward/best@16/mean:np.float64(-0.3061000136435032) - val-aux/aime_2024/reward/best@16/std:np.float64(0.18714057098279302) - val-aux/aime_2024/reward/worst@16/mean:np.float64(-0.9568033242801824) - val-aux/aime_2024/reward/worst@16/std:np.float64(0.03303200757964101) - val-aux/aime_2024/reward/maj@16/mean:np.float64(-0.694149999241034) - val-aux/aime_2024/reward/maj@16/std:np.float64(0.19923961539562918) - val-aux/aime_2024/score/mean@16:np.float64(-0.7239583333333333) - val-aux/aime_2024/score/std@16:np.float64(0.22655808386134335) - val-aux/aime_2024/score/best@2/mean:np.float64(-0.6210633333333333) - val-aux/aime_2024/score/best@2/std:np.float64(0.23737960685192797) - val-aux/aime_2024/score/worst@2/mean:np.float64(-0.8249800000000002) - val-aux/aime_2024/score/worst@2/std:np.float64(0.14131591203351743) - val-aux/aime_2024/score/maj@2/mean:np.float64(-0.72243) - val-aux/aime_2024/score/maj@2/std:np.float64(0.23029874230342498) - val-aux/aime_2024/score/best@4/mean:np.float64(-0.5189499999999999) - val-aux/aime_2024/score/best@4/std:np.float64(0.23547621575473496) - val-aux/aime_2024/score/worst@4/mean:np.float64(-0.8905766666666668) - val-aux/aime_2024/score/worst@4/std:np.float64(0.08932559812851928) - val-aux/aime_2024/score/maj@4/mean:np.float64(-0.71077) - val-aux/aime_2024/score/maj@4/std:np.float64(0.2266185557587995) - val-aux/aime_2024/score/best@8/mean:np.float64(-0.41429999999999995) - val-aux/aime_2024/score/best@8/std:np.float64(0.22389698535584512) - val-aux/aime_2024/score/worst@8/mean:np.float64(-0.9323233333333334) - val-aux/aime_2024/score/worst@8/std:np.float64(0.057499999264498045) - val-aux/aime_2024/score/maj@8/mean:np.float64(-0.7010500000000001) - val-aux/aime_2024/score/maj@8/std:np.float64(0.2128190979497866) - val-aux/aime_2024/score/best@16/mean:np.float64(-0.30609999999999987) - val-aux/
step:11 - global_seqlen/min:161187 - global_seqlen/max:189911 - global_seqlen/minmax_diff:28724 - global_seqlen/balanced_min:178954 - global_seqlen/balanced_max:180556 - global_seqlen/mean:179698.25 - actor/entropy:0.21958743035793304 - actor/reward_kl_penalty:0.5516255497932434 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.01228489834886659) - actor/pg_clipfrac:np.float64(0.0038442372577264907) - actor/ppo_kl:np.float64(-4.157127937105542e-05) - actor/pg_clipfrac_lower:np.float64(2.1143128105904906e-05) - actor/grad_norm:np.float64(0.8829494714736938) - perf/mfu/actor:np.float64(0.3613251902915855) - perf/max_memory_allocated_gb:np.float64(46.2523193359375) - perf/max_memory_reserved_gb:np.float64(54.966796875) - perf/cpu_memory_used_gb:np.float64(468.1924591064453) - actor/lr:np.float64(1e-06) - training/global_step:11 - training/epoch:0 - critic/score/mean:-0.6123046875 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.984620213508606 - critic/rewards/max:0.9000694751739502 - critic/rewards/min:-2.2984466552734375 - critic/advantages/mean:-0.06766531616449356 - critic/advantages/max:3.638265609741211 - critic/advantages/min:-3.2743477821350098 - critic/returns/mean:-0.06766531616449356 - critic/returns/max:3.638265609741211 - critic/returns/min:-3.2743477821350098 - response_length/mean:1076.267578125 - response_length/max:8096.0 - response_length/min:236.0 - response_length/clip_ratio:0.001953125 - response_length_non_aborted/mean:1076.267578125 - response_length_non_aborted/max:8096.0 - response_length_non_aborted/min:236.0 - response_length_non_aborted/clip_ratio:0.001953125 - response/aborted_ratio:0.0 - prompt_length/mean:327.625 - prompt_length/max:401.0 - prompt_length/min:272.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(7.609375) - timing_s/start_profile:5.498086102306843e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(6.720138845965266) - timing_s/agent_loop/generate_sequences/max:np.float64(90.09499982185662) - timing_s/agent_loop/generate_sequences/mean:np.float64(26.778412140616183) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(31.288145889993757) - timing_s/agent_loop/tool_calls/mean:np.float64(2.511279413142347) - timing_s/agent_loop/slowest/generate_sequences:np.float64(90.09499982185662) - timing_s/agent_loop/slowest/tool_calls:np.float64(5.7277548890560865) - timing_s/agent_loop/slowest/prompt_length:350 - timing_s/agent_loop/slowest/response_length:8096 - timing_s/gen:97.8665100459475 - timing_s/reward:0.0001403680071234703 - timing_s/old_log_prob:10.2712844600901 - timing_s/ref:59.73569254204631 - timing_s/adv:0.0909098400734365 - timing_s/update_actor:36.48660157015547 - timing_s/step:204.52883694600314 - timing_s/stop_profile:5.319202318787575e-05 - timing_per_token_ms/gen:0.17760037681938903 - timing_per_token_ms/update_actor:0.050760930574108916 - timing_per_token_ms/adv:0.00012647568920876596 - timing_per_token_ms/ref:0.08310555687387929 - perf/total_num_tokens:718793 - perf/time_per_step:204.52883694600314 - perf/throughput:878.5961563329157
step:12 - global_seqlen/min:153393 - global_seqlen/max:203154 - global_seqlen/minmax_diff:49761 - global_seqlen/balanced_min:174230 - global_seqlen/balanced_max:176400 - global_seqlen/mean:174772.75 - actor/entropy:0.21843977272510529 - actor/reward_kl_penalty:0.5670920610427856 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.007456358772833483) - actor/pg_clipfrac:np.float64(0.0039582174271345135) - actor/ppo_kl:np.float64(2.2026691203791417e-05) - actor/pg_clipfrac_lower:np.float64(1.775603959686123e-05) - actor/grad_norm:np.float64(0.9522787779569626) - perf/mfu/actor:np.float64(0.36020650322485254) - perf/max_memory_allocated_gb:np.float64(46.2523193359375) - perf/max_memory_reserved_gb:np.float64(54.966796875) - perf/cpu_memory_used_gb:np.float64(468.1074523925781) - actor/lr:np.float64(1e-06) - training/global_step:12 - training/epoch:0 - critic/score/mean:-0.6042969226837158 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.9490520358085632 - critic/rewards/max:0.9888969659805298 - critic/rewards/min:-2.825739860534668 - critic/advantages/mean:-0.040785808116197586 - critic/advantages/max:3.7146928310394287 - critic/advantages/min:-3.5110931396484375 - critic/returns/mean:-0.040785808116197586 - critic/returns/max:3.7146928310394287 - critic/returns/min:-3.5110931396484375 - response_length/mean:1028.162109375 - response_length/max:8096.0 - response_length/min:6.0 - response_length/clip_ratio:0.001953125 - response_length_non_aborted/mean:1028.162109375 - response_length_non_aborted/max:8096.0 - response_length_non_aborted/min:6.0 - response_length_non_aborted/clip_ratio:0.001953125 - response/aborted_ratio:0.0 - prompt_length/mean:337.25 - prompt_length/max:427.0 - prompt_length/min:269.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(7.2734375) - timing_s/start_profile:5.8306846767663956e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(0.3552596289664507) - timing_s/agent_loop/generate_sequences/max:np.float64(100.63261979399249) - timing_s/agent_loop/generate_sequences/mean:np.float64(27.064656318724246) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(30.373965320875868) - timing_s/agent_loop/tool_calls/mean:np.float64(0.6696075017894145) - timing_s/agent_loop/slowest/generate_sequences:np.float64(100.63261979399249) - timing_s/agent_loop/slowest/tool_calls:np.float64(0.0) - timing_s/agent_loop/slowest/prompt_length:291 - timing_s/agent_loop/slowest/response_length:8096 - timing_s/gen:103.16781840310432 - timing_s/reward:0.0001173859927803278 - timing_s/old_log_prob:10.05470555787906 - timing_s/ref:58.182226683944464 - timing_s/adv:0.09678447293117642 - timing_s/update_actor:35.58419511583634 - timing_s/step:207.1580994031392 - timing_s/stop_profile:5.1629962399601936e-05 - timing_per_token_ms/gen:0.19598042320490772 - timing_per_token_ms/update_actor:0.050900662597339025 - timing_per_token_ms/adv:0.00013844331128733803 - timing_per_token_ms/ref:0.08322554100102056 - perf/total_num_tokens:699091 - perf/time_per_step:207.1580994031392 - perf/throughput:843.6684373121428
step:13 - global_seqlen/min:142723 - global_seqlen/max:165885 - global_seqlen/minmax_diff:23162 - global_seqlen/balanced_min:155037 - global_seqlen/balanced_max:155354 - global_seqlen/mean:155195.5 - actor/entropy:0.22019650042057037 - actor/reward_kl_penalty:0.6255427598953247 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.00089092413918479) - actor/pg_clipfrac:np.float64(0.004286309704184532) - actor/ppo_kl:np.float64(-0.0001245762967698738) - actor/pg_clipfrac_lower:np.float64(2.0821332100240397e-05) - actor/grad_norm:np.float64(1.0308312326669693) - perf/mfu/actor:np.float64(0.3655370969614931) - perf/max_memory_allocated_gb:np.float64(46.2523193359375) - perf/max_memory_reserved_gb:np.float64(54.966796875) - perf/cpu_memory_used_gb:np.float64(468.1863327026367) - actor/lr:np.float64(1e-06) - training/global_step:13 - training/epoch:0 - critic/score/mean:-0.552539050579071 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.8918749690055847 - critic/rewards/max:0.9143286943435669 - critic/rewards/min:-1.8284335136413574 - critic/advantages/mean:-0.006455232389271259 - critic/advantages/max:3.607182741165161 - critic/advantages/min:-3.4154739379882812 - critic/returns/mean:-0.006455232389271259 - critic/returns/max:3.607182741165161 - critic/returns/min:-3.4154739379882812 - response_length/mean:894.33984375 - response_length/max:4466.0 - response_length/min:5.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:894.33984375 - response_length_non_aborted/max:4466.0 - response_length_non_aborted/min:5.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:318.125 - prompt_length/max:420.0 - prompt_length/min:263.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(7.234375) - timing_s/start_profile:6.595393642783165e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(0.33479884499683976) - timing_s/agent_loop/generate_sequences/max:np.float64(56.767125367186964) - timing_s/agent_loop/generate_sequences/mean:np.float64(23.40230241250174) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(30.362349602160975) - timing_s/agent_loop/tool_calls/mean:np.float64(0.7284688355048274) - timing_s/agent_loop/slowest/generate_sequences:np.float64(56.767125367186964) - timing_s/agent_loop/slowest/tool_calls:np.float64(0.4791603172197938) - timing_s/agent_loop/slowest/prompt_length:301 - timing_s/agent_loop/slowest/response_length:4466 - timing_s/gen:59.7312528998591 - timing_s/reward:0.00013204594142735004 - timing_s/old_log_prob:9.109624776989222 - timing_s/ref:51.49579250300303 - timing_s/adv:0.10819298517890275 - timing_s/update_actor:31.132924276869744 - timing_s/step:151.6558798130136 - timing_s/stop_profile:5.616107955574989e-05 - timing_per_token_ms/gen:0.1304454946688573 - timing_per_token_ms/update_actor:0.05015113884885474 - timing_per_token_ms/adv:0.0001742849908323739 - timing_per_token_ms/ref:0.08295310189890015 - perf/total_num_tokens:620782 - perf/time_per_step:151.6558798130136 - perf/throughput:1023.3398150559716
step:14 - global_seqlen/min:156002 - global_seqlen/max:176199 - global_seqlen/minmax_diff:20197 - global_seqlen/balanced_min:164228 - global_seqlen/balanced_max:166143 - global_seqlen/mean:164707.25 - actor/entropy:0.24432510137557983 - actor/reward_kl_penalty:0.5485939383506775 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.007158251917280723) - actor/pg_clipfrac:np.float64(0.004142890707589686) - actor/ppo_kl:np.float64(4.408098666317528e-05) - actor/pg_clipfrac_lower:np.float64(2.3885791597422214e-05) - actor/grad_norm:np.float64(0.9341793209314346) - perf/mfu/actor:np.float64(0.36394788004481854) - perf/max_memory_allocated_gb:np.float64(46.2523193359375) - perf/max_memory_reserved_gb:np.float64(54.966796875) - perf/cpu_memory_used_gb:np.float64(468.31614685058594) - actor/lr:np.float64(1e-06) - training/global_step:14 - training/epoch:0 - critic/score/mean:-0.502734363079071 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.8565274477005005 - critic/rewards/max:0.9023334383964539 - critic/rewards/min:-3.9663307666778564 - critic/advantages/mean:-0.04234332963824272 - critic/advantages/max:3.7127859592437744 - critic/advantages/min:-3.104361057281494 - critic/returns/mean:-0.04234332963824272 - critic/returns/max:3.7127859592437744 - critic/returns/min:-3.104361057281494 - response_length/mean:951.244140625 - response_length/max:6177.0 - response_length/min:8.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:951.244140625 - response_length_non_aborted/max:6177.0 - response_length_non_aborted/min:8.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:335.53125 - prompt_length/max:437.0 - prompt_length/min:258.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(7.10546875) - timing_s/start_profile:6.113201379776001e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(0.4734042380005121) - timing_s/agent_loop/generate_sequences/max:np.float64(71.86876056808978) - timing_s/agent_loop/generate_sequences/mean:np.float64(25.97233979958628) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(30.18494823598303) - timing_s/agent_loop/tool_calls/mean:np.float64(0.5858018024232479) - timing_s/agent_loop/slowest/generate_sequences:np.float64(71.86876056808978) - timing_s/agent_loop/slowest/tool_calls:np.float64(0.0) - timing_s/agent_loop/slowest/prompt_length:327 - timing_s/agent_loop/slowest/response_length:6177 - timing_s/gen:74.32926522498019 - timing_s/reward:0.00012357509694993496 - timing_s/old_log_prob:9.510066298069432 - timing_s/ref:54.95491279102862 - timing_s/adv:0.08677530591376126 - timing_s/update_actor:33.13306456198916 - timing_s/step:172.08541772095487 - timing_s/stop_profile:5.256687290966511e-05 - timing_per_token_ms/gen:0.15261523298020518 - timing_per_token_ms/update_actor:0.0502908411165707 - timing_per_token_ms/adv:0.00013171142422959716 - timing_per_token_ms/ref:0.08341301428903193 - perf/total_num_tokens:658829 - perf/time_per_step:172.08541772095487 - perf/throughput:957.1249684100547
step:15 - global_seqlen/min:140257 - global_seqlen/max:181400 - global_seqlen/minmax_diff:41143 - global_seqlen/balanced_min:164246 - global_seqlen/balanced_max:166715 - global_seqlen/mean:166097.25 - actor/entropy:0.2264733910560608 - actor/reward_kl_penalty:0.5748942494392395 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.0038658926379866896) - actor/pg_clipfrac:np.float64(0.004221084504388272) - actor/ppo_kl:np.float64(4.46439944425947e-06) - actor/pg_clipfrac_lower:np.float64(1.6548226813029033e-05) - actor/grad_norm:np.float64(0.9700827747583389) - perf/mfu/actor:np.float64(0.3665579117139608) - perf/max_memory_allocated_gb:np.float64(46.2523193359375) - perf/max_memory_reserved_gb:np.float64(54.966796875) - perf/cpu_memory_used_gb:np.float64(468.4428405761719) - actor/lr:np.float64(1e-06) - training/global_step:15 - training/epoch:0 - critic/score/mean:-0.500781238079071 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.8372568488121033 - critic/rewards/max:0.8607249855995178 - critic/rewards/min:-2.9954590797424316 - critic/advantages/mean:-0.0297269057482481 - critic/advantages/max:3.6635565757751465 - critic/advantages/min:-3.5032882690429688 - critic/returns/mean:-0.0297269057482481 - critic/returns/max:3.6635565757751465 - critic/returns/min:-3.5032882690429688 - response_length/mean:973.009765625 - response_length/max:8096.0 - response_length/min:104.0 - response_length/clip_ratio:0.001953125 - response_length_non_aborted/mean:973.009765625 - response_length_non_aborted/max:8096.0 - response_length_non_aborted/min:104.0 - response_length_non_aborted/clip_ratio:0.001953125 - response/aborted_ratio:0.0 - prompt_length/mean:324.625 - prompt_length/max:445.0 - prompt_length/min:265.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(7.3046875) - timing_s/start_profile:0.00014177593402564526 - timing_s/agent_loop/generate_sequences/min:np.float64(3.127594601130113) - timing_s/agent_loop/generate_sequences/max:np.float64(100.79334642016329) - timing_s/agent_loop/generate_sequences/mean:np.float64(24.82861017191499) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(30.06803590315394) - timing_s/agent_loop/tool_calls/mean:np.float64(0.5738259543236381) - timing_s/agent_loop/slowest/generate_sequences:np.float64(100.79334642016329) - timing_s/agent_loop/slowest/tool_calls:np.float64(0.0919024208560586) - timing_s/agent_loop/slowest/prompt_length:294 - timing_s/agent_loop/slowest/response_length:8096 - timing_s/gen:103.4504931429401 - timing_s/reward:0.0001344829797744751 - timing_s/old_log_prob:9.721519356127828 - timing_s/ref:55.375505617121235 - timing_s/adv:0.07753196894191206 - timing_s/update_actor:33.49497012794018 - timing_s/step:202.19267798401415 - timing_s/stop_profile:5.4612988606095314e-05 - timing_per_token_ms/gen:0.20765644041611403 - timing_per_token_ms/update_actor:0.050414697004225205 - timing_per_token_ms/adv:0.00011669664750908286 - timing_per_token_ms/ref:0.08334801692550785 - perf/total_num_tokens:664389 - perf/time_per_step:202.19267798401415 - perf/throughput:821.4800439664391
step:16 - global_seqlen/min:148760 - global_seqlen/max:178597 - global_seqlen/minmax_diff:29837 - global_seqlen/balanced_min:165880 - global_seqlen/balanced_max:167459 - global_seqlen/mean:166275.0 - actor/entropy:0.23104505240917206 - actor/reward_kl_penalty:0.5939845442771912 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.012439391102088849) - actor/pg_clipfrac:np.float64(0.004084257734939456) - actor/ppo_kl:np.float64(-6.89983120537363e-05) - actor/pg_clipfrac_lower:np.float64(9.491416494711303e-06) - actor/grad_norm:np.float64(0.9790653884410858) - perf/mfu/actor:np.float64(0.36576985388788) - perf/max_memory_allocated_gb:np.float64(46.2523193359375) - perf/max_memory_reserved_gb:np.float64(54.966796875) - perf/cpu_memory_used_gb:np.float64(468.67696380615234) - actor/lr:np.float64(1e-06) - training/global_step:16 - training/epoch:0 - critic/score/mean:-0.6480468511581421 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.9965061545372009 - critic/rewards/max:0.8855043053627014 - critic/rewards/min:-2.8980212211608887 - critic/advantages/mean:-0.06699670106172562 - critic/advantages/max:3.5975611209869385 - critic/advantages/min:-3.595620632171631 - critic/returns/mean:-0.06699670106172562 - critic/returns/max:3.5975611209869385 - critic/returns/min:-3.595620632171631 - response_length/mean:962.6796875 - response_length/max:5644.0 - response_length/min:12.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:962.6796875 - response_length_non_aborted/max:5644.0 - response_length_non_aborted/min:12.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:336.34375 - prompt_length/max:551.0 - prompt_length/min:267.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(7.71875) - timing_s/start_profile:6.220606155693531e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(0.566809464013204) - timing_s/agent_loop/generate_sequences/max:np.float64(68.081245057052) - timing_s/agent_loop/generate_sequences/mean:np.float64(25.745040457028608) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(60.2441287310794) - timing_s/agent_loop/tool_calls/mean:np.float64(1.0227432154370035) - timing_s/agent_loop/slowest/generate_sequences:np.float64(17.75624332181178) - timing_s/agent_loop/slowest/tool_calls:np.float64(60.2441287310794) - timing_s/agent_loop/slowest/prompt_length:277 - timing_s/agent_loop/slowest/response_length:1115 - timing_s/gen:80.75349552300759 - timing_s/reward:0.00015503307804465294 - timing_s/old_log_prob:9.717671832069755 - timing_s/ref:55.2576448880136 - timing_s/adv:0.08480773796327412 - timing_s/update_actor:33.381504364078864 - timing_s/step:179.24811282986775 - timing_s/stop_profile:5.3338008001446724e-05 - timing_per_token_ms/gen:0.16383608482792902 - timing_per_token_ms/update_actor:0.05019020352440064 - timing_per_token_ms/adv:0.00012751125840215625 - timing_per_token_ms/ref:0.08308170934899053 - perf/total_num_tokens:665100 - perf/time_per_step:179.24811282986775 - perf/throughput:927.6248289309406
step:17 - global_seqlen/min:157232 - global_seqlen/max:182298 - global_seqlen/minmax_diff:25066 - global_seqlen/balanced_min:164140 - global_seqlen/balanced_max:164141 - global_seqlen/mean:164140.5 - actor/entropy:0.21283023059368134 - actor/reward_kl_penalty:0.5865206718444824 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.0019703569101693573) - actor/pg_clipfrac:np.float64(0.004125527397263795) - actor/ppo_kl:np.float64(6.305893748503877e-06) - actor/pg_clipfrac_lower:np.float64(3.373562594788382e-05) - actor/grad_norm:np.float64(0.966319277882576) - perf/mfu/actor:np.float64(0.36334891915551243) - perf/max_memory_allocated_gb:np.float64(46.2523193359375) - perf/max_memory_reserved_gb:np.float64(54.966796875) - perf/cpu_memory_used_gb:np.float64(468.4852828979492) - actor/lr:np.float64(1e-06) - training/global_step:17 - training/epoch:0 - critic/score/mean:-0.49531251192092896 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.8410387635231018 - critic/rewards/max:0.874224066734314 - critic/rewards/min:-2.2862889766693115 - critic/advantages/mean:-0.014513414353132248 - critic/advantages/max:3.6521220207214355 - critic/advantages/min:-2.0557918548583984 - critic/returns/mean:-0.014513414353132248 - critic/returns/max:3.6521220207214355 - critic/returns/min:-2.0557918548583984 - response_length/mean:954.28515625 - response_length/max:3362.0 - response_length/min:8.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:954.28515625 - response_length_non_aborted/max:3362.0 - response_length_non_aborted/min:8.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:328.0625 - prompt_length/max:497.0 - prompt_length/min:265.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(7.734375) - timing_s/start_profile:7.680593989789486e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(0.43133222102187574) - timing_s/agent_loop/generate_sequences/max:np.float64(49.84971965407021) - timing_s/agent_loop/generate_sequences/mean:np.float64(25.525976714417993) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(30.157580162631348) - timing_s/agent_loop/tool_calls/mean:np.float64(0.5610466940897822) - timing_s/agent_loop/slowest/generate_sequences:np.float64(28.151038920041174) - timing_s/agent_loop/slowest/tool_calls:np.float64(30.157580162631348) - timing_s/agent_loop/slowest/prompt_length:438 - timing_s/agent_loop/slowest/response_length:1039 - timing_s/gen:60.743662619031966 - timing_s/reward:0.00011571589857339859 - timing_s/old_log_prob:9.487195872003213 - timing_s/ref:54.95735013787635 - timing_s/adv:0.10487937112338841 - timing_s/update_actor:33.11721238703467 - timing_s/step:158.46981038502418 - timing_s/stop_profile:5.0928909331560135e-05 - timing_per_token_ms/gen:0.12432339042033255 - timing_per_token_ms/update_actor:0.05044034285723918 - timing_per_token_ms/adv:0.00015974023949511 - timing_per_token_ms/ref:0.08370473791945977 - perf/total_num_tokens:656562 - perf/time_per_step:158.46981038502418 - perf/throughput:1035.784037358271
step:18 - global_seqlen/min:152940 - global_seqlen/max:182686 - global_seqlen/minmax_diff:29746 - global_seqlen/balanced_min:166727 - global_seqlen/balanced_max:167871 - global_seqlen/mean:167013.5 - actor/entropy:0.22460120916366577 - actor/reward_kl_penalty:0.5966156721115112 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.005391099042026326) - actor/pg_clipfrac:np.float64(0.0036783247021958234) - actor/ppo_kl:np.float64(-1.6490222151333e-05) - actor/pg_clipfrac_lower:np.float64(1.673230108281132e-05) - actor/grad_norm:np.float64(0.8533324301242828) - perf/mfu/actor:np.float64(0.3668456180355201) - perf/max_memory_allocated_gb:np.float64(46.2523193359375) - perf/max_memory_reserved_gb:np.float64(54.966796875) - perf/cpu_memory_used_gb:np.float64(468.53707122802734) - actor/lr:np.float64(1e-06) - training/global_step:18 - training/epoch:0 - critic/score/mean:-0.545703113079071 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.8885610103607178 - critic/rewards/max:0.8633642196655273 - critic/rewards/min:-1.6740626096725464 - critic/advantages/mean:-0.03012056089937687 - critic/advantages/max:3.6652400493621826 - critic/advantages/min:-1.8061152696609497 - critic/returns/mean:-0.03012056089937687 - critic/returns/max:3.6652400493621826 - critic/returns/min:-1.8061152696609497 - response_length/mean:977.29296875 - response_length/max:5457.0 - response_length/min:6.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:977.29296875 - response_length_non_aborted/max:5457.0 - response_length_non_aborted/min:6.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:327.5 - prompt_length/max:444.0 - prompt_length/min:258.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(7.74609375) - timing_s/start_profile:7.029599510133266e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(0.36803069105371833) - timing_s/agent_loop/generate_sequences/max:np.float64(67.56992375128902) - timing_s/agent_loop/generate_sequences/mean:np.float64(25.012949769384704) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(43.33870557695627) - timing_s/agent_loop/tool_calls/mean:np.float64(0.9410728508914872) - timing_s/agent_loop/slowest/generate_sequences:np.float64(31.265696820104495) - timing_s/agent_loop/slowest/tool_calls:np.float64(43.33870557695627) - timing_s/agent_loop/slowest/prompt_length:330 - timing_s/agent_loop/slowest/response_length:1395 - timing_s/gen:77.2652027590666 - timing_s/reward:0.00012616487219929695 - timing_s/old_log_prob:9.673118415987119 - timing_s/ref:55.641679952153936 - timing_s/adv:0.07455814396962523 - timing_s/update_actor:33.482849994907156 - timing_s/step:176.21923382091336 - timing_s/stop_profile:5.4336851462721825e-05 - timing_per_token_ms/gen:0.1544149031705616 - timing_per_token_ms/update_actor:0.05011997532371209 - timing_per_token_ms/adv:0.00011160496602014992 - timing_per_token_ms/ref:0.08328919511320033 - perf/total_num_tokens:668054 - perf/time_per_step:176.21923382091336 - perf/throughput:947.7597670736164
step:19 - global_seqlen/min:163954 - global_seqlen/max:192988 - global_seqlen/minmax_diff:29034 - global_seqlen/balanced_min:177985 - global_seqlen/balanced_max:179129 - global_seqlen/mean:178271.25 - actor/entropy:0.2214459925889969 - actor/reward_kl_penalty:0.5766251087188721 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.006120131657189632) - actor/pg_clipfrac:np.float64(0.0038339435588568447) - actor/ppo_kl:np.float64(-4.539182555163279e-06) - actor/pg_clipfrac_lower:np.float64(1.93106303413515e-05) - actor/grad_norm:np.float64(0.8767964094877243) - perf/mfu/actor:np.float64(0.3629533260575978) - perf/max_memory_allocated_gb:np.float64(46.2523193359375) - perf/max_memory_reserved_gb:np.float64(54.966796875) - perf/cpu_memory_used_gb:np.float64(467.87943267822266) - actor/lr:np.float64(1e-06) - training/global_step:19 - training/epoch:0 - critic/score/mean:-0.49785158038139343 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.8608970046043396 - critic/rewards/max:0.9058948755264282 - critic/rewards/min:-2.659477949142456 - critic/advantages/mean:-0.03202851489186287 - critic/advantages/max:3.6701645851135254 - critic/advantages/min:-3.4636971950531006 - critic/returns/mean:-0.03202851489186287 - critic/returns/max:3.6701645851135254 - critic/returns/min:-3.4636971950531006 - response_length/mean:1059.337890625 - response_length/max:6451.0 - response_length/min:5.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:1059.337890625 - response_length_non_aborted/max:6451.0 - response_length_non_aborted/min:5.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:333.40625 - prompt_length/max:486.0 - prompt_length/min:258.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(8.02734375) - timing_s/start_profile:6.398791447281837e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(0.4689980139955878) - timing_s/agent_loop/generate_sequences/max:np.float64(76.37389628170058) - timing_s/agent_loop/generate_sequences/mean:np.float64(28.67586623033276) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(30.107642567018047) - timing_s/agent_loop/tool_calls/mean:np.float64(0.8199874958495457) - timing_s/agent_loop/slowest/generate_sequences:np.float64(76.37389628170058) - timing_s/agent_loop/slowest/tool_calls:np.float64(4.1571671951096505) - timing_s/agent_loop/slowest/prompt_length:292 - timing_s/agent_loop/slowest/response_length:6451 - timing_s/gen:83.01139278896153 - timing_s/reward:0.00013215397484600544 - timing_s/old_log_prob:10.214220062131062 - timing_s/ref:59.25504103698768 - timing_s/adv:0.10168780107051134 - timing_s/update_actor:35.9876198458951 - timing_s/step:188.6340442658402 - timing_s/stop_profile:5.6380173191428185e-05 - timing_per_token_ms/gen:0.15304996448799188 - timing_per_token_ms/update_actor:0.05046750365790207 - timing_per_token_ms/adv:0.00014260263653072402 - timing_per_token_ms/ref:0.083096743076895 - perf/total_num_tokens:713085 - perf/time_per_step:188.6340442658402 - perf/throughput:945.0640296338236
test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 20}
validation generation end
len reward_extra_infos_dict['reward']: 960
len reward_extra_infos_dict['score']: 960
len reward_extra_infos_dict['acc']: 960
len reward_extra_infos_dict['pred']: 960
step:20 - global_seqlen/min:148571 - global_seqlen/max:179833 - global_seqlen/minmax_diff:31262 - global_seqlen/balanced_min:160274 - global_seqlen/balanced_max:162348 - global_seqlen/mean:161176.5 - actor/entropy:0.23613066971302032 - actor/reward_kl_penalty:0.6556122899055481 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.01330178088905728) - actor/pg_clipfrac:np.float64(0.004311547368107473) - actor/ppo_kl:np.float64(-3.326930004293411e-05) - actor/pg_clipfrac_lower:np.float64(7.227168680401519e-06) - actor/grad_norm:np.float64(1.034438356757164) - perf/mfu/actor:np.float64(0.37055634785315444) - perf/max_memory_allocated_gb:np.float64(46.29087543487549) - perf/max_memory_reserved_gb:np.float64(54.966796875) - perf/cpu_memory_used_gb:np.float64(468.1958312988281) - actor/lr:np.float64(1e-06) - val-aux/aime_2024/reward/mean@16:np.float64(-0.7052083369344473) - val-aux/aime_2024/reward/std@16:np.float64(0.16618931091343941) - val-aux/aime_2024/reward/best@2/mean:np.float64(-0.6340433431545894) - val-aux/aime_2024/reward/best@2/std:np.float64(0.16578866898208608) - val-aux/aime_2024/reward/worst@2/mean:np.float64(-0.7778966642538706) - val-aux/aime_2024/reward/worst@2/std:np.float64(0.10682744619837446) - val-aux/aime_2024/reward/maj@2/mean:np.float64(-0.7037633369843164) - val-aux/aime_2024/reward/maj@2/std:np.float64(0.16619220856958522) - val-aux/aime_2024/reward/best@4/mean:np.float64(-0.5600833477099735) - val-aux/aime_2024/reward/best@4/std:np.float64(0.15925840788349174) - val-aux/aime_2024/reward/worst@4/mean:np.float64(-0.8263166590134304) - val-aux/aime_2024/reward/worst@4/std:np.float64(0.06917563790883989) - val-aux/aime_2024/reward/maj@4/mean:np.float64(-0.7017333370188871) - val-aux/aime_2024/reward/maj@4/std:np.float64(0.1658861504959529) - val-aux/aime_2024/reward/best@8/mean:np.float64(-0.4886900167564551) - val-aux/aime_2024/reward/best@8/std:np.float64(0.14607030248435957) - val-aux/aime_2024/reward/worst@8/mean:np.float64(-0.8591366559962432) - val-aux/aime_2024/reward/worst@8/std:np.float64(0.04555113619050471) - val-aux/aime_2024/reward/maj@8/mean:np.float64(-0.6966400040705999) - val-aux/aime_2024/reward/maj@8/std:np.float64(0.16158178519176683) - val-aux/aime_2024/reward/best@16/mean:np.float64(-0.4215366842190425) - val-aux/aime_2024/reward/best@16/std:np.float64(0.11858925796628039) - val-aux/aime_2024/reward/worst@16/mean:np.float64(-0.8796433222631613) - val-aux/aime_2024/reward/worst@16/std:np.float64(0.02688164962746236) - val-aux/aime_2024/reward/maj@16/mean:np.float64(-0.6870933376610281) - val-aux/aime_2024/reward/maj@16/std:np.float64(0.15510036218943377) - val-aux/aime_2024/score/mean@16:np.float64(-0.7052083333333332) - val-aux/aime_2024/score/std@16:np.float64(0.16618932061506744) - val-aux/aime_2024/score/best@2/mean:np.float64(-0.6340433333333333) - val-aux/aime_2024/score/best@2/std:np.float64(0.16578867683468887) - val-aux/aime_2024/score/worst@2/mean:np.float64(-0.7778966666666666) - val-aux/aime_2024/score/worst@2/std:np.float64(0.10682745499428446) - val-aux/aime_2024/score/maj@2/mean:np.float64(-0.7037633333333331) - val-aux/aime_2024/score/maj@2/std:np.float64(0.16619221817501537) - val-aux/aime_2024/score/best@4/mean:np.float64(-0.5600833333333332) - val-aux/aime_2024/score/best@4/std:np.float64(0.15925841293381707) - val-aux/aime_2024/score/worst@4/mean:np.float64(-0.8263166666666667) - val-aux/aime_2024/score/worst@4/std:np.float64(0.06917564437155325) - val-aux/aime_2024/score/maj@4/mean:np.float64(-0.7017333333333334) - val-aux/aime_2024/score/maj@4/std:np.float64(0.165886159825013) - val-aux/aime_2024/score/best@8/mean:np.float64(-0.48868999999999985) - val-aux/aime_2024/score/best@8/std:np.float64(0.14607030502920873) - val-aux/aime_2024/score/worst@8/mean:np.float64(-0.8591366666666668) - val-aux/aime_2024/score/worst@8/std:np.float64(0.045551138456710695) - val-aux/aime_2024/score/maj@8/mean:np.float64(-0.6966399999999999) - val-aux/aime_2024/score/maj@8/std:np.float64(0.16158179410866572) - val-aux/aime_2024/score/best@16/mean:np.float64(-0.42153
step:21 - global_seqlen/min:157550 - global_seqlen/max:192109 - global_seqlen/minmax_diff:34559 - global_seqlen/balanced_min:171363 - global_seqlen/balanced_max:173102 - global_seqlen/mean:172527.75 - actor/entropy:0.21043996512889862 - actor/reward_kl_penalty:0.6155861020088196 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.008897267332940828) - actor/pg_clipfrac:np.float64(0.004103388241492212) - actor/ppo_kl:np.float64(-3.804213847615756e-05) - actor/pg_clipfrac_lower:np.float64(1.8128719966625793e-05) - actor/grad_norm:np.float64(0.8819833248853683) - perf/mfu/actor:np.float64(0.3665547127630965) - perf/max_memory_allocated_gb:np.float64(46.29087543487549) - perf/max_memory_reserved_gb:np.float64(54.966796875) - perf/cpu_memory_used_gb:np.float64(468.337459564209) - actor/lr:np.float64(1e-06) - training/global_step:21 - training/epoch:0 - critic/score/mean:-0.5384765863418579 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.88640958070755 - critic/rewards/max:0.8705747723579407 - critic/rewards/min:-2.24040150642395 - critic/advantages/mean:-0.051530059427022934 - critic/advantages/max:3.7044873237609863 - critic/advantages/min:-3.0883700847625732 - critic/returns/mean:-0.051530059427022934 - critic/returns/max:3.7044873237609863 - critic/returns/min:-3.0883700847625732 - response_length/mean:1019.373046875 - response_length/max:8096.0 - response_length/min:7.0 - response_length/clip_ratio:0.00390625 - response_length_non_aborted/mean:1019.373046875 - response_length_non_aborted/max:8096.0 - response_length_non_aborted/min:7.0 - response_length_non_aborted/clip_ratio:0.00390625 - response/aborted_ratio:0.0 - prompt_length/mean:328.5 - prompt_length/max:514.0 - prompt_length/min:270.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(8.58203125) - timing_s/start_profile:7.615005597472191e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(0.37734065717086196) - timing_s/agent_loop/generate_sequences/max:np.float64(104.42030009883456) - timing_s/agent_loop/generate_sequences/mean:np.float64(25.754489846245633) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(50.70863472018391) - timing_s/agent_loop/tool_calls/mean:np.float64(1.210347191083656) - timing_s/agent_loop/slowest/generate_sequences:np.float64(82.12892633629963) - timing_s/agent_loop/slowest/tool_calls:np.float64(25.445799249922857) - timing_s/agent_loop/slowest/prompt_length:322 - timing_s/agent_loop/slowest/response_length:8096 - timing_s/gen:109.65159360319376 - timing_s/reward:0.0001317488495260477 - timing_s/old_log_prob:9.996033516945317 - timing_s/ref:57.208353233058006 - timing_s/adv:0.07399038202129304 - timing_s/update_actor:34.86189572280273 - timing_s/step:211.85742874396965 - timing_s/stop_profile:4.3838052079081535e-05 - timing_per_token_ms/gen:0.21009312480134612 - timing_per_token_ms/update_actor:0.050516360009915405 - timing_per_token_ms/adv:0.0001072151900510107 - timing_per_token_ms/ref:0.08289732120348467 - perf/total_num_tokens:690111 - perf/time_per_step:211.85742874396965 - perf/throughput:814.3578019560518
step:22 - global_seqlen/min:154893 - global_seqlen/max:186046 - global_seqlen/minmax_diff:31153 - global_seqlen/balanced_min:169680 - global_seqlen/balanced_max:169681 - global_seqlen/mean:169680.5 - actor/entropy:0.20047184824943542 - actor/reward_kl_penalty:0.5866901278495789 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.0002135443216729982) - actor/pg_clipfrac:np.float64(0.0038169399136677384) - actor/ppo_kl:np.float64(-0.0001013982946460601) - actor/pg_clipfrac_lower:np.float64(2.1320569067029284e-05) - actor/grad_norm:np.float64(0.8937698751688004) - perf/mfu/actor:np.float64(0.3678800682877484) - perf/max_memory_allocated_gb:np.float64(46.29087543487549) - perf/max_memory_reserved_gb:np.float64(54.966796875) - perf/cpu_memory_used_gb:np.float64(468.59754943847656) - actor/lr:np.float64(1e-06) - training/global_step:22 - training/epoch:0 - critic/score/mean:-0.5249999761581421 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.8564969897270203 - critic/rewards/max:0.8852347731590271 - critic/rewards/min:-1.8300929069519043 - critic/advantages/mean:-0.004764929413795471 - critic/advantages/max:3.6756155490875244 - critic/advantages/min:-3.098703384399414 - critic/returns/mean:-0.004764929413795471 - critic/returns/max:3.6756155490875244 - critic/returns/min:-3.098703384399414 - response_length/mean:1001.25390625 - response_length/max:3285.0 - response_length/min:95.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:1001.25390625 - response_length_non_aborted/max:3285.0 - response_length_non_aborted/min:95.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:324.375 - prompt_length/max:421.0 - prompt_length/min:263.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(8.77734375) - timing_s/start_profile:6.1009079217910767e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(3.0611256218981) - timing_s/agent_loop/generate_sequences/max:np.float64(50.96880268584937) - timing_s/agent_loop/generate_sequences/mean:np.float64(25.819675013728556) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(60.61166464397684) - timing_s/agent_loop/tool_calls/mean:np.float64(2.288861153693688) - timing_s/agent_loop/slowest/generate_sequences:np.float64(13.390781726455316) - timing_s/agent_loop/slowest/tool_calls:np.float64(60.61166464397684) - timing_s/agent_loop/slowest/prompt_length:291 - timing_s/agent_loop/slowest/response_length:1284 - timing_s/gen:76.51560514396988 - timing_s/reward:0.00016246293671429157 - timing_s/old_log_prob:9.675791627028957 - timing_s/ref:56.5400904151611 - timing_s/adv:0.11742281401529908 - timing_s/update_actor:33.806773846037686 - timing_s/step:176.7225622709375 - timing_s/stop_profile:5.3516123443841934e-05 - timing_per_token_ms/gen:0.1492573865269913 - timing_per_token_ms/update_actor:0.049809456369526384 - timing_per_token_ms/adv:0.00017300575790279242 - timing_per_token_ms/ref:0.08330375384201646 - perf/total_num_tokens:678722 - perf/time_per_step:176.7225622709375 - perf/throughput:960.1518777203946
step:23 - global_seqlen/min:159188 - global_seqlen/max:181230 - global_seqlen/minmax_diff:22042 - global_seqlen/balanced_min:170113 - global_seqlen/balanced_max:170113 - global_seqlen/mean:170113.0 - actor/entropy:0.2083636075258255 - actor/reward_kl_penalty:0.5860023498535156 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.009003778714395594) - actor/pg_clipfrac:np.float64(0.003872578148730099) - actor/ppo_kl:np.float64(3.942398516301182e-05) - actor/pg_clipfrac_lower:np.float64(1.1898721822944935e-05) - actor/grad_norm:np.float64(0.9061146825551987) - perf/mfu/actor:np.float64(0.3685280863104283) - perf/max_memory_allocated_gb:np.float64(46.29087543487549) - perf/max_memory_reserved_gb:np.float64(54.966796875) - perf/cpu_memory_used_gb:np.float64(468.4373550415039) - actor/lr:np.float64(1e-06) - training/global_step:23 - training/epoch:0 - critic/score/mean:-0.506054699420929 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.8491858243942261 - critic/rewards/max:0.8936835527420044 - critic/rewards/min:-1.6710915565490723 - critic/advantages/mean:-0.042241815477609634 - critic/advantages/max:3.610966920852661 - critic/advantages/min:-2.4243996143341064 - critic/returns/mean:-0.042241815477609634 - critic/returns/max:3.610966920852661 - critic/returns/min:-2.4243996143341064 - response_length/mean:970.7890625 - response_length/max:4022.0 - response_length/min:13.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:970.7890625 - response_length_non_aborted/max:4022.0 - response_length_non_aborted/min:13.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:358.21875 - prompt_length/max:473.0 - prompt_length/min:277.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(7.86328125) - timing_s/start_profile:8.550193160772324e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(0.44184034899808466) - timing_s/agent_loop/generate_sequences/max:np.float64(57.98067184095271) - timing_s/agent_loop/generate_sequences/mean:np.float64(26.0877370903263) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(30.30774683295749) - timing_s/agent_loop/tool_calls/mean:np.float64(0.6287898417131146) - timing_s/agent_loop/slowest/generate_sequences:np.float64(29.209150925744325) - timing_s/agent_loop/slowest/tool_calls:np.float64(30.30774683295749) - timing_s/agent_loop/slowest/prompt_length:290 - timing_s/agent_loop/slowest/response_length:987 - timing_s/gen:61.97226211987436 - timing_s/reward:0.00013114511966705322 - timing_s/old_log_prob:9.762158129131421 - timing_s/ref:56.598568393150344 - timing_s/adv:0.08177008386701345 - timing_s/update_actor:33.84345535002649 - timing_s/step:162.32257565297186 - timing_s/stop_profile:5.4513104259967804e-05 - timing_per_token_ms/gen:0.12468164210789057 - timing_per_token_ms/update_actor:0.049736726984455165 - timing_per_token_ms/adv:0.00012017024546479906 - timing_per_token_ms/ref:0.08317789997406187 - perf/total_num_tokens:680452 - perf/time_per_step:162.32257565297186 - perf/throughput:1047.9934742021542
step:24 - global_seqlen/min:158860 - global_seqlen/max:184462 - global_seqlen/minmax_diff:25602 - global_seqlen/balanced_min:176067 - global_seqlen/balanced_max:178704 - global_seqlen/mean:176726.25 - actor/entropy:0.2123868465423584 - actor/reward_kl_penalty:0.6111935377120972 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.0019806216639153716) - actor/pg_clipfrac:np.float64(0.0038609772687777876) - actor/ppo_kl:np.float64(8.262987503258046e-05) - actor/pg_clipfrac_lower:np.float64(1.5961711142153945e-05) - actor/grad_norm:np.float64(0.8741264343261719) - perf/mfu/actor:np.float64(0.36017641779307963) - perf/max_memory_allocated_gb:np.float64(46.29087543487549) - perf/max_memory_reserved_gb:np.float64(54.966796875) - perf/cpu_memory_used_gb:np.float64(468.60280990600586) - actor/lr:np.float64(1e-06) - training/global_step:24 - training/epoch:0 - critic/score/mean:-0.5546875596046448 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.9074180126190186 - critic/rewards/max:0.8924395442008972 - critic/rewards/min:-1.9327654838562012 - critic/advantages/mean:-0.01146525889635086 - critic/advantages/max:3.6792595386505127 - critic/advantages/min:-2.306582450866699 - critic/returns/mean:-0.01146525889635086 - critic/returns/max:3.6792595386505127 - critic/returns/min:-2.306582450866699 - response_length/mean:1063.298828125 - response_length/max:8096.0 - response_length/min:190.0 - response_length/clip_ratio:0.001953125 - response_length_non_aborted/mean:1063.298828125 - response_length_non_aborted/max:8096.0 - response_length_non_aborted/min:190.0 - response_length_non_aborted/clip_ratio:0.001953125 - response/aborted_ratio:0.0 - prompt_length/mean:317.375 - prompt_length/max:440.0 - prompt_length/min:269.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(9.1796875) - timing_s/start_profile:6.74789771437645e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(5.307133028982207) - timing_s/agent_loop/generate_sequences/max:np.float64(100.35105912806466) - timing_s/agent_loop/generate_sequences/mean:np.float64(28.386905275216577) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(31.551327834138647) - timing_s/agent_loop/tool_calls/mean:np.float64(1.0875042329598728) - timing_s/agent_loop/slowest/generate_sequences:np.float64(100.35105912806466) - timing_s/agent_loop/slowest/tool_calls:np.float64(0.10776657704263926) - timing_s/agent_loop/slowest/prompt_length:413 - timing_s/agent_loop/slowest/response_length:8096 - timing_s/gen:102.87453540205024 - timing_s/reward:0.00012011406943202019 - timing_s/old_log_prob:10.093015455175191 - timing_s/ref:58.85869137197733 - timing_s/adv:0.0736725009046495 - timing_s/update_actor:35.977802036795765 - timing_s/step:207.9476333342027 - timing_s/stop_profile:5.036778748035431e-05 - timing_per_token_ms/gen:0.18896553033114855 - timing_per_token_ms/update_actor:0.050894819016410645 - timing_per_token_ms/adv:0.00010421838988923476 - timing_per_token_ms/ref:0.0832625195351247 - perf/total_num_tokens:706905 - perf/time_per_step:207.9476333342027 - perf/throughput:849.8593956872531
step:25 - global_seqlen/min:150567 - global_seqlen/max:186628 - global_seqlen/minmax_diff:36061 - global_seqlen/balanced_min:167493 - global_seqlen/balanced_max:168629 - global_seqlen/mean:168061.25 - actor/entropy:0.22701886296272278 - actor/reward_kl_penalty:0.6564977169036865 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.00413036658674173) - actor/pg_clipfrac:np.float64(0.004293711623176932) - actor/ppo_kl:np.float64(4.9765139920054935e-06) - actor/pg_clipfrac_lower:np.float64(1.4764954903512261e-05) - actor/grad_norm:np.float64(1.0100417584180832) - perf/mfu/actor:np.float64(0.36838925135782236) - perf/max_memory_allocated_gb:np.float64(46.29087543487549) - perf/max_memory_reserved_gb:np.float64(54.966796875) - perf/cpu_memory_used_gb:np.float64(468.5694694519043) - actor/lr:np.float64(1e-06) - training/global_step:25 - training/epoch:0 - critic/score/mean:-0.44746097922325134 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.7917470335960388 - critic/rewards/max:0.9230096340179443 - critic/rewards/min:-3.4293739795684814 - critic/advantages/mean:-0.03353653848171234 - critic/advantages/max:3.657703399658203 - critic/advantages/min:-2.503448486328125 - critic/returns/mean:-0.03353653848171234 - critic/returns/max:3.657703399658203 - critic/returns/min:-2.503448486328125 - response_length/mean:962.697265625 - response_length/max:5195.0 - response_length/min:15.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:962.697265625 - response_length_non_aborted/max:5195.0 - response_length_non_aborted/min:15.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:350.28125 - prompt_length/max:564.0 - prompt_length/min:272.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(8.72265625) - timing_s/start_profile:7.709721103310585e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(0.6010609020013362) - timing_s/agent_loop/generate_sequences/max:np.float64(64.1473407316953) - timing_s/agent_loop/generate_sequences/mean:np.float64(21.236743758423017) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(75.89711096091196) - timing_s/agent_loop/tool_calls/mean:np.float64(5.487556447140378) - timing_s/agent_loop/slowest/generate_sequences:np.float64(35.562618421856314) - timing_s/agent_loop/slowest/tool_calls:np.float64(68.84419673704542) - timing_s/agent_loop/slowest/prompt_length:272 - timing_s/agent_loop/slowest/response_length:2037 - timing_s/gen:106.8960987678729 - timing_s/reward:0.00013070995919406414 - timing_s/old_log_prob:9.671810335945338 - timing_s/ref:55.93125191680156 - timing_s/adv:0.10386694688349962 - timing_s/update_actor:33.465845461934805 - timing_s/step:206.1314724299591 - timing_s/stop_profile:5.067698657512665e-05 - timing_per_token_ms/gen:0.21687133677528125 - timing_per_token_ms/update_actor:0.04978221550466691 - timing_per_token_ms/adv:0.0001545075781649542 - timing_per_token_ms/ref:0.08320069605099563 - perf/total_num_tokens:672245 - perf/time_per_step:206.1314724299591 - perf/throughput:815.3109664372339
step:26 - global_seqlen/min:167414 - global_seqlen/max:188123 - global_seqlen/minmax_diff:20709 - global_seqlen/balanced_min:173844 - global_seqlen/balanced_max:173970 - global_seqlen/mean:173938.5 - actor/entropy:0.2045174241065979 - actor/reward_kl_penalty:0.6349209547042847 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.001296548939853892) - actor/pg_clipfrac:np.float64(0.003943603462539613) - actor/ppo_kl:np.float64(8.09611301519908e-06) - actor/pg_clipfrac_lower:np.float64(1.1765903946070466e-05) - actor/grad_norm:np.float64(0.9340969026088715) - perf/mfu/actor:np.float64(0.36525768184564533) - perf/max_memory_allocated_gb:np.float64(46.29087543487549) - perf/max_memory_reserved_gb:np.float64(54.966796875) - perf/cpu_memory_used_gb:np.float64(468.7746238708496) - actor/lr:np.float64(1e-06) - training/global_step:26 - training/epoch:0 - critic/score/mean:-0.47968751192092896 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.8275725841522217 - critic/rewards/max:0.8815485239028931 - critic/rewards/min:-2.449972152709961 - critic/advantages/mean:-0.009274156764149666 - critic/advantages/max:3.6845343112945557 - critic/advantages/min:-3.5885677337646484 - critic/returns/mean:-0.009274156764149666 - critic/returns/max:3.6845343112945557 - critic/returns/min:-3.5885677337646484 - response_length/mean:1024.73828125 - response_length/max:4380.0 - response_length/min:8.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:1024.73828125 - response_length_non_aborted/max:4380.0 - response_length_non_aborted/min:8.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:334.15625 - prompt_length/max:455.0 - prompt_length/min:258.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(9.1796875) - timing_s/start_profile:0.00019837799482047558 - timing_s/agent_loop/generate_sequences/min:np.float64(0.535195941105485) - timing_s/agent_loop/generate_sequences/max:np.float64(62.160061116097495) - timing_s/agent_loop/generate_sequences/mean:np.float64(27.32137640532619) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(31.085727524012327) - timing_s/agent_loop/tool_calls/mean:np.float64(0.8202002716743664) - timing_s/agent_loop/slowest/generate_sequences:np.float64(62.160061116097495) - timing_s/agent_loop/slowest/tool_calls:np.float64(0.427830338710919) - timing_s/agent_loop/slowest/prompt_length:320 - timing_s/agent_loop/slowest/response_length:4274 - timing_s/gen:65.16942180600017 - timing_s/reward:0.0001177529338747263 - timing_s/old_log_prob:10.007966028060764 - timing_s/ref:57.82092664204538 - timing_s/adv:0.0746195400133729 - timing_s/update_actor:34.8808762030676 - timing_s/step:168.0476631789934 - timing_s/stop_profile:5.2167102694511414e-05 - timing_per_token_ms/gen:0.12421125402827737 - timing_per_token_ms/update_actor:0.05013392118919561 - timing_per_token_ms/adv:0.00010724989006656505 - timing_per_token_ms/ref:0.08310541749245477 - perf/total_num_tokens:695754 - perf/time_per_step:168.0476631789934 - perf/throughput:1035.0545595789217
step:27 - global_seqlen/min:166101 - global_seqlen/max:185787 - global_seqlen/minmax_diff:19686 - global_seqlen/balanced_min:173714 - global_seqlen/balanced_max:173715 - global_seqlen/mean:173714.5 - actor/entropy:0.21000653505325317 - actor/reward_kl_penalty:0.6092561483383179 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.0017605602398361952) - actor/pg_clipfrac:np.float64(0.003994440450333059) - actor/ppo_kl:np.float64(1.1094358160335106e-05) - actor/pg_clipfrac_lower:np.float64(9.234659955836833e-06) - actor/grad_norm:np.float64(0.9060065746307373) - perf/mfu/actor:np.float64(0.36480111107634383) - perf/max_memory_allocated_gb:np.float64(46.29087543487549) - perf/max_memory_reserved_gb:np.float64(54.966796875) - perf/cpu_memory_used_gb:np.float64(468.8975028991699) - actor/lr:np.float64(1e-06) - training/global_step:27 - training/epoch:0 - critic/score/mean:-0.4720703065395355 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.8023709654808044 - critic/rewards/max:0.9308350086212158 - critic/rewards/min:-1.949242115020752 - critic/advantages/mean:-0.008900717832148075 - critic/advantages/max:3.622689723968506 - critic/advantages/min:-2.91855525970459 - critic/returns/mean:-0.008900717832148075 - critic/returns/max:3.622689723968506 - critic/returns/min:-2.91855525970459 - response_length/mean:1040.58203125 - response_length/max:3818.0 - response_length/min:9.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:1040.58203125 - response_length_non_aborted/max:3818.0 - response_length_non_aborted/min:9.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:316.5625 - prompt_length/max:441.0 - prompt_length/min:267.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(9.12890625) - timing_s/start_profile:6.943289190530777e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(0.676475872984156) - timing_s/agent_loop/generate_sequences/max:np.float64(54.58490786701441) - timing_s/agent_loop/generate_sequences/mean:np.float64(27.301475348619533) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(43.60964113869704) - timing_s/agent_loop/tool_calls/mean:np.float64(1.044407285856778) - timing_s/agent_loop/slowest/generate_sequences:np.float64(44.347669325070456) - timing_s/agent_loop/slowest/tool_calls:np.float64(31.680559723172337) - timing_s/agent_loop/slowest/prompt_length:339 - timing_s/agent_loop/slowest/response_length:2415 - timing_s/gen:78.70585137908347 - timing_s/reward:0.0002649039961397648 - timing_s/old_log_prob:9.926357035990804 - timing_s/ref:57.79695418593474 - timing_s/adv:0.10597378015518188 - timing_s/update_actor:35.06735386978835 - timing_s/step:181.66665174090303 - timing_s/stop_profile:5.201902240514755e-05 - timing_per_token_ms/gen:0.14772729237897111 - timing_per_token_ms/update_actor:0.050466935503064435 - timing_per_token_ms/adv:0.00015251141982272908 - timing_per_token_ms/ref:0.08317807981765302 - perf/total_num_tokens:694858 - perf/time_per_step:181.66665174090303 - perf/throughput:956.226684068331
step:28 - global_seqlen/min:160391 - global_seqlen/max:184198 - global_seqlen/minmax_diff:23807 - global_seqlen/balanced_min:168694 - global_seqlen/balanced_max:168695 - global_seqlen/mean:168694.5 - actor/entropy:0.20647907257080078 - actor/reward_kl_penalty:0.6477965712547302 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.0036236856743926183) - actor/pg_clipfrac:np.float64(0.003910942049697041) - actor/ppo_kl:np.float64(-7.925298068585107e-05) - actor/pg_clipfrac_lower:np.float64(9.707449316920247e-06) - actor/grad_norm:np.float64(0.9292253851890564) - perf/mfu/actor:np.float64(0.36836085056317264) - perf/max_memory_allocated_gb:np.float64(46.29087543487549) - perf/max_memory_reserved_gb:np.float64(54.966796875) - perf/cpu_memory_used_gb:np.float64(468.8874816894531) - actor/lr:np.float64(1e-06) - training/global_step:28 - training/epoch:0 - critic/score/mean:-0.42597657442092896 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.7682853937149048 - critic/rewards/max:0.8868992328643799 - critic/rewards/min:-1.7363907098770142 - critic/advantages/mean:-0.022108646109700203 - critic/advantages/max:3.671621561050415 - critic/advantages/min:-2.9899120330810547 - critic/returns/mean:-0.022108646109700203 - critic/returns/max:3.671621561050415 - critic/returns/min:-2.9899120330810547 - response_length/mean:1003.61328125 - response_length/max:3870.0 - response_length/min:6.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:1003.61328125 - response_length_non_aborted/max:3870.0 - response_length_non_aborted/min:6.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:314.3125 - prompt_length/max:474.0 - prompt_length/min:260.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(9.5390625) - timing_s/start_profile:7.177796214818954e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(0.5147766140289605) - timing_s/agent_loop/generate_sequences/max:np.float64(52.86985450889915) - timing_s/agent_loop/generate_sequences/mean:np.float64(26.73338513997669) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(32.55476877093315) - timing_s/agent_loop/tool_calls/mean:np.float64(0.758748388002914) - timing_s/agent_loop/slowest/generate_sequences:np.float64(52.86985450889915) - timing_s/agent_loop/slowest/tool_calls:np.float64(6.765824070433155) - timing_s/agent_loop/slowest/prompt_length:390 - timing_s/agent_loop/slowest/response_length:3870 - timing_s/gen:62.07767133391462 - timing_s/reward:0.000167901162058115 - timing_s/old_log_prob:9.68006661394611 - timing_s/ref:56.09626315697096 - timing_s/adv:0.10267523699440062 - timing_s/update_actor:33.67094823392108 - timing_s/step:161.6954798148945 - timing_s/stop_profile:4.970491863787174e-05 - timing_per_token_ms/gen:0.12080893516379221 - timing_per_token_ms/update_actor:0.049899297597018694 - timing_per_token_ms/adv:0.00015216150644271244 - timing_per_token_ms/ref:0.0831329165399153 - perf/total_num_tokens:674778 - perf/time_per_step:161.6954798148945 - perf/throughput:1043.285193829276
step:29 - global_seqlen/min:160584 - global_seqlen/max:185396 - global_seqlen/minmax_diff:24812 - global_seqlen/balanced_min:173447 - global_seqlen/balanced_max:173448 - global_seqlen/mean:173447.5 - actor/entropy:0.20572903752326965 - actor/reward_kl_penalty:0.6123425364494324 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(-0.0073993348363728725) - actor/pg_clipfrac:np.float64(0.004375856602564454) - actor/ppo_kl:np.float64(-4.495057928579627e-05) - actor/pg_clipfrac_lower:np.float64(9.353252607979812e-06) - actor/grad_norm:np.float64(0.9083421230316162) - perf/mfu/actor:np.float64(0.36456897482369643) - perf/max_memory_allocated_gb:np.float64(46.29087543487549) - perf/max_memory_reserved_gb:np.float64(54.966796875) - perf/cpu_memory_used_gb:np.float64(469.03014373779297) - actor/lr:np.float64(1e-06) - training/global_step:29 - training/epoch:0 - critic/score/mean:-0.423828125 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.7606934309005737 - critic/rewards/max:0.8524906635284424 - critic/rewards/min:-1.4467331171035767 - critic/advantages/mean:0.03718716278672218 - critic/advantages/max:3.5925872325897217 - critic/advantages/min:-2.548992156982422 - critic/returns/mean:0.03718716278672218 - critic/returns/max:3.5925872325897217 - critic/returns/min:-2.548992156982422 - response_length/mean:1030.46484375 - response_length/max:3756.0 - response_length/min:203.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:1030.46484375 - response_length_non_aborted/max:3756.0 - response_length_non_aborted/min:203.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:324.59375 - prompt_length/max:476.0 - prompt_length/min:264.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(8.8828125) - timing_s/start_profile:6.624986417591572e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(6.411533576902002) - timing_s/agent_loop/generate_sequences/max:np.float64(53.96885283384472) - timing_s/agent_loop/generate_sequences/mean:np.float64(27.031277930719625) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(60.51448712009005) - timing_s/agent_loop/tool_calls/mean:np.float64(1.4987307700098427) - timing_s/agent_loop/slowest/generate_sequences:np.float64(26.822082003811374) - timing_s/agent_loop/slowest/tool_calls:np.float64(60.323597204405814) - timing_s/agent_loop/slowest/prompt_length:320 - timing_s/agent_loop/slowest/response_length:1344 - timing_s/gen:89.62771665398031 - timing_s/reward:0.00022867601364850998 - timing_s/old_log_prob:9.941495201084763 - timing_s/ref:57.84537713509053 - timing_s/adv:0.10276069003157318 - timing_s/update_actor:34.88830250198953 - timing_s/step:192.46421318897046 - timing_s/stop_profile:5.4220203310251236e-05 - timing_per_token_ms/gen:0.16987880290293048 - timing_per_token_ms/update_actor:0.050286545643479334 - timing_per_token_ms/adv:0.00014811497719997862 - timing_per_token_ms/ref:0.08337591653827603 - perf/total_num_tokens:693790 - perf/time_per_step:192.46421318897046 - perf/throughput:901.1935108668802
test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 30}
validation generation end
len reward_extra_infos_dict['reward']: 960
len reward_extra_infos_dict['score']: 960
len reward_extra_infos_dict['acc']: 960
len reward_extra_infos_dict['pred']: 960
step:30 - global_seqlen/min:153151 - global_seqlen/max:210448 - global_seqlen/minmax_diff:57297 - global_seqlen/balanced_min:182119 - global_seqlen/balanced_max:184676 - global_seqlen/mean:182814.5 - actor/entropy:0.20256656408309937 - actor/reward_kl_penalty:0.6364485025405884 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.008765022833176771) - actor/pg_clipfrac:np.float64(0.0040426681283861395) - actor/ppo_kl:np.float64(-4.618417551682796e-05) - actor/pg_clipfrac_lower:np.float64(1.9861088549077977e-05) - actor/grad_norm:np.float64(0.9477469176054001) - perf/mfu/actor:np.float64(0.3650738650824245) - perf/max_memory_allocated_gb:np.float64(46.29087543487549) - perf/max_memory_reserved_gb:np.float64(54.966796875) - perf/cpu_memory_used_gb:np.float64(468.8888511657715) - actor/lr:np.float64(1e-06) - val-aux/aime_2024/reward/mean@16:np.float64(-0.6650000087916851) - val-aux/aime_2024/reward/std@16:np.float64(0.1301203325796691) - val-aux/aime_2024/reward/best@2/mean:np.float64(-0.6032400142788887) - val-aux/aime_2024/reward/best@2/std:np.float64(0.10769106124764473) - val-aux/aime_2024/reward/worst@2/mean:np.float64(-0.7258166699131331) - val-aux/aime_2024/reward/worst@2/std:np.float64(0.11267172450605377) - val-aux/aime_2024/reward/maj@2/mean:np.float64(-0.6647700087567169) - val-aux/aime_2024/reward/maj@2/std:np.float64(0.13083132688294144) - val-aux/aime_2024/reward/best@4/mean:np.float64(-0.5556366844177245) - val-aux/aime_2024/reward/best@4/std:np.float64(0.07628746892640657) - val-aux/aime_2024/reward/worst@4/mean:np.float64(-0.7801699977974097) - val-aux/aime_2024/reward/worst@4/std:np.float64(0.08202238268641482) - val-aux/aime_2024/reward/maj@4/mean:np.float64(-0.6526566754579545) - val-aux/aime_2024/reward/maj@4/std:np.float64(0.12677857646302854) - val-aux/aime_2024/reward/best@8/mean:np.float64(-0.5238000198642413) - val-aux/aime_2024/reward/best@8/std:np.float64(0.04659773736797066) - val-aux/aime_2024/reward/worst@8/mean:np.float64(-0.8186399930814902) - val-aux/aime_2024/reward/worst@8/std:np.float64(0.05496227003035378) - val-aux/aime_2024/reward/maj@8/mean:np.float64(-0.6412100091497102) - val-aux/aime_2024/reward/maj@8/std:np.float64(0.1191778032262644) - val-aux/aime_2024/reward/best@16/mean:np.float64(-0.5050333540240923) - val-aux/aime_2024/reward/best@16/std:np.float64(0.02419381314133175) - val-aux/aime_2024/reward/worst@16/mean:np.float64(-0.8436133231679599) - val-aux/aime_2024/reward/worst@16/std:np.float64(0.03119147117775123) - val-aux/aime_2024/reward/maj@16/mean:np.float64(-0.6306866763035456) - val-aux/aime_2024/reward/maj@16/std:np.float64(0.1055535717995601) - val-aux/aime_2024/score/mean@16:np.float64(-0.6649999999999999) - val-aux/aime_2024/score/std@16:np.float64(0.1301203429707946) - val-aux/aime_2024/score/best@2/mean:np.float64(-0.6032399999999999) - val-aux/aime_2024/score/best@2/std:np.float64(0.10769106862706117) - val-aux/aime_2024/score/worst@2/mean:np.float64(-0.7258166666666666) - val-aux/aime_2024/score/worst@2/std:np.float64(0.1126717345541178) - val-aux/aime_2024/score/maj@2/mean:np.float64(-0.6647700000000001) - val-aux/aime_2024/score/maj@2/std:np.float64(0.1308313373430357) - val-aux/aime_2024/score/best@4/mean:np.float64(-0.5556366666666666) - val-aux/aime_2024/score/best@4/std:np.float64(0.07628747375182554) - val-aux/aime_2024/score/worst@4/mean:np.float64(-0.7801699999999999) - val-aux/aime_2024/score/worst@4/std:np.float64(0.08202239185146713) - val-aux/aime_2024/score/maj@4/mean:np.float64(-0.6526566666666667) - val-aux/aime_2024/score/maj@4/std:np.float64(0.12677858639992914) - val-aux/aime_2024/score/best@8/mean:np.float64(-0.5237999999999998) - val-aux/aime_2024/score/best@8/std:np.float64(0.04659774008497868) - val-aux/aime_2024/score/worst@8/mean:np.float64(-0.8186400000000001) - val-aux/aime_2024/score/worst@8/std:np.float64(0.054962277200915385) - val-aux/aime_2024/score/maj@8/mean:np.float64(-0.64121) - val-aux/aime_2024/score/maj@8/std:np.float64(0.11917781275717876) - val-aux/aime_2024/score/best@16/mean:np.float64(-0.5050333333333331)
step:31 - global_seqlen/min:173204 - global_seqlen/max:191500 - global_seqlen/minmax_diff:18296 - global_seqlen/balanced_min:183977 - global_seqlen/balanced_max:183977 - global_seqlen/mean:183977.0 - actor/entropy:0.19558386504650116 - actor/reward_kl_penalty:0.6334300637245178 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(-0.005463565338868648) - actor/pg_clipfrac:np.float64(0.004042265866883099) - actor/ppo_kl:np.float64(-8.314270762639353e-05) - actor/pg_clipfrac_lower:np.float64(1.5040508515085094e-05) - actor/grad_norm:np.float64(0.854425698518753) - perf/mfu/actor:np.float64(0.36727979523559673) - perf/max_memory_allocated_gb:np.float64(46.29087543487549) - perf/max_memory_reserved_gb:np.float64(54.966796875) - perf/cpu_memory_used_gb:np.float64(468.87588119506836) - actor/lr:np.float64(1e-06) - training/global_step:31 - training/epoch:0 - critic/score/mean:-0.591992199420929 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.9318850040435791 - critic/rewards/max:0.8197537660598755 - critic/rewards/min:-1.4614245891571045 - critic/advantages/mean:0.02602783776819706 - critic/advantages/max:3.669027805328369 - critic/advantages/min:-2.7994606494903564 - critic/returns/mean:0.02602783776819706 - critic/returns/max:3.669027805328369 - critic/returns/min:-2.7994606494903564 - response_length/mean:1112.6640625 - response_length/max:4886.0 - response_length/min:260.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:1112.6640625 - response_length_non_aborted/max:4886.0 - response_length_non_aborted/min:260.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:324.65625 - prompt_length/max:712.0 - prompt_length/min:256.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(9.859375) - timing_s/start_profile:9.131617844104767e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(8.185215938836336) - timing_s/agent_loop/generate_sequences/max:np.float64(64.16930117504671) - timing_s/agent_loop/generate_sequences/mean:np.float64(29.79644044507495) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(31.591262513305992) - timing_s/agent_loop/tool_calls/mean:np.float64(1.2690272931204163) - timing_s/agent_loop/slowest/generate_sequences:np.float64(64.16930117504671) - timing_s/agent_loop/slowest/tool_calls:np.float64(0.6844016290269792) - timing_s/agent_loop/slowest/prompt_length:342 - timing_s/agent_loop/slowest/response_length:4886 - timing_s/gen:66.82303851493634 - timing_s/reward:0.0001361309550702572 - timing_s/old_log_prob:10.525646438123658 - timing_s/ref:60.96058484609239 - timing_s/adv:0.07754289801232517 - timing_s/update_actor:36.759514576988295 - timing_s/step:175.24806827190332 - timing_s/stop_profile:5.149585194885731e-05 - timing_per_token_ms/gen:0.1172984295064217 - timing_per_token_ms/update_actor:0.04995123653634462 - timing_per_token_ms/adv:0.00010537036968252168 - timing_per_token_ms/ref:0.08283723623889452 - perf/total_num_tokens:735908 - perf/time_per_step:175.24806827190332 - perf/throughput:1049.8090039688966
step:32 - global_seqlen/min:152747 - global_seqlen/max:180672 - global_seqlen/minmax_diff:27925 - global_seqlen/balanced_min:167025 - global_seqlen/balanced_max:170890 - global_seqlen/mean:168957.5 - actor/entropy:0.1924540251493454 - actor/reward_kl_penalty:0.7034279704093933 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.0004969369353602815) - actor/pg_clipfrac:np.float64(0.0042547429213300346) - actor/ppo_kl:np.float64(-0.00013587322791863699) - actor/pg_clipfrac_lower:np.float64(1.014130684779957e-05) - actor/grad_norm:np.float64(0.9701352119445801) - perf/mfu/actor:np.float64(0.3689212768285535) - perf/max_memory_allocated_gb:np.float64(46.29087543487549) - perf/max_memory_reserved_gb:np.float64(54.966796875) - perf/cpu_memory_used_gb:np.float64(468.763614654541) - actor/lr:np.float64(1e-06) - training/global_step:32 - training/epoch:0 - critic/score/mean:-0.5494140386581421 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.8855586647987366 - critic/rewards/max:0.874337375164032 - critic/rewards/min:-1.7298964262008667 - critic/advantages/mean:-0.012092586606740952 - critic/advantages/max:3.6036739349365234 - critic/advantages/min:-2.7200539112091064 - critic/returns/mean:-0.012092586606740952 - critic/returns/max:3.6036739349365234 - critic/returns/min:-2.7200539112091064 - response_length/mean:978.32421875 - response_length/max:8096.0 - response_length/min:141.0 - response_length/clip_ratio:0.00390625 - response_length_non_aborted/mean:978.32421875 - response_length_non_aborted/max:8096.0 - response_length_non_aborted/min:141.0 - response_length_non_aborted/clip_ratio:0.00390625 - response/aborted_ratio:0.0 - prompt_length/mean:341.65625 - prompt_length/max:670.0 - prompt_length/min:269.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(9.8046875) - timing_s/start_profile:6.362190470099449e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(4.540091646136716) - timing_s/agent_loop/generate_sequences/max:np.float64(98.1372140229214) - timing_s/agent_loop/generate_sequences/mean:np.float64(20.4078934685067) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(90.26073205284774) - timing_s/agent_loop/tool_calls/mean:np.float64(6.7943986868690445) - timing_s/agent_loop/slowest/generate_sequences:np.float64(11.367332375608385) - timing_s/agent_loop/slowest/tool_calls:np.float64(90.25775826419704) - timing_s/agent_loop/slowest/prompt_length:375 - timing_s/agent_loop/slowest/response_length:770 - timing_s/gen:104.12236881512217 - timing_s/reward:0.00012869108468294144 - timing_s/old_log_prob:9.660042697098106 - timing_s/ref:56.058559474069625 - timing_s/adv:0.09381385706365108 - timing_s/update_actor:33.819215076975524 - timing_s/step:203.82613281114027 - timing_s/stop_profile:5.662580952048302e-05 - timing_per_token_ms/gen:0.20786974061816918 - timing_per_token_ms/update_actor:0.05004100894748017 - timing_per_token_ms/adv:0.00013881280360985912 - timing_per_token_ms/ref:0.08294772276174427 - perf/total_num_tokens:675830 - perf/time_per_step:203.82613281114027 - perf/throughput:828.9295276801008
step:33 - global_seqlen/min:159641 - global_seqlen/max:190840 - global_seqlen/minmax_diff:31199 - global_seqlen/balanced_min:180304 - global_seqlen/balanced_max:180305 - global_seqlen/mean:180304.5 - actor/entropy:0.18126195669174194 - actor/reward_kl_penalty:0.6526405811309814 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(-0.00015028674497443716) - actor/pg_clipfrac:np.float64(0.003754663048312068) - actor/ppo_kl:np.float64(-2.5001987819450732e-05) - actor/pg_clipfrac_lower:np.float64(1.651029579079477e-05) - actor/grad_norm:np.float64(0.8875450938940048) - perf/mfu/actor:np.float64(0.3633674136010774) - perf/max_memory_allocated_gb:np.float64(46.29087543487549) - perf/max_memory_reserved_gb:np.float64(54.966796875) - perf/cpu_memory_used_gb:np.float64(468.99008560180664) - actor/lr:np.float64(1e-06) - training/global_step:33 - training/epoch:0 - critic/score/mean:-0.47734376788139343 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.8070876002311707 - critic/rewards/max:0.8844453692436218 - critic/rewards/min:-1.4910870790481567 - critic/advantages/mean:-0.00047800521133467555 - critic/advantages/max:3.5726072788238525 - critic/advantages/min:-2.445089340209961 - critic/returns/mean:-0.00047800521133467555 - critic/returns/max:3.5726072788238525 - critic/returns/min:-2.445089340209961 - response_length/mean:1074.87890625 - response_length/max:2621.0 - response_length/min:11.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:1074.87890625 - response_length_non_aborted/max:2621.0 - response_length_non_aborted/min:11.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:333.75 - prompt_length/max:558.0 - prompt_length/min:272.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(10.3984375) - timing_s/start_profile:7.394189015030861e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(0.5225755679421127) - timing_s/agent_loop/generate_sequences/max:np.float64(50.18168127373792) - timing_s/agent_loop/generate_sequences/mean:np.float64(29.96861836652306) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(60.28561040526256) - timing_s/agent_loop/tool_calls/mean:np.float64(1.1112268103747738) - timing_s/agent_loop/slowest/generate_sequences:np.float64(24.045757668092847) - timing_s/agent_loop/slowest/tool_calls:np.float64(60.28561040526256) - timing_s/agent_loop/slowest/prompt_length:332 - timing_s/agent_loop/slowest/response_length:977 - timing_s/gen:86.81003918219358 - timing_s/reward:0.00014021596871316433 - timing_s/old_log_prob:10.259665969992056 - timing_s/ref:59.775693288072944 - timing_s/adv:0.07527670986019075 - timing_s/update_actor:36.26771455211565 - timing_s/step:193.2628921410069 - timing_s/stop_profile:5.34330029040575e-05 - timing_per_token_ms/gen:0.1577394967859635 - timing_per_token_ms/update_actor:0.05028675733566779 - timing_per_token_ms/adv:0.00010437441919113326 - timing_per_token_ms/ref:0.08288158821337369 - perf/total_num_tokens:721218 - perf/time_per_step:193.2628921410069 - perf/throughput:932.9494038019865
step:34 - global_seqlen/min:156432 - global_seqlen/max:183623 - global_seqlen/minmax_diff:27191 - global_seqlen/balanced_min:169198 - global_seqlen/balanced_max:169198 - global_seqlen/mean:169198.0 - actor/entropy:0.19299398362636566 - actor/reward_kl_penalty:0.6488757729530334 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(-0.0030420242805121235) - actor/pg_clipfrac:np.float64(0.004067927249707282) - actor/ppo_kl:np.float64(-7.619271180914211e-06) - actor/pg_clipfrac_lower:np.float64(3.0266923749877607e-05) - actor/grad_norm:np.float64(0.9463747590780258) - perf/mfu/actor:np.float64(0.36718132736973946) - perf/max_memory_allocated_gb:np.float64(46.29087543487549) - perf/max_memory_reserved_gb:np.float64(54.966796875) - perf/cpu_memory_used_gb:np.float64(468.99161529541016) - actor/lr:np.float64(1e-06) - training/global_step:34 - training/epoch:0 - critic/score/mean:-0.451171875 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.7775614261627197 - critic/rewards/max:0.8808193206787109 - critic/rewards/min:-1.4751051664352417 - critic/advantages/mean:0.016548283398151398 - critic/advantages/max:3.6421046257019043 - critic/advantages/min:-2.7431771755218506 - critic/returns/mean:0.016548283398151398 - critic/returns/max:3.6421046257019043 - critic/returns/min:-2.7431771755218506 - response_length/mean:985.671875 - response_length/max:3410.0 - response_length/min:8.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:985.671875 - response_length_non_aborted/max:3410.0 - response_length_non_aborted/min:8.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:336.1875 - prompt_length/max:634.0 - prompt_length/min:262.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(9.64453125) - timing_s/start_profile:6.182794459164143e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(0.4537933459505439) - timing_s/agent_loop/generate_sequences/max:np.float64(51.014554385328665) - timing_s/agent_loop/generate_sequences/mean:np.float64(26.681450624659647) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(30.638770042918622) - timing_s/agent_loop/tool_calls/mean:np.float64(0.7952052443902176) - timing_s/agent_loop/slowest/generate_sequences:np.float64(31.266269902931526) - timing_s/agent_loop/slowest/tool_calls:np.float64(30.638770042918622) - timing_s/agent_loop/slowest/prompt_length:324 - timing_s/agent_loop/slowest/response_length:1052 - timing_s/gen:64.32334209093824 - timing_s/reward:0.0001317569985985756 - timing_s/old_log_prob:9.927838872885332 - timing_s/ref:56.370430832961574 - timing_s/adv:0.11133348592557013 - timing_s/update_actor:33.83121125004254 - timing_s/step:164.62550410092808 - timing_s/stop_profile:5.485001020133495e-05 - timing_per_token_ms/gen:0.12745775821326316 - timing_per_token_ms/update_actor:0.049987605128374066 - timing_per_token_ms/adv:0.00016450177591574683 - timing_per_token_ms/ref:0.0832906281885152 - perf/total_num_tokens:676792 - perf/time_per_step:164.62550410092808 - perf/throughput:1027.7751368115394
step:35 - global_seqlen/min:167178 - global_seqlen/max:186813 - global_seqlen/minmax_diff:19635 - global_seqlen/balanced_min:176755 - global_seqlen/balanced_max:176755 - global_seqlen/mean:176755.0 - actor/entropy:0.18451713025569916 - actor/reward_kl_penalty:0.656793475151062 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.0002619301565573551) - actor/pg_clipfrac:np.float64(0.004070239095017314) - actor/ppo_kl:np.float64(-3.793634218709485e-05) - actor/pg_clipfrac_lower:np.float64(2.676581880223239e-05) - actor/grad_norm:np.float64(0.92239710688591) - perf/mfu/actor:np.float64(0.3592235974127158) - perf/max_memory_allocated_gb:np.float64(46.29087543487549) - perf/max_memory_reserved_gb:np.float64(54.966796875) - perf/cpu_memory_used_gb:np.float64(469.0988655090332) - actor/lr:np.float64(1e-06) - training/global_step:35 - training/epoch:0 - critic/score/mean:-0.4624999761581421 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.7577336430549622 - critic/rewards/max:0.8671036958694458 - critic/rewards/min:-2.0114331245422363 - critic/advantages/mean:-0.003437272971495986 - critic/advantages/max:3.684981346130371 - critic/advantages/min:-3.0056753158569336 - critic/returns/mean:-0.003437272971495986 - critic/returns/max:3.684981346130371 - critic/returns/min:-3.0056753158569336 - response_length/mean:1053.2109375 - response_length/max:3821.0 - response_length/min:92.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:1053.2109375 - response_length_non_aborted/max:3821.0 - response_length_non_aborted/min:92.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:327.6875 - prompt_length/max:435.0 - prompt_length/min:274.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(10.21875) - timing_s/start_profile:0.00014665303751826286 - timing_s/agent_loop/generate_sequences/min:np.float64(2.6788496738299727) - timing_s/agent_loop/generate_sequences/max:np.float64(56.07524362788536) - timing_s/agent_loop/generate_sequences/mean:np.float64(27.600553045334436) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(30.501399663975462) - timing_s/agent_loop/tool_calls/mean:np.float64(0.9611326276458385) - timing_s/agent_loop/slowest/generate_sequences:np.float64(44.1046680577565) - timing_s/agent_loop/slowest/tool_calls:np.float64(30.495312702609226) - timing_s/agent_loop/slowest/prompt_length:435 - timing_s/agent_loop/slowest/response_length:1986 - timing_s/gen:77.05435206112452 - timing_s/reward:0.000130590982735157 - timing_s/old_log_prob:10.111151325982064 - timing_s/ref:58.9230270111002 - timing_s/adv:0.07864665309898555 - timing_s/update_actor:35.912284465972334 - timing_s/step:182.1497143150773 - timing_s/stop_profile:5.457596853375435e-05 - timing_per_token_ms/gen:0.14289329517087723 - timing_per_token_ms/update_actor:0.05079387353394859 - timing_per_token_ms/adv:0.00011123681522302842 - timing_per_token_ms/ref:0.0833399720108345 - perf/total_num_tokens:707020 - perf/time_per_step:182.1497143150773 - perf/throughput:970.383075617974
step:36 - global_seqlen/min:159533 - global_seqlen/max:182225 - global_seqlen/minmax_diff:22692 - global_seqlen/balanced_min:170288 - global_seqlen/balanced_max:170289 - global_seqlen/mean:170288.5 - actor/entropy:0.18274281919002533 - actor/reward_kl_penalty:0.6635608077049255 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(-0.004870596450200537) - actor/pg_clipfrac:np.float64(0.004113585664890706) - actor/ppo_kl:np.float64(5.873784903087653e-06) - actor/pg_clipfrac_lower:np.float64(2.7625041366263758e-05) - actor/grad_norm:np.float64(0.9266986697912216) - perf/mfu/actor:np.float64(0.369166821906775) - perf/max_memory_allocated_gb:np.float64(46.29087543487549) - perf/max_memory_reserved_gb:np.float64(54.966796875) - perf/cpu_memory_used_gb:np.float64(469.2890205383301) - actor/lr:np.float64(1e-06) - training/global_step:36 - training/epoch:0 - critic/score/mean:-0.3968749940395355 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.7137916088104248 - critic/rewards/max:0.8728644847869873 - critic/rewards/min:-1.5150017738342285 - critic/advantages/mean:0.024633081629872322 - critic/advantages/max:3.603721857070923 - critic/advantages/min:-2.9592125415802 - critic/returns/mean:0.024633081629872322 - critic/returns/max:3.603721857070923 - critic/returns/min:-2.9592125415802 - response_length/mean:1008.84765625 - response_length/max:3168.0 - response_length/min:173.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:1008.84765625 - response_length_non_aborted/max:3168.0 - response_length_non_aborted/min:173.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:321.53125 - prompt_length/max:434.0 - prompt_length/min:261.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(10.1171875) - timing_s/start_profile:6.214785389602184e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(5.312370104016736) - timing_s/agent_loop/generate_sequences/max:np.float64(48.54788884636946) - timing_s/agent_loop/generate_sequences/mean:np.float64(25.669834212615115) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(114.02249863906763) - timing_s/agent_loop/tool_calls/mean:np.float64(1.5685921081776542) - timing_s/agent_loop/slowest/generate_sequences:np.float64(10.050300245871767) - timing_s/agent_loop/slowest/tool_calls:np.float64(114.02249863906763) - timing_s/agent_loop/slowest/prompt_length:352 - timing_s/agent_loop/slowest/response_length:854 - timing_s/gen:126.58658568910323 - timing_s/reward:0.0001250840723514557 - timing_s/old_log_prob:9.811693852068856 - timing_s/ref:56.57955158315599 - timing_s/adv:0.08260841900482774 - timing_s/update_actor:33.89275100105442 - timing_s/step:227.03451990219764 - timing_s/stop_profile:5.442393012344837e-05 - timing_per_token_ms/gen:0.24507112014617394 - timing_per_token_ms/update_actor:0.049757838904351176 - timing_per_token_ms/adv:0.0001212771546593395 - timing_per_token_ms/ref:0.0830642579844734 - perf/total_num_tokens:681154 - perf/time_per_step:227.03451990219764 - perf/throughput:750.0555425375718
step:37 - global_seqlen/min:159370 - global_seqlen/max:209221 - global_seqlen/minmax_diff:49851 - global_seqlen/balanced_min:186926 - global_seqlen/balanced_max:188988 - global_seqlen/mean:187442.25 - actor/entropy:0.1799696832895279 - actor/reward_kl_penalty:0.6428233981132507 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(-0.008066685773519567) - actor/pg_clipfrac:np.float64(0.0038419947493821384) - actor/ppo_kl:np.float64(6.283369893935741e-05) - actor/pg_clipfrac_lower:np.float64(4.480568713916e-06) - actor/grad_norm:np.float64(0.8656797707080841) - perf/mfu/actor:np.float64(0.36834735754307707) - perf/max_memory_allocated_gb:np.float64(46.29087543487549) - perf/max_memory_reserved_gb:np.float64(54.966796875) - perf/cpu_memory_used_gb:np.float64(469.0816078186035) - actor/lr:np.float64(1e-06) - training/global_step:37 - training/epoch:0 - critic/score/mean:-0.4818359613418579 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.7860603332519531 - critic/rewards/max:0.8924626111984253 - critic/rewards/min:-1.493728518486023 - critic/advantages/mean:0.04042825102806091 - critic/advantages/max:3.5933046340942383 - critic/advantages/min:-2.676474094390869 - critic/returns/mean:0.04042825102806091 - critic/returns/max:3.5933046340942383 - critic/returns/min:-2.676474094390869 - response_length/mean:1134.861328125 - response_length/max:6578.0 - response_length/min:13.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:1134.861328125 - response_length_non_aborted/max:6578.0 - response_length_non_aborted/min:13.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:329.53125 - prompt_length/max:553.0 - prompt_length/min:272.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(10.77734375) - timing_s/start_profile:7.49519094824791e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(0.5677820320706815) - timing_s/agent_loop/generate_sequences/max:np.float64(76.36664261016995) - timing_s/agent_loop/generate_sequences/mean:np.float64(29.91202303368982) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(30.585314054973423) - timing_s/agent_loop/tool_calls/mean:np.float64(1.0144395810712012) - timing_s/agent_loop/slowest/generate_sequences:np.float64(48.73968350584619) - timing_s/agent_loop/slowest/tool_calls:np.float64(30.585314054973423) - timing_s/agent_loop/slowest/prompt_length:278 - timing_s/agent_loop/slowest/response_length:2592 - timing_s/gen:81.73463597521186 - timing_s/reward:0.0001267360057681799 - timing_s/old_log_prob:10.601471399888396 - timing_s/ref:62.24144838913344 - timing_s/adv:0.10602925904095173 - timing_s/update_actor:37.409164673881605 - timing_s/step:192.16126692295074 - timing_s/stop_profile:4.984298720955849e-05 - timing_per_token_ms/gen:0.1406673722443578 - timing_per_token_ms/update_actor:0.04989425366197003 - timing_per_token_ms/adv:0.0001414159014855932 - timing_per_token_ms/ref:0.08301416621537225 - perf/total_num_tokens:749769 - perf/time_per_step:192.16126692295074 - perf/throughput:975.4424135596333
step:38 - global_seqlen/min:162113 - global_seqlen/max:208624 - global_seqlen/minmax_diff:46511 - global_seqlen/balanced_min:191609 - global_seqlen/balanced_max:193212 - global_seqlen/mean:192009.75 - actor/entropy:0.1693573296070099 - actor/reward_kl_penalty:0.635783851146698 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(-0.0011999493724943022) - actor/pg_clipfrac:np.float64(0.003960764035582542) - actor/ppo_kl:np.float64(5.8477241873333695e-05) - actor/pg_clipfrac_lower:np.float64(1.5166022603807505e-05) - actor/grad_norm:np.float64(0.853549525141716) - perf/mfu/actor:np.float64(0.3718308690965893) - perf/max_memory_allocated_gb:np.float64(46.29087543487549) - perf/max_memory_reserved_gb:np.float64(54.966796875) - perf/cpu_memory_used_gb:np.float64(469.10015869140625) - actor/lr:np.float64(1e-06) - training/global_step:38 - training/epoch:0 - critic/score/mean:-0.5005859136581421 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.8045150637626648 - critic/rewards/max:0.8936794996261597 - critic/rewards/min:-1.5045912265777588 - critic/advantages/mean:0.006625140551477671 - critic/advantages/max:3.6106622219085693 - critic/advantages/min:-3.010227680206299 - critic/returns/mean:0.006625140551477671 - critic/returns/max:3.6106622219085693 - critic/returns/min:-3.010227680206299 - response_length/mean:1169.669921875 - response_length/max:6247.0 - response_length/min:75.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:1169.669921875 - response_length_non_aborted/max:6247.0 - response_length_non_aborted/min:75.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:330.40625 - prompt_length/max:391.0 - prompt_length/min:269.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(11.0) - timing_s/start_profile:9.680609218776226e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(2.451372404117137) - timing_s/agent_loop/generate_sequences/max:np.float64(75.73918383405544) - timing_s/agent_loop/generate_sequences/mean:np.float64(31.507130727155072) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(64.19512740895152) - timing_s/agent_loop/tool_calls/mean:np.float64(1.1829160737916027) - timing_s/agent_loop/slowest/generate_sequences:np.float64(21.271017608465627) - timing_s/agent_loop/slowest/tool_calls:np.float64(64.19512740895152) - timing_s/agent_loop/slowest/prompt_length:314 - timing_s/agent_loop/slowest/response_length:770 - timing_s/gen:87.93996656895615 - timing_s/reward:0.00012450898066163063 - timing_s/old_log_prob:10.745972011936828 - timing_s/ref:63.61284870700911 - timing_s/adv:0.10028208303265274 - timing_s/update_actor:37.962444222997874 - timing_s/step:200.42757436516695 - timing_s/stop_profile:5.152379162609577e-05 - timing_per_token_ms/gen:0.14684292037676921 - timing_per_token_ms/update_actor:0.0494277559121319 - timing_per_token_ms/adv:0.00013056899849181192 - timing_per_token_ms/ref:0.0828250241289949 - perf/total_num_tokens:768039 - perf/time_per_step:200.42757436516695 - perf/throughput:958.0006673641113
step:39 - global_seqlen/min:149189 - global_seqlen/max:219013 - global_seqlen/minmax_diff:69824 - global_seqlen/balanced_min:184426 - global_seqlen/balanced_max:187679 - global_seqlen/mean:185239.25 - actor/entropy:0.19730839133262634 - actor/reward_kl_penalty:0.6765448451042175 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(-0.004333635209877684) - actor/pg_clipfrac:np.float64(0.004181176563724876) - actor/ppo_kl:np.float64(4.930873574267025e-05) - actor/pg_clipfrac_lower:np.float64(1.1448495570220985e-05) - actor/grad_norm:np.float64(0.8870968073606491) - perf/mfu/actor:np.float64(0.36656388330651424) - perf/max_memory_allocated_gb:np.float64(46.29087543487549) - perf/max_memory_reserved_gb:np.float64(54.966796875) - perf/cpu_memory_used_gb:np.float64(469.02220153808594) - actor/lr:np.float64(1e-06) - training/global_step:39 - training/epoch:0 - critic/score/mean:-0.570507824420929 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.8828328847885132 - critic/rewards/max:0.8650913834571838 - critic/rewards/min:-2.290214776992798 - critic/advantages/mean:0.02097846381366253 - critic/advantages/max:3.6389706134796143 - critic/advantages/min:-3.5567800998687744 - critic/returns/mean:0.02097846381366253 - critic/returns/max:3.6389706134796143 - critic/returns/min:-3.5567800998687744 - response_length/mean:1097.087890625 - response_length/max:8096.0 - response_length/min:7.0 - response_length/clip_ratio:0.001953125 - response_length_non_aborted/mean:1097.087890625 - response_length_non_aborted/max:8096.0 - response_length_non_aborted/min:7.0 - response_length_non_aborted/clip_ratio:0.001953125 - response/aborted_ratio:0.0 - prompt_length/mean:350.09375 - prompt_length/max:645.0 - prompt_length/min:269.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(10.18359375) - timing_s/start_profile:7.684784941375256e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(0.8135343210306019) - timing_s/agent_loop/generate_sequences/max:np.float64(97.8648253036663) - timing_s/agent_loop/generate_sequences/mean:np.float64(28.56976199111159) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(32.335943104932085) - timing_s/agent_loop/tool_calls/mean:np.float64(1.1206092418692606) - timing_s/agent_loop/slowest/generate_sequences:np.float64(97.8648253036663) - timing_s/agent_loop/slowest/tool_calls:np.float64(1.0146542971488088) - timing_s/agent_loop/slowest/prompt_length:436 - timing_s/agent_loop/slowest/response_length:8096 - timing_s/gen:101.29294389812276 - timing_s/reward:0.00013780314475297928 - timing_s/old_log_prob:10.596851554932073 - timing_s/ref:61.310378059977666 - timing_s/adv:0.10827652201987803 - timing_s/update_actor:37.20313017512672 - timing_s/step:210.60633863601834 - timing_s/stop_profile:4.969094879925251e-05 - timing_per_token_ms/gen:0.18032992866078834 - timing_per_token_ms/update_actor:0.05020956705331985 - timing_per_token_ms/adv:0.00014613064188593675 - timing_per_token_ms/ref:0.08274485302113033 - perf/total_num_tokens:740957 - perf/time_per_step:210.60633863601834 - perf/throughput:879.5521122473946
test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 40}
validation generation end
len reward_extra_infos_dict['reward']: 960
len reward_extra_infos_dict['score']: 960
len reward_extra_infos_dict['acc']: 960
len reward_extra_infos_dict['pred']: 960
step:40 - global_seqlen/min:157287 - global_seqlen/max:186015 - global_seqlen/minmax_diff:28728 - global_seqlen/balanced_min:175622 - global_seqlen/balanced_max:175655 - global_seqlen/mean:175630.75 - actor/entropy:0.1970015913248062 - actor/reward_kl_penalty:0.6962524652481079 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(-0.0036926053016941296) - actor/pg_clipfrac:np.float64(0.004387203976511956) - actor/ppo_kl:np.float64(3.82402530476611e-05) - actor/pg_clipfrac_lower:np.float64(1.5067419371916913e-05) - actor/grad_norm:np.float64(0.9787291884422302) - perf/mfu/actor:np.float64(0.35753347339907054) - perf/max_memory_allocated_gb:np.float64(46.29087543487549) - perf/max_memory_reserved_gb:np.float64(54.970703125) - perf/cpu_memory_used_gb:np.float64(469.1110420227051) - actor/lr:np.float64(1e-06) - val-aux/aime_2024/reward/mean@16:np.float64(-0.6554166761537393) - val-aux/aime_2024/reward/std@16:np.float64(0.15952496910162922) - val-aux/aime_2024/reward/best@2/mean:np.float64(-0.5903866815765699) - val-aux/aime_2024/reward/best@2/std:np.float64(0.14910631771183386) - val-aux/aime_2024/reward/worst@2/mean:np.float64(-0.7224200039664904) - val-aux/aime_2024/reward/worst@2/std:np.float64(0.1113856101276811) - val-aux/aime_2024/reward/maj@2/mean:np.float64(-0.6556333426872888) - val-aux/aime_2024/reward/maj@2/std:np.float64(0.15950899111027372) - val-aux/aime_2024/reward/best@4/mean:np.float64(-0.5296666850586732) - val-aux/aime_2024/reward/best@4/std:np.float64(0.13993559729839214) - val-aux/aime_2024/reward/worst@4/mean:np.float64(-0.7713999988277753) - val-aux/aime_2024/reward/worst@4/std:np.float64(0.08064382389155648) - val-aux/aime_2024/reward/maj@4/mean:np.float64(-0.6527466763416927) - val-aux/aime_2024/reward/maj@4/std:np.float64(0.14994670657381837) - val-aux/aime_2024/reward/best@8/mean:np.float64(-0.4694500200033188) - val-aux/aime_2024/reward/best@8/std:np.float64(0.1304033068156002) - val-aux/aime_2024/reward/worst@8/mean:np.float64(-0.8099799947877725) - val-aux/aime_2024/reward/worst@8/std:np.float64(0.05749663732095198) - val-aux/aime_2024/reward/maj@8/mean:np.float64(-0.6452133432090285) - val-aux/aime_2024/reward/maj@8/std:np.float64(0.13517305896663498) - val-aux/aime_2024/reward/best@16/mean:np.float64(-0.40776668696602186) - val-aux/aime_2024/reward/best@16/std:np.float64(0.10921312650229795) - val-aux/aime_2024/reward/worst@16/mean:np.float64(-0.8360266588191192) - val-aux/aime_2024/reward/worst@16/std:np.float64(0.036207043771187844) - val-aux/aime_2024/reward/maj@16/mean:np.float64(-0.6344000102659065) - val-aux/aime_2024/reward/maj@16/std:np.float64(0.11429413003951397) - val-aux/aime_2024/score/mean@16:np.float64(-0.6554166666666669) - val-aux/aime_2024/score/std@16:np.float64(0.15952497856586598) - val-aux/aime_2024/score/best@2/mean:np.float64(-0.5903866666666665) - val-aux/aime_2024/score/best@2/std:np.float64(0.14910632462454576) - val-aux/aime_2024/score/worst@2/mean:np.float64(-0.7224200000000001) - val-aux/aime_2024/score/worst@2/std:np.float64(0.11138561923918579) - val-aux/aime_2024/score/maj@2/mean:np.float64(-0.6556333333333332) - val-aux/aime_2024/score/maj@2/std:np.float64(0.15950900065529153) - val-aux/aime_2024/score/best@4/mean:np.float64(-0.5296666666666666) - val-aux/aime_2024/score/best@4/std:np.float64(0.1399356013456555) - val-aux/aime_2024/score/worst@4/mean:np.float64(-0.7714) - val-aux/aime_2024/score/worst@4/std:np.float64(0.08064383193237752) - val-aux/aime_2024/score/maj@4/mean:np.float64(-0.6527466666666667) - val-aux/aime_2024/score/maj@4/std:np.float64(0.14994671585985025) - val-aux/aime_2024/score/best@8/mean:np.float64(-0.4694499999999998) - val-aux/aime_2024/score/best@8/std:np.float64(0.13040330832792507) - val-aux/aime_2024/score/worst@8/mean:np.float64(-0.80998) - val-aux/aime_2024/score/worst@8/std:np.float64(0.057496643177648875) - val-aux/aime_2024/score/maj@8/mean:np.float64(-0.6452133333333332) - val-aux/aime_2024/score/maj@8/std:np.float64(0.13517306786109953) - val-aux/aime_2024/score/best@16/mean:np.float64(-0.40776666666666644) - val
step:41 - global_seqlen/min:171625 - global_seqlen/max:195586 - global_seqlen/minmax_diff:23961 - global_seqlen/balanced_min:185738 - global_seqlen/balanced_max:186318 - global_seqlen/mean:185883.25 - actor/entropy:0.1889619082212448 - actor/reward_kl_penalty:0.6579310894012451 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(-0.005763038857548963) - actor/pg_clipfrac:np.float64(0.004349210998043418) - actor/ppo_kl:np.float64(3.903845681634266e-05) - actor/pg_clipfrac_lower:np.float64(1.1583159539441112e-05) - actor/grad_norm:np.float64(0.8733888119459152) - perf/mfu/actor:np.float64(0.36671989426951024) - perf/max_memory_allocated_gb:np.float64(46.29087543487549) - perf/max_memory_reserved_gb:np.float64(54.970703125) - perf/cpu_memory_used_gb:np.float64(469.0373077392578) - actor/lr:np.float64(1e-06) - training/global_step:41 - training/epoch:0 - critic/score/mean:-0.552929699420929 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.871238112449646 - critic/rewards/max:0.8557971715927124 - critic/rewards/min:-2.0691890716552734 - critic/advantages/mean:0.026572072878479958 - critic/advantages/max:3.621795654296875 - critic/advantages/min:-3.5392348766326904 - critic/returns/mean:0.026572072878479958 - critic/returns/max:3.621795654296875 - critic/returns/min:-3.5392348766326904 - response_length/mean:1104.119140625 - response_length/max:4732.0 - response_length/min:73.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:1104.119140625 - response_length_non_aborted/max:4732.0 - response_length_non_aborted/min:73.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:348.09375 - prompt_length/max:553.0 - prompt_length/min:272.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(10.3984375) - timing_s/start_profile:6.942893378436565e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(2.198304720921442) - timing_s/agent_loop/generate_sequences/max:np.float64(63.59105039853603) - timing_s/agent_loop/generate_sequences/mean:np.float64(28.123823411342073) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(47.22612531785853) - timing_s/agent_loop/tool_calls/mean:np.float64(1.846848325460087) - timing_s/agent_loop/slowest/generate_sequences:np.float64(40.59571287129074) - timing_s/agent_loop/slowest/tool_calls:np.float64(32.22261776146479) - timing_s/agent_loop/slowest/prompt_length:315 - timing_s/agent_loop/slowest/response_length:1812 - timing_s/gen:74.82996881590225 - timing_s/reward:0.00013498892076313496 - timing_s/old_log_prob:10.85613289498724 - timing_s/ref:61.61793884006329 - timing_s/adv:0.10316002694889903 - timing_s/update_actor:37.15452228183858 - timing_s/step:184.6303203261923 - timing_s/stop_profile:6.45879190415144e-05 - timing_per_token_ms/gen:0.13237002916263893 - timing_per_token_ms/update_actor:0.04997023976318278 - timing_per_token_ms/adv:0.0001387430375637652 - timing_per_token_ms/ref:0.0828718279350927 - perf/total_num_tokens:743533 - perf/time_per_step:184.6303203261923 - perf/throughput:1006.7861533879923
step:42 - global_seqlen/min:157971 - global_seqlen/max:184476 - global_seqlen/minmax_diff:26505 - global_seqlen/balanced_min:175652 - global_seqlen/balanced_max:176313 - global_seqlen/mean:175817.75 - actor/entropy:0.1766604781150818 - actor/reward_kl_penalty:0.6827396750450134 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.008111920841474784) - actor/pg_clipfrac:np.float64(0.0037943557137623428) - actor/ppo_kl:np.float64(1.787784503903822e-05) - actor/pg_clipfrac_lower:np.float64(9.674155080574565e-06) - actor/grad_norm:np.float64(0.8986476361751556) - perf/mfu/actor:np.float64(0.35974062682473434) - perf/max_memory_allocated_gb:np.float64(46.29087543487549) - perf/max_memory_reserved_gb:np.float64(54.970703125) - perf/cpu_memory_used_gb:np.float64(469.1466941833496) - actor/lr:np.float64(1e-06) - training/global_step:42 - training/epoch:0 - critic/score/mean:-0.38203126192092896 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.6824883222579956 - critic/rewards/max:0.8772810697555542 - critic/rewards/min:-1.7050223350524902 - critic/advantages/mean:-0.05038592591881752 - critic/advantages/max:3.6819827556610107 - critic/advantages/min:-3.7379257678985596 - critic/returns/mean:-0.05038592591881752 - critic/returns/max:3.6819827556610107 - critic/returns/min:-3.7379257678985596 - response_length/mean:1047.982421875 - response_length/max:5112.0 - response_length/min:5.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:1047.982421875 - response_length_non_aborted/max:5112.0 - response_length_non_aborted/min:5.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:325.59375 - prompt_length/max:465.0 - prompt_length/min:261.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(10.84375) - timing_s/start_profile:7.63358548283577e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(0.2695235840510577) - timing_s/agent_loop/generate_sequences/max:np.float64(60.57520804135129) - timing_s/agent_loop/generate_sequences/mean:np.float64(21.728592102385846) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(64.81031430093572) - timing_s/agent_loop/tool_calls/mean:np.float64(7.1301098285962325) - timing_s/agent_loop/slowest/generate_sequences:np.float64(12.198743066051975) - timing_s/agent_loop/slowest/tool_calls:np.float64(64.81031430093572) - timing_s/agent_loop/slowest/prompt_length:333 - timing_s/agent_loop/slowest/response_length:590 - timing_s/gen:79.57380825001746 - timing_s/reward:0.0001291101798415184 - timing_s/old_log_prob:10.250687940977514 - timing_s/ref:58.35418207501061 - timing_s/adv:0.06751259695738554 - timing_s/update_actor:35.71093068504706 - timing_s/step:184.0412577111274 - timing_s/stop_profile:5.4660020396113396e-05 - timing_per_token_ms/gen:0.14830171861112865 - timing_per_token_ms/update_actor:0.0507783353572763 - timing_per_token_ms/adv:9.59979822250392e-05 - timing_per_token_ms/ref:0.0829753851289341 - perf/total_num_tokens:703271 - perf/time_per_step:184.0412577111274 - perf/throughput:955.3170424208082
step:43 - global_seqlen/min:150716 - global_seqlen/max:194699 - global_seqlen/minmax_diff:43983 - global_seqlen/balanced_min:173054 - global_seqlen/balanced_max:173055 - global_seqlen/mean:173054.25 - actor/entropy:0.1748012751340866 - actor/reward_kl_penalty:0.6829469203948975 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.0034548275267297867) - actor/pg_clipfrac:np.float64(0.0037899877643212676) - actor/ppo_kl:np.float64(-1.1749088605483848e-05) - actor/pg_clipfrac_lower:np.float64(2.009795716730878e-05) - actor/grad_norm:np.float64(0.9263501763343811) - perf/mfu/actor:np.float64(0.3650044835475352) - perf/max_memory_allocated_gb:np.float64(46.29087543487549) - perf/max_memory_reserved_gb:np.float64(54.970703125) - perf/cpu_memory_used_gb:np.float64(469.3287582397461) - actor/lr:np.float64(1e-06) - training/global_step:43 - training/epoch:0 - critic/score/mean:-0.42499998211860657 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.7202792763710022 - critic/rewards/max:0.8925734758377075 - critic/rewards/min:-1.6188377141952515 - critic/advantages/mean:-0.018888594582676888 - critic/advantages/max:3.6713905334472656 - critic/advantages/min:-2.8731861114501953 - critic/returns/mean:-0.018888594582676888 - critic/returns/max:3.6713905334472656 - critic/returns/min:-2.8731861114501953 - response_length/mean:1018.486328125 - response_length/max:4409.0 - response_length/min:148.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:1018.486328125 - response_length_non_aborted/max:4409.0 - response_length_non_aborted/min:148.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:333.5 - prompt_length/max:559.0 - prompt_length/min:259.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(10.3984375) - timing_s/start_profile:6.539002060890198e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(5.0413904471788555) - timing_s/agent_loop/generate_sequences/max:np.float64(60.16154958214611) - timing_s/agent_loop/generate_sequences/mean:np.float64(25.150252400007503) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(30.58085390389897) - timing_s/agent_loop/tool_calls/mean:np.float64(0.9426718965346481) - timing_s/agent_loop/slowest/generate_sequences:np.float64(60.16154958214611) - timing_s/agent_loop/slowest/tool_calls:np.float64(0.3409206422511488) - timing_s/agent_loop/slowest/prompt_length:318 - timing_s/agent_loop/slowest/response_length:4409 - timing_s/gen:62.954515987075865 - timing_s/reward:0.0001365221105515957 - timing_s/old_log_prob:9.936034418875352 - timing_s/ref:57.73528221203014 - timing_s/adv:0.06404692400246859 - timing_s/update_actor:34.816546795889735 - timing_s/step:165.57401978294365 - timing_s/stop_profile:5.374802276492119e-05 - timing_per_token_ms/gen:0.12072625389446245 - timing_per_token_ms/update_actor:0.05029715652156728 - timing_per_token_ms/adv:9.25243442482178e-05 - timing_per_token_ms/ref:0.08340633386933598 - perf/total_num_tokens:692217 - perf/time_per_step:165.57401978294365 - perf/throughput:1045.1775600233807
step:44 - global_seqlen/min:183344 - global_seqlen/max:207482 - global_seqlen/minmax_diff:24138 - global_seqlen/balanced_min:191357 - global_seqlen/balanced_max:193491 - global_seqlen/mean:191914.25 - actor/entropy:0.17254656553268433 - actor/reward_kl_penalty:0.661251425743103 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.003647266160987783) - actor/pg_clipfrac:np.float64(0.003721422119997442) - actor/ppo_kl:np.float64(1.8928130975837122e-05) - actor/pg_clipfrac_lower:np.float64(2.2504274966195227e-06) - actor/grad_norm:np.float64(0.9330907911062241) - perf/mfu/actor:np.float64(0.37139787278667613) - perf/max_memory_allocated_gb:np.float64(46.29087543487549) - perf/max_memory_reserved_gb:np.float64(54.970703125) - perf/cpu_memory_used_gb:np.float64(469.1896858215332) - actor/lr:np.float64(1e-06) - training/global_step:44 - training/epoch:0 - critic/score/mean:-0.49980467557907104 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.8128324151039124 - critic/rewards/max:0.8729472756385803 - critic/rewards/min:-2.4729785919189453 - critic/advantages/mean:-0.02412254735827446 - critic/advantages/max:3.670433521270752 - critic/advantages/min:-3.351973533630371 - critic/returns/mean:-0.02412254735827446 - critic/returns/max:3.670433521270752 - critic/returns/min:-3.351973533630371 - response_length/mean:1167.455078125 - response_length/max:8096.0 - response_length/min:166.0 - response_length/clip_ratio:0.001953125 - response_length_non_aborted/mean:1167.455078125 - response_length_non_aborted/max:8096.0 - response_length_non_aborted/min:166.0 - response_length_non_aborted/clip_ratio:0.001953125 - response/aborted_ratio:0.0 - prompt_length/mean:331.875 - prompt_length/max:459.0 - prompt_length/min:263.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(11.30078125) - timing_s/start_profile:7.60890543460846e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(5.063513476867229) - timing_s/agent_loop/generate_sequences/max:np.float64(106.16929454705678) - timing_s/agent_loop/generate_sequences/mean:np.float64(30.920956660309002) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(60.6611608278472) - timing_s/agent_loop/tool_calls/mean:np.float64(1.3736053851148426) - timing_s/agent_loop/slowest/generate_sequences:np.float64(106.16929454705678) - timing_s/agent_loop/slowest/tool_calls:np.float64(0.0) - timing_s/agent_loop/slowest/prompt_length:300 - timing_s/agent_loop/slowest/response_length:8096 - timing_s/gen:108.7349006109871 - timing_s/reward:0.00012197205796837807 - timing_s/old_log_prob:10.739723866805434 - timing_s/ref:63.51273359404877 - timing_s/adv:0.08927246299572289 - timing_s/update_actor:38.02201752201654 - timing_s/step:221.17973458301276 - timing_s/stop_profile:5.054520443081856e-05 - timing_per_token_ms/gen:0.18191094178708545 - timing_per_token_ms/update_actor:0.049529956115838894 - timing_per_token_ms/adv:0.00011629212395083076 - timing_per_token_ms/ref:0.08273582289231879 - perf/total_num_tokens:767657 - perf/time_per_step:221.17973458301276 - perf/throughput:867.6846021260194
step:45 - global_seqlen/min:157121 - global_seqlen/max:182348 - global_seqlen/minmax_diff:25227 - global_seqlen/balanced_min:169540 - global_seqlen/balanced_max:169541 - global_seqlen/mean:169540.25 - actor/entropy:0.18519710004329681 - actor/reward_kl_penalty:0.6976096630096436 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(-0.008689367581973783) - actor/pg_clipfrac:np.float64(0.004059182037599385) - actor/ppo_kl:np.float64(4.298440508136992e-05) - actor/pg_clipfrac_lower:np.float64(1.0622468289511744e-05) - actor/grad_norm:np.float64(0.9834296554327011) - perf/mfu/actor:np.float64(0.36861315241651876) - perf/max_memory_allocated_gb:np.float64(46.29087543487549) - perf/max_memory_reserved_gb:np.float64(54.970703125) - perf/cpu_memory_used_gb:np.float64(469.2813415527344) - actor/lr:np.float64(1e-06) - training/global_step:45 - training/epoch:0 - critic/score/mean:-0.50390625 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.8062666654586792 - critic/rewards/max:0.8540884852409363 - critic/rewards/min:-1.4326951503753662 - critic/advantages/mean:0.04466812685132027 - critic/advantages/max:3.6159863471984863 - critic/advantages/min:-3.0263378620147705 - critic/returns/mean:0.04466812685132027 - critic/returns/max:3.6159863471984863 - critic/returns/min:-3.0263378620147705 - response_length/mean:965.220703125 - response_length/max:3040.0 - response_length/min:95.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:965.220703125 - response_length_non_aborted/max:3040.0 - response_length_non_aborted/min:95.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:359.3125 - prompt_length/max:799.0 - prompt_length/min:276.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(10.07421875) - timing_s/start_profile:0.0001331469975411892 - timing_s/agent_loop/generate_sequences/min:np.float64(3.1415918339043856) - timing_s/agent_loop/generate_sequences/max:np.float64(47.11132641462609) - timing_s/agent_loop/generate_sequences/mean:np.float64(24.631779941546938) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(30.44692842825316) - timing_s/agent_loop/tool_calls/mean:np.float64(1.034703552839801) - timing_s/agent_loop/slowest/generate_sequences:np.float64(25.428013221127912) - timing_s/agent_loop/slowest/tool_calls:np.float64(30.15751140890643) - timing_s/agent_loop/slowest/prompt_length:411 - timing_s/agent_loop/slowest/response_length:805 - timing_s/gen:58.02068746602163 - timing_s/reward:0.00013664201833307743 - timing_s/old_log_prob:9.667389004025608 - timing_s/ref:56.41691695782356 - timing_s/adv:0.08134000306017697 - timing_s/update_actor:33.723055090988055 - timing_s/step:157.97922680387273 - timing_s/stop_profile:5.0483038648962975e-05 - timing_per_token_ms/gen:0.11740491562207807 - timing_per_token_ms/update_actor:0.049727210929245494 - timing_per_token_ms/adv:0.00011994202418035978 - timing_per_token_ms/ref:0.08319103716937948 - perf/total_num_tokens:678161 - perf/time_per_step:157.97922680387273 - perf/throughput:1073.1806543810978
step:46 - global_seqlen/min:172153 - global_seqlen/max:209026 - global_seqlen/minmax_diff:36873 - global_seqlen/balanced_min:187735 - global_seqlen/balanced_max:187736 - global_seqlen/mean:187735.75 - actor/entropy:0.18309685587882996 - actor/reward_kl_penalty:0.6660739183425903 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(-0.00407106984348502) - actor/pg_clipfrac:np.float64(0.0038731103064492344) - actor/ppo_kl:np.float64(6.593235159471078e-05) - actor/pg_clipfrac_lower:np.float64(4.523190727923065e-06) - actor/grad_norm:np.float64(0.8684481829404831) - perf/mfu/actor:np.float64(0.3687091219262375) - perf/max_memory_allocated_gb:np.float64(46.29087543487549) - perf/max_memory_reserved_gb:np.float64(54.970703125) - perf/cpu_memory_used_gb:np.float64(469.2732048034668) - actor/lr:np.float64(1e-06) - training/global_step:46 - training/epoch:0 - critic/score/mean:-0.569531261920929 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.8778500556945801 - critic/rewards/max:0.8878222703933716 - critic/rewards/min:-1.4255316257476807 - critic/advantages/mean:0.019234513863921165 - critic/advantages/max:3.6647515296936035 - critic/advantages/min:-2.363473415374756 - critic/returns/mean:0.019234513863921165 - critic/returns/max:3.6647515296936035 - critic/returns/min:-2.363473415374756 - response_length/mean:1109.654296875 - response_length/max:2905.0 - response_length/min:97.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:1109.654296875 - response_length_non_aborted/max:2905.0 - response_length_non_aborted/min:97.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:357.03125 - prompt_length/max:957.0 - prompt_length/min:262.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(10.65625) - timing_s/start_profile:6.147101521492004e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(3.1575434380210936) - timing_s/agent_loop/generate_sequences/max:np.float64(49.53276270907372) - timing_s/agent_loop/generate_sequences/mean:np.float64(27.271024648960974) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(61.910265878308564) - timing_s/agent_loop/tool_calls/mean:np.float64(3.563847339435597) - timing_s/agent_loop/slowest/generate_sequences:np.float64(26.049719910603017) - timing_s/agent_loop/slowest/tool_calls:np.float64(61.910265878308564) - timing_s/agent_loop/slowest/prompt_length:324 - timing_s/agent_loop/slowest/response_length:1480 - timing_s/gen:90.39066581986845 - timing_s/reward:0.00012451992370188236 - timing_s/old_log_prob:10.78033564100042 - timing_s/ref:62.139632598962635 - timing_s/adv:0.0688879368826747 - timing_s/update_actor:37.22369870892726 - timing_s/step:200.6531127090566 - timing_s/stop_profile:5.13449776917696e-05 - timing_per_token_ms/gen:0.15909844144848823 - timing_per_token_ms/update_actor:0.0495692731790925 - timing_per_token_ms/adv:9.173524073421643e-05 - timing_per_token_ms/ref:0.08274880063994555 - perf/total_num_tokens:750943 - perf/time_per_step:200.6531127090566 - perf/throughput:935.6234122927037
step:47 - global_seqlen/min:171915 - global_seqlen/max:187016 - global_seqlen/minmax_diff:15101 - global_seqlen/balanced_min:180462 - global_seqlen/balanced_max:180463 - global_seqlen/mean:180462.25 - actor/entropy:0.16562789678573608 - actor/reward_kl_penalty:0.687354326248169 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(-0.0036224307933480303) - actor/pg_clipfrac:np.float64(0.003814614308066666) - actor/ppo_kl:np.float64(4.8506872349207694e-05) - actor/pg_clipfrac_lower:np.float64(7.079039460222703e-06) - actor/grad_norm:np.float64(0.8548095524311066) - perf/mfu/actor:np.float64(0.363480761894968) - perf/max_memory_allocated_gb:np.float64(46.29087543487549) - perf/max_memory_reserved_gb:np.float64(54.970703125) - perf/cpu_memory_used_gb:np.float64(469.334171295166) - actor/lr:np.float64(1e-06) - training/global_step:47 - training/epoch:0 - critic/score/mean:-0.4341796636581421 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.7410288453102112 - critic/rewards/max:0.8746317028999329 - critic/rewards/min:-1.447900652885437 - critic/advantages/mean:0.017748478800058365 - critic/advantages/max:3.7341020107269287 - critic/advantages/min:-2.5880582332611084 - critic/returns/mean:0.017748478800058365 - critic/returns/max:3.7341020107269287 - critic/returns/min:-2.5880582332611084 - response_length/mean:1084.986328125 - response_length/max:3673.0 - response_length/min:151.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:1084.986328125 - response_length_non_aborted/max:3673.0 - response_length_non_aborted/min:151.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:324.875 - prompt_length/max:487.0 - prompt_length/min:257.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(11.55078125) - timing_s/start_profile:7.782410830259323e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(4.103675786172971) - timing_s/agent_loop/generate_sequences/max:np.float64(53.45296512590721) - timing_s/agent_loop/generate_sequences/mean:np.float64(28.107788377906218) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(31.974507607752457) - timing_s/agent_loop/tool_calls/mean:np.float64(1.2065244670802713) - timing_s/agent_loop/slowest/generate_sequences:np.float64(34.096361755160615) - timing_s/agent_loop/slowest/tool_calls:np.float64(31.974507607752457) - timing_s/agent_loop/slowest/prompt_length:347 - timing_s/agent_loop/slowest/response_length:1778 - timing_s/gen:68.51594651001506 - timing_s/reward:0.00017719995230436325 - timing_s/old_log_prob:10.238380796043202 - timing_s/ref:59.93446994898841 - timing_s/adv:0.07542950310744345 - timing_s/update_actor:36.25087075890042 - timing_s/step:175.08443578798324 - timing_s/stop_profile:5.157408304512501e-05 - timing_per_token_ms/gen:0.12333815142042591 - timing_per_token_ms/update_actor:0.05021946523289555 - timing_per_token_ms/adv:0.00010449485017980693 - timing_per_token_ms/ref:0.08302909604223101 - perf/total_num_tokens:721849 - perf/time_per_step:175.08443578798324 - perf/throughput:1030.7155469748834
step:48 - global_seqlen/min:173372 - global_seqlen/max:204155 - global_seqlen/minmax_diff:30783 - global_seqlen/balanced_min:189691 - global_seqlen/balanced_max:189692 - global_seqlen/mean:189691.75 - actor/entropy:0.16955643892288208 - actor/reward_kl_penalty:0.6973928213119507 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(-0.014085269532552047) - actor/pg_clipfrac:np.float64(0.0039318296359851955) - actor/ppo_kl:np.float64(2.3620857336936752e-05) - actor/pg_clipfrac_lower:np.float64(7.041531171125826e-06) - actor/grad_norm:np.float64(0.883880078792572) - perf/mfu/actor:np.float64(0.3689408807451742) - perf/max_memory_allocated_gb:np.float64(46.29087543487549) - perf/max_memory_reserved_gb:np.float64(54.970703125) - perf/cpu_memory_used_gb:np.float64(469.408016204834) - actor/lr:np.float64(1e-06) - training/global_step:48 - training/epoch:0 - critic/score/mean:-0.507031261920929 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.8100993037223816 - critic/rewards/max:0.8747361302375793 - critic/rewards/min:-1.630943775177002 - critic/advantages/mean:0.07031751424074173 - critic/advantages/max:3.6105213165283203 - critic/advantages/min:-2.8547415733337402 - critic/returns/mean:0.07031751424074173 - critic/returns/max:3.6105213165283203 - critic/returns/min:-2.8547415733337402 - response_length/mean:1131.373046875 - response_length/max:3615.0 - response_length/min:104.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:1131.373046875 - response_length_non_aborted/max:3615.0 - response_length_non_aborted/min:104.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:350.59375 - prompt_length/max:681.0 - prompt_length/min:284.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(11.109375) - timing_s/start_profile:8.160085417330265e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(3.1081662410870194) - timing_s/agent_loop/generate_sequences/max:np.float64(53.93603772809729) - timing_s/agent_loop/generate_sequences/mean:np.float64(28.936005709656) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(14.322377065895125) - timing_s/agent_loop/tool_calls/mean:np.float64(0.8694953905419425) - timing_s/agent_loop/slowest/generate_sequences:np.float64(40.52707924996503) - timing_s/agent_loop/slowest/tool_calls:np.float64(14.322377065895125) - timing_s/agent_loop/slowest/prompt_length:366 - timing_s/agent_loop/slowest/response_length:1633 - timing_s/gen:57.32128832209855 - timing_s/reward:0.00012895395047962666 - timing_s/old_log_prob:10.684403401101008 - timing_s/ref:62.843695022165775 - timing_s/adv:0.06792604294605553 - timing_s/update_actor:37.64702579914592 - timing_s/step:168.63790472596884 - timing_s/stop_profile:5.243811756372452e-05 - timing_per_token_ms/gen:0.09895554924464113 - timing_per_token_ms/update_actor:0.049616055784115445 - timing_per_token_ms/adv:8.952160932941934e-05 - timing_per_token_ms/ref:0.08282344253527865 - perf/total_num_tokens:758767 - perf/time_per_step:168.63790472596884 - perf/throughput:1124.8464590937783
step:49 - global_seqlen/min:175604 - global_seqlen/max:195999 - global_seqlen/minmax_diff:20395 - global_seqlen/balanced_min:182803 - global_seqlen/balanced_max:185632 - global_seqlen/mean:183659.25 - actor/entropy:0.16981101036071777 - actor/reward_kl_penalty:0.7160027623176575 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(-0.006029296896122105) - actor/pg_clipfrac:np.float64(0.0042294944170862435) - actor/ppo_kl:np.float64(-1.8354948952037376e-05) - actor/pg_clipfrac_lower:np.float64(1.7231393576366828e-05) - actor/grad_norm:np.float64(0.920319676399231) - perf/mfu/actor:np.float64(0.366432795156712) - perf/max_memory_allocated_gb:np.float64(46.29087543487549) - perf/max_memory_reserved_gb:np.float64(54.970703125) - perf/cpu_memory_used_gb:np.float64(469.3732604980469) - actor/lr:np.float64(1e-06) - training/global_step:49 - training/epoch:0 - critic/score/mean:-0.42265626788139343 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.717514157295227 - critic/rewards/max:0.8676428198814392 - critic/rewards/min:-1.6281062364578247 - critic/advantages/mean:0.028877366334199905 - critic/advantages/max:3.702798843383789 - critic/advantages/min:-3.1863152980804443 - critic/returns/mean:0.028877366334199905 - critic/returns/max:3.702798843383789 - critic/returns/min:-3.1863152980804443 - response_length/mean:1092.431640625 - response_length/max:8096.0 - response_length/min:120.0 - response_length/clip_ratio:0.001953125 - response_length_non_aborted/mean:1092.431640625 - response_length_non_aborted/max:8096.0 - response_length_non_aborted/min:120.0 - response_length_non_aborted/clip_ratio:0.001953125 - response/aborted_ratio:0.0 - prompt_length/mean:342.40625 - prompt_length/max:603.0 - prompt_length/min:260.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(11.26953125) - timing_s/start_profile:0.00011854385957121849 - timing_s/agent_loop/generate_sequences/min:np.float64(3.9846279970370233) - timing_s/agent_loop/generate_sequences/max:np.float64(101.33017085888423) - timing_s/agent_loop/generate_sequences/mean:np.float64(27.163608037671565) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(60.19106844277121) - timing_s/agent_loop/tool_calls/mean:np.float64(1.4258944694429374) - timing_s/agent_loop/slowest/generate_sequences:np.float64(101.33017085888423) - timing_s/agent_loop/slowest/tool_calls:np.float64(0.0941843029577285) - timing_s/agent_loop/slowest/prompt_length:301 - timing_s/agent_loop/slowest/response_length:8096 - timing_s/gen:103.91922446386889 - timing_s/reward:0.00013612001203000546 - timing_s/old_log_prob:10.60575832403265 - timing_s/ref:60.87872245605104 - timing_s/adv:0.08890196797437966 - timing_s/update_actor:36.84399297600612 - timing_s/step:212.4027093600016 - timing_s/stop_profile:4.9202935770154e-05 - timing_per_token_ms/gen:0.18579399180059694 - timing_per_token_ms/update_actor:0.05015265086839639 - timing_per_token_ms/adv:0.00012101482497393905 - timing_per_token_ms/ref:0.08286912101629926 - perf/total_num_tokens:734637 - perf/time_per_step:212.4027093600016 - perf/throughput:864.6747047313587
test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 50}
validation generation end
len reward_extra_infos_dict['reward']: 960
len reward_extra_infos_dict['score']: 960
len reward_extra_infos_dict['acc']: 960
len reward_extra_infos_dict['pred']: 960
local_global_step_folder: /data0/user10/Open-AgentRL/checkpoint/qwen2_3b_opd/global_step_50
step:50 - global_seqlen/min:156276 - global_seqlen/max:218028 - global_seqlen/minmax_diff:61752 - global_seqlen/balanced_min:184748 - global_seqlen/balanced_max:185336 - global_seqlen/mean:184895.5 - actor/entropy:0.1689283698797226 - actor/reward_kl_penalty:0.6938146352767944 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(-0.016597054488875072) - actor/pg_clipfrac:np.float64(0.0038401528727263212) - actor/ppo_kl:np.float64(-2.687029500521021e-05) - actor/pg_clipfrac_lower:np.float64(1.1838836690003518e-05) - actor/grad_norm:np.float64(0.8754254281520844) - perf/mfu/actor:np.float64(0.36518647565141965) - perf/max_memory_allocated_gb:np.float64(46.29087543487549) - perf/max_memory_reserved_gb:np.float64(54.970703125) - perf/cpu_memory_used_gb:np.float64(469.416446685791) - actor/lr:np.float64(1e-06) - val-aux/aime_2024/reward/mean@16:np.float64(-0.6237500154723724) - val-aux/aime_2024/reward/std@16:np.float64(0.12227243364086963) - val-aux/aime_2024/reward/best@2/mean:np.float64(-0.5726266859829426) - val-aux/aime_2024/reward/best@2/std:np.float64(0.10871088424818609) - val-aux/aime_2024/reward/worst@2/mean:np.float64(-0.677950011620919) - val-aux/aime_2024/reward/worst@2/std:np.float64(0.09205942613658168) - val-aux/aime_2024/reward/maj@2/mean:np.float64(-0.6253900154074034) - val-aux/aime_2024/reward/maj@2/std:np.float64(0.12294348407326544) - val-aux/aime_2024/reward/best@4/mean:np.float64(-0.5250300214489301) - val-aux/aime_2024/reward/best@4/std:np.float64(0.09258950556113298) - val-aux/aime_2024/reward/worst@4/mean:np.float64(-0.7179433408776918) - val-aux/aime_2024/reward/worst@4/std:np.float64(0.06999670466287511) - val-aux/aime_2024/reward/maj@4/mean:np.float64(-0.6216533490916094) - val-aux/aime_2024/reward/maj@4/std:np.float64(0.1213829258626446) - val-aux/aime_2024/reward/best@8/mean:np.float64(-0.4840900218725204) - val-aux/aime_2024/reward/best@8/std:np.float64(0.07206612750089508) - val-aux/aime_2024/reward/worst@8/mean:np.float64(-0.7526500045478345) - val-aux/aime_2024/reward/worst@8/std:np.float64(0.05836942158189682) - val-aux/aime_2024/reward/maj@8/mean:np.float64(-0.6169266829093297) - val-aux/aime_2024/reward/maj@8/std:np.float64(0.11880518621903527) - val-aux/aime_2024/reward/best@16/mean:np.float64(-0.45314668831030525) - val-aux/aime_2024/reward/best@16/std:np.float64(0.040008724786342015) - val-aux/aime_2024/reward/worst@16/mean:np.float64(-0.7810833353837332) - val-aux/aime_2024/reward/worst@16/std:np.float64(0.04242169299373858) - val-aux/aime_2024/reward/maj@16/mean:np.float64(-0.6146233500301839) - val-aux/aime_2024/reward/maj@16/std:np.float64(0.11131600912137736) - val-aux/aime_2024/score/mean@16:np.float64(-0.62375) - val-aux/aime_2024/score/std@16:np.float64(0.12227244094620575) - val-aux/aime_2024/score/best@2/mean:np.float64(-0.5726266666666665) - val-aux/aime_2024/score/best@2/std:np.float64(0.10871088914897048) - val-aux/aime_2024/score/worst@2/mean:np.float64(-0.6779499999999998) - val-aux/aime_2024/score/worst@2/std:np.float64(0.09205943363709802) - val-aux/aime_2024/score/maj@2/mean:np.float64(-0.6253899999999999) - val-aux/aime_2024/score/maj@2/std:np.float64(0.12294349140167107) - val-aux/aime_2024/score/best@4/mean:np.float64(-0.5250299999999999) - val-aux/aime_2024/score/best@4/std:np.float64(0.09258950757426819) - val-aux/aime_2024/score/worst@4/mean:np.float64(-0.7179433333333333) - val-aux/aime_2024/score/worst@4/std:np.float64(0.06999671081053425) - val-aux/aime_2024/score/maj@4/mean:np.float64(-0.6216533333333333) - val-aux/aime_2024/score/maj@4/std:np.float64(0.12138293304718069) - val-aux/aime_2024/score/best@8/mean:np.float64(-0.4840899999999998) - val-aux/aime_2024/score/best@8/std:np.float64(0.07206612756547948) - val-aux/aime_2024/score/worst@8/mean:np.float64(-0.7526499999999999) - val-aux/aime_2024/score/worst@8/std:np.float64(0.05836942636907757) - val-aux/aime_2024/score/maj@8/mean:np.float64(-0.6169266666666665) - val-aux/aime_2024/score/maj@8/std:np.float64(0.11880519303349855) - val-aux/aime_2024/score/best@16/mean:np.float64(-0.453146666666
step:51 - global_seqlen/min:175092 - global_seqlen/max:207974 - global_seqlen/minmax_diff:32882 - global_seqlen/balanced_min:188544 - global_seqlen/balanced_max:192033 - global_seqlen/mean:190656.0 - actor/entropy:0.1630409210920334 - actor/reward_kl_penalty:0.7058095335960388 - actor/reward_kl_penalty_coeff:0.001 - actor/pg_loss:np.float64(0.011916248960915254) - actor/pg_clipfrac:np.float64(0.003484735731035471) - actor/ppo_kl:np.float64(3.840968397526012e-05) - actor/pg_clipfrac_lower:np.float64(8.969674854597543e-06) - actor/grad_norm:np.float64(0.8144353926181793) - perf/mfu/actor:np.float64(0.3705614204207621) - perf/max_memory_allocated_gb:np.float64(46.29087543487549) - perf/max_memory_reserved_gb:np.float64(54.970703125) - perf/cpu_memory_used_gb:np.float64(475.9222831726074) - actor/lr:np.float64(1e-06) - training/global_step:51 - training/epoch:0 - critic/score/mean:-0.49609375 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.8641484975814819 - critic/rewards/max:0.8315911293029785 - critic/rewards/min:-40.24516296386719 - critic/advantages/mean:-0.0758073553442955 - critic/advantages/max:3.6976478099823 - critic/advantages/min:-3.749509334564209 - critic/returns/mean:-0.0758073553442955 - critic/returns/max:3.6976478099823 - critic/returns/min:-3.749509334564209 - response_length/mean:1163.8125 - response_length/max:8096.0 - response_length/min:10.0 - response_length/clip_ratio:0.00390625 - response_length_non_aborted/mean:1163.8125 - response_length_non_aborted/max:8096.0 - response_length_non_aborted/min:10.0 - response_length_non_aborted/clip_ratio:0.00390625 - response/aborted_ratio:0.0 - prompt_length/mean:325.6875 - prompt_length/max:555.0 - prompt_length/min:271.0 - prompt_length/clip_ratio:0.0 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(11.8359375) - timing_s/start_profile:6.456905975937843e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(0.7736117080785334) - timing_s/agent_loop/generate_sequences/max:np.float64(109.06373583502136) - timing_s/agent_loop/generate_sequences/mean:np.float64(30.20966718626096) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(62.08613734738901) - timing_s/agent_loop/tool_calls/mean:np.float64(1.3454544525061465) - timing_s/agent_loop/slowest/generate_sequences:np.float64(47.7497041199822) - timing_s/agent_loop/slowest/tool_calls:np.float64(62.08613734738901) - timing_s/agent_loop/slowest/prompt_length:421 - timing_s/agent_loop/slowest/response_length:2490 - timing_s/gen:111.85146095207892 - timing_s/reward:0.00017343717627227306 - timing_s/old_log_prob:10.749667673837394 - timing_s/ref:63.61980093200691 - timing_s/adv:0.10999455396085978 - timing_s/update_actor:37.92769594909623 - timing_s/step:224.33397115208209 - timing_s/stop_profile:4.495191387832165e-05 - timing_per_token_ms/gen:0.18771055017198143 - timing_per_token_ms/update_actor:0.04973315283691076 - timing_per_token_ms/adv:0.0001442316973513288 - timing_per_token_ms/ref:0.08342223813046391 - perf/total_num_tokens:762624 - perf/time_per_step:224.33397115208209 - perf/throughput:849.8757411589221
