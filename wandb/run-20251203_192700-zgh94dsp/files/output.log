wandb: Detected [openai] in use.
wandb: Use W&B Weave for improved LLM call tracing. Weave is installed but not imported. Add `import weave` to the top of your script.
wandb: For more information, check out the docs at: https://weave-docs.wandb.ai/
Checkpoint tracker file does not exist: /data0/user10/Open-AgentRL/checkpoint/qwen2_3b_opd/latest_checkpointed_iteration.txt
Training from scratch
Training Progress:   0%|          | 12/55990 [43:59<3604:24:53, 231.80s/it]
step:1 - global_seqlen/min:162557 - global_seqlen/max:190134 - global_seqlen/minmax_diff:27577 - global_seqlen/balanced_min:173639 - global_seqlen/balanced_max:176658 - global_seqlen/mean:174393.75 - rollout/tool_calls_avg:2.390625 - rollout/tool_success_avg:1.7421875 - rollout/tool_success_rate:0.7287581699346405 - actor/entropy:0.22422002255916595 - actor/pg_loss:np.float64(-0.0031709390722325123) - actor/pg_clipfrac:np.float64(0.002546231909137633) - actor/ppo_kl:np.float64(6.085273222803759e-05) - actor/pg_clipfrac_lower:np.float64(8.784198952424857e-06) - actor/grad_norm:np.float64(0.6096058189868927) - perf/mfu/actor:np.float64(0.36383414315465773) - perf/max_memory_allocated_gb:np.float64(45.743985176086426) - perf/max_memory_reserved_gb:np.float64(53.359375) - perf/cpu_memory_used_gb:np.float64(412.51660537719727) - actor/lr:np.float64(1e-06) - training/global_step:1 - training/epoch:0 - critic/score/mean:-0.5076172351837158 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.5076172351837158 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:0.029238728806376457 - critic/advantages/max:3.6681058406829834 - critic/advantages/min:-2.967067241668701 - critic/returns/mean:0.03295508399605751 - critic/returns/max:3.6664493083953857 - critic/returns/min:-2.872420310974121 - response_length/mean:1026.013671875 - response_length/max:8096.0 - response_length/min:8.0 - response_length/clip_ratio:0.001953125 - response_length_non_aborted/mean:1026.013671875 - response_length_non_aborted/max:8096.0 - response_length_non_aborted/min:8.0 - response_length_non_aborted/clip_ratio:0.001953125 - response/aborted_ratio:0.0 - prompt_length/mean:336.4375 - prompt_length/max:787.0 - prompt_length/min:264.0 - prompt_length/clip_ratio:0.0 - actor/token_kl/mean:-0.48986321687698364 - actor/token_kl/max:8.38273811340332 - actor/token_kl/min:-24.79005241394043 - actor/token_kl/std:1.773916244506836 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(6.78125) - timing_s/start_profile:0.0002543809823691845 - timing_s/agent_loop/generate_sequences/min:np.float64(0.6615800480358303) - timing_s/agent_loop/generate_sequences/max:np.float64(97.92778698215261) - timing_s/agent_loop/generate_sequences/mean:np.float64(28.949618851189825) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(31.020749622024596) - timing_s/agent_loop/tool_calls/mean:np.float64(0.7458281461076695) - timing_s/agent_loop/slowest/generate_sequences:np.float64(97.92778698215261) - timing_s/agent_loop/slowest/tool_calls:np.float64(2.5614023639354855) - timing_s/agent_loop/slowest/prompt_length:304 - timing_s/agent_loop/slowest/response_length:8096 - timing_s/gen:103.9659375490155 - timing_s/reward:0.00016064103692770004 - timing_s/old_log_prob:12.882856210926548 - timing_s/ref:108.69518036302179 - timing_s/adv:0.07738035405054688 - timing_s/update_actor:38.86928160302341 - timing_s/step:264.58798151812516 - timing_s/stop_profile:5.063996650278568e-05 - timing_per_token_ms/adv:0.00011092764799562324 - timing_per_token_ms/ref:0.1558186293416791 - timing_per_token_ms/gen:0.19791010328774614 - timing_per_token_ms/update_actor:0.05572057714657694 - perf/total_num_tokens:697575 - perf/time_per_step:264.58798151812516 - perf/throughput:659.1144049679878
step:2 - global_seqlen/min:168832 - global_seqlen/max:187552 - global_seqlen/minmax_diff:18720 - global_seqlen/balanced_min:176133 - global_seqlen/balanced_max:176134 - global_seqlen/mean:176133.5 - rollout/tool_calls_avg:2.404296875 - rollout/tool_success_avg:1.814453125 - rollout/tool_success_rate:0.7546709991876523 - actor/entropy:0.23229441046714783 - actor/pg_loss:np.float64(-0.0043042164202233835) - actor/pg_clipfrac:np.float64(0.0027436582733773524) - actor/ppo_kl:np.float64(5.283442098718499e-05) - actor/pg_clipfrac_lower:np.float64(2.1455820792147683e-06) - actor/grad_norm:np.float64(0.6113760471343994) - perf/mfu/actor:np.float64(0.36575755594052156) - perf/max_memory_allocated_gb:np.float64(45.92263698577881) - perf/max_memory_reserved_gb:np.float64(54.4765625) - perf/cpu_memory_used_gb:np.float64(455.1979446411133) - actor/lr:np.float64(1e-06) - training/global_step:2 - training/epoch:0 - critic/score/mean:-0.6349608898162842 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.6349608898162842 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:0.03800205886363983 - critic/advantages/max:3.731663465499878 - critic/advantages/min:-2.8325142860412598 - critic/returns/mean:0.041811827570199966 - critic/returns/max:3.7297611236572266 - critic/returns/min:-2.7385880947113037 - response_length/mean:1044.69921875 - response_length/max:4330.0 - response_length/min:187.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:1044.69921875 - response_length_non_aborted/max:4330.0 - response_length_non_aborted/min:187.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:331.34375 - prompt_length/max:433.0 - prompt_length/min:256.0 - prompt_length/clip_ratio:0.0 - actor/token_kl/mean:-0.49497321248054504 - actor/token_kl/max:7.756710052490234 - actor/token_kl/min:-26.794296264648438 - actor/token_kl/std:1.7707020044326782 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(6.80859375) - timing_s/start_profile:5.471101030707359e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(5.977417258080095) - timing_s/agent_loop/generate_sequences/max:np.float64(61.29429805884138) - timing_s/agent_loop/generate_sequences/mean:np.float64(29.008878420916517) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(60.65686169266701) - timing_s/agent_loop/tool_calls/mean:np.float64(1.5583817403580724) - timing_s/agent_loop/slowest/generate_sequences:np.float64(16.409881862578914) - timing_s/agent_loop/slowest/tool_calls:np.float64(60.65686169266701) - timing_s/agent_loop/slowest/prompt_length:283 - timing_s/agent_loop/slowest/response_length:1420 - timing_s/gen:79.49768764106557 - timing_s/reward:0.00011561298742890358 - timing_s/old_log_prob:10.273378422949463 - timing_s/ref:58.86381979798898 - timing_s/adv:0.06316793686710298 - timing_s/update_actor:35.498646053951234 - timing_s/step:184.2539457550738 - timing_s/stop_profile:5.495315417647362e-05 - timing_per_token_ms/adv:8.965917452827398e-05 - timing_per_token_ms/ref:0.08355000581659505 - timing_per_token_ms/gen:0.14862547840299722 - timing_per_token_ms/update_actor:0.05038599422306267 - perf/total_num_tokens:704534 - perf/time_per_step:184.2539457550738 - perf/throughput:955.9279682082456
step:3 - global_seqlen/min:165673 - global_seqlen/max:177199 - global_seqlen/minmax_diff:11526 - global_seqlen/balanced_min:171311 - global_seqlen/balanced_max:171859 - global_seqlen/mean:171448.25 - rollout/tool_calls_avg:2.005859375 - rollout/tool_success_avg:1.505859375 - rollout/tool_success_rate:0.750730282375852 - actor/entropy:0.24584990739822388 - actor/pg_loss:np.float64(-0.011828453279829572) - actor/pg_clipfrac:np.float64(0.002841262664231989) - actor/ppo_kl:np.float64(4.987295991062032e-05) - actor/pg_clipfrac_lower:np.float64(6.427214733169724e-06) - actor/grad_norm:np.float64(0.6363500356674194) - perf/mfu/actor:np.float64(0.36827239147891144) - perf/max_memory_allocated_gb:np.float64(45.92263698577881) - perf/max_memory_reserved_gb:np.float64(54.4765625) - perf/cpu_memory_used_gb:np.float64(455.4799270629883) - actor/lr:np.float64(1e-06) - training/global_step:3 - training/epoch:0 - critic/score/mean:-0.6550781726837158 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.6550781726837158 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:0.10764758288860321 - critic/advantages/max:3.7081458568573 - critic/advantages/min:-2.2819581031799316 - critic/returns/mean:0.11132791638374329 - critic/returns/max:3.7068138122558594 - critic/returns/min:-2.1920056343078613 - response_length/mean:1008.564453125 - response_length/max:8096.0 - response_length/min:193.0 - response_length/clip_ratio:0.001953125 - response_length_non_aborted/mean:1008.564453125 - response_length_non_aborted/max:8096.0 - response_length_non_aborted/min:193.0 - response_length_non_aborted/clip_ratio:0.001953125 - response/aborted_ratio:0.0 - prompt_length/mean:330.875 - prompt_length/max:468.0 - prompt_length/min:268.0 - prompt_length/clip_ratio:0.0 - actor/token_kl/mean:-0.48187392950057983 - actor/token_kl/max:7.488103866577148 - actor/token_kl/min:-26.010046005249023 - actor/token_kl/std:1.6995457410812378 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(6.01171875) - timing_s/start_profile:8.865492418408394e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(5.9094552209135145) - timing_s/agent_loop/generate_sequences/max:np.float64(100.40530027309433) - timing_s/agent_loop/generate_sequences/mean:np.float64(27.22632564045125) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(30.295865629101172) - timing_s/agent_loop/tool_calls/mean:np.float64(0.7192196698160842) - timing_s/agent_loop/slowest/generate_sequences:np.float64(100.40530027309433) - timing_s/agent_loop/slowest/tool_calls:np.float64(0.846082812640816) - timing_s/agent_loop/slowest/prompt_length:315 - timing_s/agent_loop/slowest/response_length:8096 - timing_s/gen:104.2279013148509 - timing_s/reward:0.00014763814397156239 - timing_s/old_log_prob:10.217551459092647 - timing_s/ref:57.314743356080726 - timing_s/adv:0.06313519482500851 - timing_s/update_actor:34.30889829201624 - timing_s/step:206.20174214593135 - timing_s/stop_profile:5.185813643038273e-05 - timing_per_token_ms/adv:9.206159121631237e-05 - timing_per_token_ms/ref:0.08357440708213809 - timing_per_token_ms/gen:0.20184145804942222 - timing_per_token_ms/update_actor:0.05002806720397589 - perf/total_num_tokens:685793 - perf/time_per_step:206.20174214593135 - perf/throughput:831.4587850507301
step:4 - global_seqlen/min:156227 - global_seqlen/max:174453 - global_seqlen/minmax_diff:18226 - global_seqlen/balanced_min:163163 - global_seqlen/balanced_max:164140 - global_seqlen/mean:163895.5 - rollout/tool_calls_avg:2.271484375 - rollout/tool_success_avg:1.767578125 - rollout/tool_success_rate:0.7781599312123818 - actor/entropy:0.28029388189315796 - actor/pg_loss:np.float64(-0.004350869454356143) - actor/pg_clipfrac:np.float64(0.00267391426799198) - actor/ppo_kl:np.float64(-4.06870955581932e-05) - actor/pg_clipfrac_lower:np.float64(2.311636409204867e-06) - actor/grad_norm:np.float64(0.7108106315135956) - perf/mfu/actor:np.float64(0.36357742448143027) - perf/max_memory_allocated_gb:np.float64(45.92263698577881) - perf/max_memory_reserved_gb:np.float64(54.84765625) - perf/cpu_memory_used_gb:np.float64(455.8301086425781) - actor/lr:np.float64(1e-06) - training/global_step:4 - training/epoch:0 - critic/score/mean:-0.567578136920929 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.567578136920929 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:0.03723272308707237 - critic/advantages/max:3.653050422668457 - critic/advantages/min:-2.8324637413024902 - critic/returns/mean:0.04128201678395271 - critic/returns/max:3.6509206295013428 - critic/returns/min:-2.738537311553955 - response_length/mean:951.05859375 - response_length/max:8096.0 - response_length/min:34.0 - response_length/clip_ratio:0.001953125 - response_length_non_aborted/mean:951.05859375 - response_length_non_aborted/max:8096.0 - response_length_non_aborted/min:34.0 - response_length_non_aborted/clip_ratio:0.001953125 - response/aborted_ratio:0.0 - prompt_length/mean:329.375 - prompt_length/max:537.0 - prompt_length/min:258.0 - prompt_length/clip_ratio:0.0 - actor/token_kl/mean:-0.5213785767555237 - actor/token_kl/max:9.478414535522461 - actor/token_kl/min:-24.46072006225586 - actor/token_kl/std:1.8124443292617798 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(6.54296875) - timing_s/start_profile:6.087403744459152e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(1.1572423060424626) - timing_s/agent_loop/generate_sequences/max:np.float64(100.41392711317167) - timing_s/agent_loop/generate_sequences/mean:np.float64(24.98942270017642) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(30.274386132135987) - timing_s/agent_loop/tool_calls/mean:np.float64(0.40810771285759984) - timing_s/agent_loop/slowest/generate_sequences:np.float64(100.41392711317167) - timing_s/agent_loop/slowest/tool_calls:np.float64(0.0) - timing_s/agent_loop/slowest/prompt_length:298 - timing_s/agent_loop/slowest/response_length:8096 - timing_s/gen:102.81697820592672 - timing_s/reward:0.00012729992158710957 - timing_s/old_log_prob:9.501631424063817 - timing_s/ref:54.946715981001034 - timing_s/adv:0.08057664497755468 - timing_s/update_actor:33.204337844159454 - timing_s/step:200.62682877387851 - timing_s/stop_profile:6.0134101659059525e-05 - timing_per_token_ms/adv:0.00012290856823029718 - timing_per_token_ms/ref:0.08381364342065681 - timing_per_token_ms/gen:0.2111483055598546 - timing_per_token_ms/update_actor:0.05064864173232251 - perf/total_num_tokens:655582 - perf/time_per_step:200.62682877387851 - perf/throughput:816.9171640784022
step:5 - global_seqlen/min:158927 - global_seqlen/max:184515 - global_seqlen/minmax_diff:25588 - global_seqlen/balanced_min:167410 - global_seqlen/balanced_max:167687 - global_seqlen/mean:167589.75 - rollout/tool_calls_avg:2.33203125 - rollout/tool_success_avg:1.72265625 - rollout/tool_success_rate:0.7386934673366834 - actor/entropy:0.24984215199947357 - actor/pg_loss:np.float64(-0.00854657592572039) - actor/pg_clipfrac:np.float64(0.0029095098272793824) - actor/ppo_kl:np.float64(3.5024553047454296e-06) - actor/pg_clipfrac_lower:np.float64(2.2109903107371388e-06) - actor/grad_norm:np.float64(0.6458409130573273) - perf/mfu/actor:np.float64(0.3650012805097539) - perf/max_memory_allocated_gb:np.float64(45.92263698577881) - perf/max_memory_reserved_gb:np.float64(54.84765625) - perf/cpu_memory_used_gb:np.float64(456.0789680480957) - actor/lr:np.float64(1e-06) - training/global_step:5 - training/epoch:0 - critic/score/mean:-0.47031253576278687 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.47031253576278687 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:0.07800604403018951 - critic/advantages/max:3.6697747707366943 - critic/advantages/min:-2.8649442195892334 - critic/returns/mean:0.08197452872991562 - critic/returns/max:3.6676783561706543 - critic/returns/min:-2.770836353302002 - response_length/mean:984.544921875 - response_length/max:6010.0 - response_length/min:165.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:984.544921875 - response_length_non_aborted/max:6010.0 - response_length_non_aborted/min:165.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:324.75 - prompt_length/max:430.0 - prompt_length/min:264.0 - prompt_length/clip_ratio:0.0 - actor/token_kl/mean:-0.5238351225852966 - actor/token_kl/max:8.415292739868164 - actor/token_kl/min:-34.43531036376953 - actor/token_kl/std:1.8133668899536133 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(6.6640625) - timing_s/start_profile:6.458698771893978e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(5.1903595079202205) - timing_s/agent_loop/generate_sequences/max:np.float64(68.05300311837345) - timing_s/agent_loop/generate_sequences/mean:np.float64(25.754059884640355) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(60.1179998901207) - timing_s/agent_loop/tool_calls/mean:np.float64(0.5195339314441298) - timing_s/agent_loop/slowest/generate_sequences:np.float64(21.4268762296997) - timing_s/agent_loop/slowest/tool_calls:np.float64(60.1179998901207) - timing_s/agent_loop/slowest/prompt_length:354 - timing_s/agent_loop/slowest/response_length:1081 - timing_s/gen:83.98888537893072 - timing_s/reward:0.00012731901369988918 - timing_s/old_log_prob:9.553854478988796 - timing_s/ref:55.66908254986629 - timing_s/adv:0.07486046804115176 - timing_s/update_actor:33.79178084200248 - timing_s/step:183.14032819401473 - timing_s/stop_profile:4.946300759911537e-05 - timing_per_token_ms/adv:0.00011167220555128187 - timing_per_token_ms/ref:0.08304368636785109 - timing_per_token_ms/gen:0.1666158527772601 - timing_per_token_ms/update_actor:0.050408483875061694 - perf/total_num_tokens:670359 - perf/time_per_step:183.14032819401473 - perf/throughput:915.0892741791922
step:6 - global_seqlen/min:167296 - global_seqlen/max:188030 - global_seqlen/minmax_diff:20734 - global_seqlen/balanced_min:177382 - global_seqlen/balanced_max:179106 - global_seqlen/mean:178674.75 - rollout/tool_calls_avg:2.1171875 - rollout/tool_success_avg:1.626953125 - rollout/tool_success_rate:0.768450184501845 - actor/entropy:0.26756176352500916 - actor/pg_loss:np.float64(0.0012546591355607638) - actor/pg_clipfrac:np.float64(0.0024123170361336735) - actor/ppo_kl:np.float64(-7.028616159408961e-06) - actor/pg_clipfrac_lower:np.float64(2.043836098487696e-06) - actor/grad_norm:np.float64(0.5900363028049469) - perf/mfu/actor:np.float64(0.37412914905240646) - perf/max_memory_allocated_gb:np.float64(46.13469457626343) - perf/max_memory_reserved_gb:np.float64(54.84765625) - perf/cpu_memory_used_gb:np.float64(456.0656967163086) - actor/lr:np.float64(1e-06) - training/global_step:6 - training/epoch:0 - critic/score/mean:-0.538281261920929 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.538281261920929 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.015720609575510025 - critic/advantages/max:3.70298433303833 - critic/advantages/min:-2.1528964042663574 - critic/returns/mean:-0.011821525171399117 - critic/returns/max:3.701563596725464 - critic/returns/min:-2.064159393310547 - response_length/mean:1045.208984375 - response_length/max:8096.0 - response_length/min:9.0 - response_length/clip_ratio:0.00390625 - response_length_non_aborted/mean:1045.208984375 - response_length_non_aborted/max:8096.0 - response_length_non_aborted/min:9.0 - response_length_non_aborted/clip_ratio:0.00390625 - response/aborted_ratio:0.0 - prompt_length/mean:350.6875 - prompt_length/max:772.0 - prompt_length/min:259.0 - prompt_length/clip_ratio:0.0 - actor/token_kl/mean:-0.48165515065193176 - actor/token_kl/max:7.7378997802734375 - actor/token_kl/min:-25.295961380004883 - actor/token_kl/std:1.7033896446228027 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(6.234375) - timing_s/start_profile:7.096212357282639e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(0.4957689889706671) - timing_s/agent_loop/generate_sequences/max:np.float64(105.76579787093215) - timing_s/agent_loop/generate_sequences/mean:np.float64(28.62702497787086) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(3.139033837011084) - timing_s/agent_loop/tool_calls/mean:np.float64(0.3749727322210674) - timing_s/agent_loop/slowest/generate_sequences:np.float64(105.76579787093215) - timing_s/agent_loop/slowest/tool_calls:np.float64(0.0) - timing_s/agent_loop/slowest/prompt_length:322 - timing_s/agent_loop/slowest/response_length:8096 - timing_s/gen:108.23380796588026 - timing_s/reward:0.00014671706594526768 - timing_s/old_log_prob:10.240626255050302 - timing_s/ref:59.46087372605689 - timing_s/adv:0.07466946891508996 - timing_s/update_actor:35.12652456504293 - timing_s/step:213.18466903781518 - timing_s/stop_profile:5.189189687371254e-05 - timing_per_token_ms/adv:0.00010447680620105801 - timing_per_token_ms/ref:0.08319708538287711 - timing_per_token_ms/gen:0.20225061145046175 - timing_per_token_ms/update_actor:0.04914869695500194 - perf/total_num_tokens:714699 - perf/time_per_step:213.18466903781518 - perf/throughput:838.1219475416699
step:7 - global_seqlen/min:164001 - global_seqlen/max:184869 - global_seqlen/minmax_diff:20868 - global_seqlen/balanced_min:174767 - global_seqlen/balanced_max:174768 - global_seqlen/mean:174767.75 - rollout/tool_calls_avg:2.607421875 - rollout/tool_success_avg:1.888671875 - rollout/tool_success_rate:0.7243445692883895 - actor/entropy:0.24623043835163116 - actor/pg_loss:np.float64(-0.010913001978931587) - actor/pg_clipfrac:np.float64(0.0028053919474283853) - actor/ppo_kl:np.float64(-9.569751619488266e-06) - actor/pg_clipfrac_lower:np.float64(6.418002562390433e-06) - actor/grad_norm:np.float64(0.6424972116947174) - perf/mfu/actor:np.float64(0.3709701029348026) - perf/max_memory_allocated_gb:np.float64(46.13469457626343) - perf/max_memory_reserved_gb:np.float64(54.84765625) - perf/cpu_memory_used_gb:np.float64(456.3459167480469) - actor/lr:np.float64(1e-06) - training/global_step:7 - training/epoch:0 - critic/score/mean:-0.5894531607627869 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.5894531607627869 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:0.09525910764932632 - critic/advantages/max:3.7024035453796387 - critic/advantages/min:-2.293522596359253 - critic/returns/mean:0.09920764714479446 - critic/returns/max:3.701122999191284 - critic/returns/min:-2.2034664154052734 - response_length/mean:1025.841796875 - response_length/max:4798.0 - response_length/min:11.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:1025.841796875 - response_length_non_aborted/max:4798.0 - response_length_non_aborted/min:11.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:339.53125 - prompt_length/max:557.0 - prompt_length/min:275.0 - prompt_length/clip_ratio:0.0 - actor/token_kl/mean:-0.5248940587043762 - actor/token_kl/max:7.545209884643555 - actor/token_kl/min:-26.499385833740234 - actor/token_kl/std:1.828015923500061 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(7.21484375) - timing_s/start_profile:7.060496136546135e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(1.036948655033484) - timing_s/agent_loop/generate_sequences/max:np.float64(64.45969985728152) - timing_s/agent_loop/generate_sequences/mean:np.float64(27.339024990652433) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(31.197897852631286) - timing_s/agent_loop/tool_calls/mean:np.float64(0.645756000055826) - timing_s/agent_loop/slowest/generate_sequences:np.float64(64.45969985728152) - timing_s/agent_loop/slowest/tool_calls:np.float64(2.57593218726106) - timing_s/agent_loop/slowest/prompt_length:316 - timing_s/agent_loop/slowest/response_length:4798 - timing_s/gen:69.5059223449789 - timing_s/reward:0.00012698303908109665 - timing_s/old_log_prob:9.98467107117176 - timing_s/ref:58.18008541013114 - timing_s/adv:0.06919787498190999 - timing_s/update_actor:34.57112753903493 - timing_s/step:172.37273316597566 - timing_s/stop_profile:5.115196108818054e-05 - timing_per_token_ms/adv:9.898547498309898e-05 - timing_per_token_ms/ref:0.0832248590059252 - timing_per_token_ms/gen:0.13233400607538187 - timing_per_token_ms/update_actor:0.04945295619334078 - perf/total_num_tokens:699071 - perf/time_per_step:172.37273316597566 - perf/throughput:1013.8944065574351
step:8 - global_seqlen/min:169168 - global_seqlen/max:194690 - global_seqlen/minmax_diff:25522 - global_seqlen/balanced_min:176775 - global_seqlen/balanced_max:178046 - global_seqlen/mean:177728.0 - rollout/tool_calls_avg:2.224609375 - rollout/tool_success_avg:1.705078125 - rollout/tool_success_rate:0.7664618086040387 - actor/entropy:0.25897905230522156 - actor/pg_loss:np.float64(0.00025054214408252545) - actor/pg_clipfrac:np.float64(0.0024782927551617226) - actor/ppo_kl:np.float64(-2.90486241662317e-05) - actor/pg_clipfrac_lower:np.float64(1.0171668893437729e-05) - actor/grad_norm:np.float64(0.5995306372642517) - perf/mfu/actor:np.float64(0.3732603954537877) - perf/max_memory_allocated_gb:np.float64(46.13469457626343) - perf/max_memory_reserved_gb:np.float64(54.84765625) - perf/cpu_memory_used_gb:np.float64(456.36084747314453) - actor/lr:np.float64(1e-06) - training/global_step:8 - training/epoch:0 - critic/score/mean:-0.5162109732627869 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.5162109732627869 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.007640088442713022 - critic/advantages/max:3.695321798324585 - critic/advantages/min:-2.060847282409668 - critic/returns/mean:-0.003705851500853896 - critic/returns/max:3.6941795349121094 - critic/returns/min:-1.9730533361434937 - response_length/mean:1065.15625 - response_length/max:8096.0 - response_length/min:6.0 - response_length/clip_ratio:0.005859375 - response_length_non_aborted/mean:1065.15625 - response_length_non_aborted/max:8096.0 - response_length_non_aborted/min:6.0 - response_length_non_aborted/clip_ratio:0.005859375 - response/aborted_ratio:0.0 - prompt_length/mean:323.34375 - prompt_length/max:434.0 - prompt_length/min:266.0 - prompt_length/clip_ratio:0.0 - actor/token_kl/mean:-0.48807409405708313 - actor/token_kl/max:10.076231002807617 - actor/token_kl/min:-29.12778663635254 - actor/token_kl/std:1.723134994506836 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(6.44921875) - timing_s/start_profile:6.079883314669132e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(0.6654388071037829) - timing_s/agent_loop/generate_sequences/max:np.float64(106.60477025504224) - timing_s/agent_loop/generate_sequences/mean:np.float64(28.506256971069433) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(30.38708065333776) - timing_s/agent_loop/tool_calls/mean:np.float64(0.7400812683799813) - timing_s/agent_loop/slowest/generate_sequences:np.float64(106.00730794807896) - timing_s/agent_loop/slowest/tool_calls:np.float64(0.884407039033249) - timing_s/agent_loop/slowest/prompt_length:380 - timing_s/agent_loop/slowest/response_length:8096 - timing_s/gen:109.33569008600898 - timing_s/reward:0.00011994410306215286 - timing_s/old_log_prob:10.404233410954475 - timing_s/ref:59.10570952203125 - timing_s/adv:0.0841443371027708 - timing_s/update_actor:35.082525182981044 - timing_s/step:214.05605116696097 - timing_s/stop_profile:4.9138907343149185e-05 - timing_per_token_ms/adv:0.00011836111516301709 - timing_per_token_ms/ref:0.08314068340671033 - timing_per_token_ms/gen:0.20048351563372632 - timing_per_token_ms/update_actor:0.04934861865178959 - perf/total_num_tokens:710912 - perf/time_per_step:214.05605116696097 - perf/throughput:830.2872029596325
step:9 - global_seqlen/min:168653 - global_seqlen/max:181633 - global_seqlen/minmax_diff:12980 - global_seqlen/balanced_min:176190 - global_seqlen/balanced_max:177042 - global_seqlen/mean:176616.0 - rollout/tool_calls_avg:2.4921875 - rollout/tool_success_avg:1.72265625 - rollout/tool_success_rate:0.6912225705329154 - actor/entropy:0.24775250256061554 - actor/pg_loss:np.float64(-0.009615695894657014) - actor/pg_clipfrac:np.float64(0.002553593108637465) - actor/ppo_kl:np.float64(-2.8925965466441994e-05) - actor/pg_clipfrac_lower:np.float64(6.421570004830654e-06) - actor/grad_norm:np.float64(0.5992852449417114) - perf/mfu/actor:np.float64(0.37170262224410405) - perf/max_memory_allocated_gb:np.float64(46.13469457626343) - perf/max_memory_reserved_gb:np.float64(54.84765625) - perf/cpu_memory_used_gb:np.float64(456.491756439209) - actor/lr:np.float64(1e-06) - training/global_step:9 - training/epoch:0 - critic/score/mean:-0.634765625 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.634765625 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:0.08619899302721024 - critic/advantages/max:3.6957874298095703 - critic/advantages/min:-3.244107961654663 - critic/returns/mean:0.09004203230142593 - critic/returns/max:3.69472336769104 - critic/returns/min:-3.148224115371704 - response_length/mean:1047.46875 - response_length/max:6459.0 - response_length/min:8.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:1047.46875 - response_length_non_aborted/max:6459.0 - response_length_non_aborted/min:8.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:332.34375 - prompt_length/max:440.0 - prompt_length/min:274.0 - prompt_length/clip_ratio:0.0 - actor/token_kl/mean:-0.5109657645225525 - actor/token_kl/max:8.18754768371582 - actor/token_kl/min:-24.994600296020508 - actor/token_kl/std:1.805417776107788 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(6.984375) - timing_s/start_profile:7.359008304774761e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(0.418104280019179) - timing_s/agent_loop/generate_sequences/max:np.float64(77.42236807011068) - timing_s/agent_loop/generate_sequences/mean:np.float64(27.38164396317552) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(30.97159113921225) - timing_s/agent_loop/tool_calls/mean:np.float64(1.0828020150829616) - timing_s/agent_loop/slowest/generate_sequences:np.float64(77.42236807011068) - timing_s/agent_loop/slowest/tool_calls:np.float64(0.0965535908471793) - timing_s/agent_loop/slowest/prompt_length:329 - timing_s/agent_loop/slowest/response_length:6459 - timing_s/gen:80.06062848307192 - timing_s/reward:0.00010499893687665462 - timing_s/old_log_prob:10.16709255008027 - timing_s/ref:58.63864101516083 - timing_s/adv:0.0536965059582144 - timing_s/update_actor:34.803168235113844 - timing_s/step:183.78598945215344 - timing_s/stop_profile:4.812004044651985e-05 - timing_per_token_ms/adv:7.600741999339585e-05 - timing_per_token_ms/ref:0.08300301362158699 - timing_per_token_ms/gen:0.1492821766816431 - timing_per_token_ms/update_actor:0.04926389488369378 - perf/total_num_tokens:706464 - perf/time_per_step:183.78598945215344 - perf/throughput:960.9872903069139
test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 10}
validation generation end
len reward_extra_infos_dict['reward']: 960
len reward_extra_infos_dict['score']: 960
len reward_extra_infos_dict['acc']: 960
len reward_extra_infos_dict['pred']: 960
step:10 - global_seqlen/min:149586 - global_seqlen/max:191184 - global_seqlen/minmax_diff:41598 - global_seqlen/balanced_min:174305 - global_seqlen/balanced_max:175479 - global_seqlen/mean:174892.25 - rollout/tool_calls_avg:2.412109375 - rollout/tool_success_avg:1.740234375 - rollout/tool_success_rate:0.7214574898785425 - actor/entropy:0.2564058005809784 - actor/pg_loss:np.float64(-0.006592350740296145) - actor/pg_clipfrac:np.float64(0.002784018741092748) - actor/ppo_kl:np.float64(-1.4888829860461152e-05) - actor/pg_clipfrac_lower:np.float64(8.848436967430947e-06) - actor/grad_norm:np.float64(0.6531039774417877) - perf/mfu/actor:np.float64(0.3708460422789465) - perf/max_memory_allocated_gb:np.float64(46.13469457626343) - perf/max_memory_reserved_gb:np.float64(54.84765625) - perf/cpu_memory_used_gb:np.float64(456.50745391845703) - actor/lr:np.float64(1e-06) - val-aux/aime_2024/reward/mean@16:np.float64(-0.7647916639844576) - val-aux/aime_2024/reward/std@16:np.float64(0.18065142507252646) - val-aux/aime_2024/reward/best@2/mean:np.float64(-0.6797166690150896) - val-aux/aime_2024/reward/best@2/std:np.float64(0.18623613687220225) - val-aux/aime_2024/reward/worst@2/mean:np.float64(-0.8475466587821643) - val-aux/aime_2024/reward/worst@2/std:np.float64(0.11218157279196649) - val-aux/aime_2024/reward/maj@2/mean:np.float64(-0.763649997216463) - val-aux/aime_2024/reward/maj@2/std:np.float64(0.18194224826106892) - val-aux/aime_2024/reward/best@4/mean:np.float64(-0.5962066741029421) - val-aux/aime_2024/reward/best@4/std:np.float64(0.17852150439291703) - val-aux/aime_2024/reward/worst@4/mean:np.float64(-0.8992266560733319) - val-aux/aime_2024/reward/worst@4/std:np.float64(0.06948645412817528) - val-aux/aime_2024/reward/maj@4/mean:np.float64(-0.7551599974254769) - val-aux/aime_2024/reward/maj@4/std:np.float64(0.18052670872109552) - val-aux/aime_2024/reward/best@8/mean:np.float64(-0.5164066776633263) - val-aux/aime_2024/reward/best@8/std:np.float64(0.16060811296089972) - val-aux/aime_2024/reward/worst@8/mean:np.float64(-0.9303433227201302) - val-aux/aime_2024/reward/worst@8/std:np.float64(0.04143869072789361) - val-aux/aime_2024/reward/maj@8/mean:np.float64(-0.7467066644569239) - val-aux/aime_2024/reward/maj@8/std:np.float64(0.17181084584229644) - val-aux/aime_2024/reward/best@16/mean:np.float64(-0.44177001313368486) - val-aux/aime_2024/reward/best@16/std:np.float64(0.12849001904257915) - val-aux/aime_2024/reward/worst@16/mean:np.float64(-0.9486533242106437) - val-aux/aime_2024/reward/worst@16/std:np.float64(0.025311961956619163) - val-aux/aime_2024/reward/maj@16/mean:np.float64(-0.7368666647771994) - val-aux/aime_2024/reward/maj@16/std:np.float64(0.15637190609653848) - val-aux/aime_2024/score/mean@16:np.float64(-0.7647916666666666) - val-aux/aime_2024/score/std@16:np.float64(0.18065143382104895) - val-aux/aime_2024/score/best@2/mean:np.float64(-0.6797166666666665) - val-aux/aime_2024/score/best@2/std:np.float64(0.18623614565507676) - val-aux/aime_2024/score/worst@2/mean:np.float64(-0.8475466666666667) - val-aux/aime_2024/score/worst@2/std:np.float64(0.11218157826046933) - val-aux/aime_2024/score/maj@2/mean:np.float64(-0.7636500000000003) - val-aux/aime_2024/score/maj@2/std:np.float64(0.18194225695816404) - val-aux/aime_2024/score/best@4/mean:np.float64(-0.5962066666666667) - val-aux/aime_2024/score/best@4/std:np.float64(0.17852151098210992) - val-aux/aime_2024/score/worst@4/mean:np.float64(-0.8992266666666667) - val-aux/aime_2024/score/worst@4/std:np.float64(0.06948645470383674) - val-aux/aime_2024/score/maj@4/mean:np.float64(-0.7551600000000002) - val-aux/aime_2024/score/maj@4/std:np.float64(0.18052671757694727) - val-aux/aime_2024/score/best@8/mean:np.float64(-0.5164066666666666) - val-aux/aime_2024/score/best@8/std:np.float64(0.16060811720812315) - val-aux/aime_2024/score/worst@8/mean:np.float64(-0.9303433333333334) - val-aux/aime_2024/score/worst@8/std:np.float64(0.04143868776589462) - val-aux/aime_2024/score/maj@8/mean:np.float64(-0.7467066666666667) - val-aux/aime_2024/score/maj@8/std:np.float64(0.1718108544141246) - val-aux/aime
step:11 - global_seqlen/min:172895 - global_seqlen/max:209425 - global_seqlen/minmax_diff:36530 - global_seqlen/balanced_min:193654 - global_seqlen/balanced_max:194035 - global_seqlen/mean:193749.25 - rollout/tool_calls_avg:2.7421875 - rollout/tool_success_avg:1.9375 - rollout/tool_success_rate:0.7065527065527065 - actor/entropy:0.23434676229953766 - actor/pg_loss:np.float64(-0.009101743918290595) - actor/pg_clipfrac:np.float64(0.0027037640218622984) - actor/ppo_kl:np.float64(-1.6093964495667025e-05) - actor/pg_clipfrac_lower:np.float64(4.0664470361662096e-06) - actor/grad_norm:np.float64(0.5700779855251312) - perf/mfu/actor:np.float64(0.3751211472648732) - perf/max_memory_allocated_gb:np.float64(46.13469457626343) - perf/max_memory_reserved_gb:np.float64(54.84765625) - perf/cpu_memory_used_gb:np.float64(457.0319404602051) - actor/lr:np.float64(1e-06) - training/global_step:11 - training/epoch:0 - critic/score/mean:-0.6451172232627869 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.6451172232627869 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:0.07904691994190216 - critic/advantages/max:3.633115768432617 - critic/advantages/min:-2.152466297149658 - critic/returns/mean:0.08264715224504471 - critic/returns/max:3.6319239139556885 - critic/returns/min:-2.0637335777282715 - response_length/mean:1186.041015625 - response_length/max:8096.0 - response_length/min:252.0 - response_length/clip_ratio:0.00390625 - response_length_non_aborted/mean:1186.041015625 - response_length_non_aborted/max:8096.0 - response_length_non_aborted/min:252.0 - response_length_non_aborted/clip_ratio:0.00390625 - response/aborted_ratio:0.0 - prompt_length/mean:327.625 - prompt_length/max:401.0 - prompt_length/min:272.0 - prompt_length/clip_ratio:0.0 - actor/token_kl/mean:-0.4869946241378784 - actor/token_kl/max:7.521551132202148 - actor/token_kl/min:-24.759567260742188 - actor/token_kl/std:1.7719426155090332 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(7.484375) - timing_s/start_profile:6.479001604020596e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(7.489829053170979) - timing_s/agent_loop/generate_sequences/max:np.float64(110.07795690908097) - timing_s/agent_loop/generate_sequences/mean:np.float64(31.556251682149195) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(30.511402853997424) - timing_s/agent_loop/tool_calls/mean:np.float64(0.7192848815734578) - timing_s/agent_loop/slowest/generate_sequences:np.float64(110.07795690908097) - timing_s/agent_loop/slowest/tool_calls:np.float64(0.0) - timing_s/agent_loop/slowest/prompt_length:392 - timing_s/agent_loop/slowest/response_length:8096 - timing_s/gen:112.04614918213338 - timing_s/reward:0.00012885010801255703 - timing_s/old_log_prob:10.983707960927859 - timing_s/ref:64.26553848804906 - timing_s/adv:0.07739062304608524 - timing_s/update_actor:38.19263534084894 - timing_s/step:225.65615979093127 - timing_s/stop_profile:5.162903107702732e-05 - timing_per_token_ms/adv:9.985925499851644e-05 - timing_per_token_ms/ref:0.08292359646301735 - timing_per_token_ms/gen:0.18451312580116258 - timing_per_token_ms/update_actor:0.049281010559845954 - perf/total_num_tokens:774997 - perf/time_per_step:225.65615979093127 - perf/throughput:858.6038607565919
step:12 - global_seqlen/min:159361 - global_seqlen/max:206355 - global_seqlen/minmax_diff:46994 - global_seqlen/balanced_min:177143 - global_seqlen/balanced_max:178201 - global_seqlen/mean:177410.5 - rollout/tool_calls_avg:2.65234375 - rollout/tool_success_avg:1.970703125 - rollout/tool_success_rate:0.7430044182621502 - actor/entropy:0.2322889268398285 - actor/pg_loss:np.float64(-0.005106263283576279) - actor/pg_clipfrac:np.float64(0.0025447189756151703) - actor/ppo_kl:np.float64(-4.614177871392005e-05) - actor/pg_clipfrac_lower:np.float64(8.6335041689583e-06) - actor/grad_norm:np.float64(0.6054058074951172) - perf/mfu/actor:np.float64(0.3722062242635407) - perf/max_memory_allocated_gb:np.float64(46.13469457626343) - perf/max_memory_reserved_gb:np.float64(54.84765625) - perf/cpu_memory_used_gb:np.float64(457.2390327453613) - actor/lr:np.float64(1e-06) - training/global_step:12 - training/epoch:0 - critic/score/mean:-0.586132824420929 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.586132824420929 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:0.04271310567855835 - critic/advantages/max:3.6753809452056885 - critic/advantages/min:-2.4766528606414795 - critic/returns/mean:0.0465405210852623 - critic/returns/max:3.674254894256592 - critic/returns/min:-2.385084390640259 - response_length/mean:1048.76953125 - response_length/max:8060.0 - response_length/min:6.0 - response_length/clip_ratio:0.0 - response_length_non_aborted/mean:1048.76953125 - response_length_non_aborted/max:8060.0 - response_length_non_aborted/min:6.0 - response_length_non_aborted/clip_ratio:0.0 - response/aborted_ratio:0.0 - prompt_length/mean:337.25 - prompt_length/max:427.0 - prompt_length/min:269.0 - prompt_length/clip_ratio:0.0 - actor/token_kl/mean:-0.5046882629394531 - actor/token_kl/max:8.439727783203125 - actor/token_kl/min:-25.527809143066406 - actor/token_kl/std:1.8230767250061035 - num_turns/min:np.int32(2) - num_turns/max:np.int32(16) - num_turns/mean:np.float64(7.30078125) - timing_s/start_profile:6.969901733100414e-05 - timing_s/agent_loop/generate_sequences/min:np.float64(0.6401081960648298) - timing_s/agent_loop/generate_sequences/max:np.float64(89.76837728288956) - timing_s/agent_loop/generate_sequences/mean:np.float64(27.893305125250663) - timing_s/agent_loop/tool_calls/min:np.float64(0.0) - timing_s/agent_loop/tool_calls/max:np.float64(33.56544797797687) - timing_s/agent_loop/tool_calls/mean:np.float64(1.3747809756628158) - timing_s/agent_loop/slowest/generate_sequences:np.float64(89.76837728288956) - timing_s/agent_loop/slowest/tool_calls:np.float64(0.30428799125365913) - timing_s/agent_loop/slowest/prompt_length:340 - timing_s/agent_loop/slowest/response_length:8060 - timing_s/gen:92.75441368320026 - timing_s/reward:0.0001288149505853653 - timing_s/old_log_prob:10.15570698888041 - timing_s/ref:59.01997801894322 - timing_s/adv:0.0751338698901236 - timing_s/update_actor:35.02007567905821 - timing_s/step:197.07962987106293 - timing_s/stop_profile:6.100814789533615e-05 - timing_per_token_ms/adv:0.00010587573718878477 - timing_per_token_ms/ref:0.0831686653537181 - timing_per_token_ms/gen:0.1727366774367288 - timing_per_token_ms/update_actor:0.04934893323543168 - perf/total_num_tokens:709642 - perf/time_per_step:197.07962987106293 - perf/throughput:900.1970427693047
